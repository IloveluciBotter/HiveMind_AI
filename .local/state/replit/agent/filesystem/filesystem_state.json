{"file_contents":{"client/src/components/ui/hover-card.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as HoverCardPrimitive from \"@radix-ui/react-hover-card\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst HoverCard = HoverCardPrimitive.Root\n\nconst HoverCardTrigger = HoverCardPrimitive.Trigger\n\nconst HoverCardContent = React.forwardRef<\n  React.ElementRef<typeof HoverCardPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof HoverCardPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <HoverCardPrimitive.Content\n    ref={ref}\n    align={align}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 w-64 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-hover-card-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nHoverCardContent.displayName = HoverCardPrimitive.Content.displayName\n\nexport { HoverCard, HoverCardTrigger, HoverCardContent }\n","path":null,"size_bytes":1251,"size_tokens":null},"server/routes.ts":{"content":"import type { Express, Request, Response, NextFunction } from \"express\";\nimport { createServer, type Server } from \"http\";\nimport { storage } from \"./storage\";\nimport { z } from \"zod\";\nimport { readdir, readFile, writeFile, stat } from \"fs/promises\";\nimport { join } from \"path\";\nimport {\n  generateNonce,\n  storeNonce,\n  verifyNonce,\n  verifySignature,\n  issueToken,\n  requireAuth as requireAuthMiddleware,\n  requireHiveAccess,\n  checkHiveAccess,\n  requireCreator,\n  isCreator,\n} from \"./auth\";\n\n// Helper to get user ID from session (simplified - you may want to add proper auth)\nfunction getUserId(req: Request): string | null {\n  return (req as any).userId || null;\n}\n\nfunction requireAuth(req: Request, res: Response): string | null {\n  const userId = getUserId(req);\n  if (!userId) {\n    res.status(401).json({ error: \"Unauthorized\" });\n    return null;\n  }\n  return userId;\n}\n\nasync function requireAdmin(req: Request, res: Response): Promise<boolean> {\n  const userId = requireAuth(req, res);\n  if (!userId) return false;\n  \n  const user = await storage.getUser(userId);\n  if (!user || !user.isAdmin) {\n    res.status(403).json({ error: \"Admin access required\" });\n    return false;\n  }\n  return true;\n}\n\nasync function requireReviewer(req: Request, res: Response): Promise<string | null> {\n  const userId = requireAuth(req, res);\n  if (!userId) return null;\n  \n  const user = await storage.getUser(userId);\n  if (!user || !user.isReviewer) {\n    res.status(403).json({ error: \"Reviewer access required\" });\n    return null;\n  }\n  return userId;\n}\n\n// Cost calculation by difficulty\nfunction getCostByDifficulty(difficulty: string): string {\n  const costs: Record<string, string> = {\n    low: \"10\",\n    medium: \"50\",\n    high: \"200\",\n    extreme: \"1000\",\n  };\n  return costs[difficulty] || \"10\";\n}\n\nexport async function registerRoutes(\n  httpServer: Server,\n  app: Express\n): Promise<Server> {\n  // Health check\n  app.get(\"/api/health\", (req: Request, res: Response) => {\n    res.json({ status: \"ok\" });\n  });\n\n  // ===== AUTHENTICATION =====\n  app.get(\"/api/auth/challenge\", (req: Request, res: Response) => {\n    const publicKey = req.query.publicKey as string;\n    if (!publicKey) {\n      return res.status(400).json({ error: \"publicKey query parameter required\" });\n    }\n\n    const nonce = generateNonce();\n    storeNonce(publicKey, nonce);\n    res.json({ nonce });\n  });\n\n  const verifySchema = z.object({\n    publicKey: z.string(),\n    signature: z.string(),\n    nonce: z.string(),\n  });\n\n  app.post(\"/api/auth/verify\", async (req: Request, res: Response) => {\n    try {\n      const body = verifySchema.parse(req.body);\n\n      // Verify nonce\n      if (!verifyNonce(body.publicKey, body.nonce)) {\n        return res.status(400).json({ error: \"Invalid or expired nonce\" });\n      }\n\n      // Verify signature\n      const message = `Sign this message to authenticate: ${body.nonce}`;\n      const isValid = await verifySignature(body.publicKey, body.signature, message);\n      if (!isValid) {\n        return res.status(401).json({ error: \"Invalid signature\" });\n      }\n\n      // Issue JWT token\n      const token = issueToken(body.publicKey);\n\n      // Set httpOnly cookie\n      res.cookie(\"authToken\", token, {\n        httpOnly: true,\n        secure: process.env.NODE_ENV === \"production\",\n        sameSite: \"lax\",\n        maxAge: 7 * 24 * 60 * 60 * 1000, // 7 days\n      });\n\n      res.json({ success: true, token });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Auth verify error:\", error);\n      res.status(500).json({ error: \"Failed to verify authentication\" });\n    }\n  });\n\n  // ===== GATE STATUS =====\n  app.get(\"/api/gate/status\", requireAuthMiddleware, async (req: Request, res: Response) => {\n    try {\n      const publicKey = (req as any).publicKey;\n      const access = await checkHiveAccess(publicKey);\n      res.json(access);\n    } catch (error) {\n      console.error(\"Gate status error:\", error);\n      res.status(500).json({ error: \"Failed to check gate status\" });\n    }\n  });\n\n  // Public balance check (no auth required - used by client before full auth)\n  app.get(\"/api/balance/:walletAddress\", async (req: Request, res: Response) => {\n    try {\n      const { walletAddress } = req.params;\n      if (!walletAddress || walletAddress.length < 32) {\n        return res.status(400).json({ error: \"Invalid wallet address\" });\n      }\n      const access = await checkHiveAccess(walletAddress);\n      res.json(access);\n    } catch (error) {\n      console.error(\"Balance check error:\", error);\n      res.status(500).json({ error: \"Failed to check balance\" });\n    }\n  });\n\n  // ===== TRACKS & QUESTIONS =====\n  app.get(\"/api/tracks\", async (req: Request, res: Response) => {\n    try {\n      const tracks = await storage.getAllTracks();\n      res.json(tracks);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch tracks\" });\n    }\n  });\n\n  app.get(\"/api/tracks/:trackId/questions\", async (req: Request, res: Response) => {\n    try {\n      const questions = await storage.getQuestionsByTrack(req.params.trackId);\n      res.json(questions);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch questions\" });\n    }\n  });\n\n  app.get(\"/api/benchmark-questions\", async (req: Request, res: Response) => {\n    try {\n      const questions = await storage.getBenchmarkQuestions();\n      res.json(questions);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch benchmark questions\" });\n    }\n  });\n\n  // ===== CYCLES =====\n  app.get(\"/api/cycles/current\", async (req: Request, res: Response) => {\n    try {\n      const cycle = await storage.getCurrentCycle();\n      res.json(cycle);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch current cycle\" });\n    }\n  });\n\n  app.post(\"/api/cycles/rollover\", requireAuthMiddleware, requireCreator, async (req: Request, res: Response) => {\n    try {\n      const currentCycle = await storage.getCurrentCycle();\n      const nextCycleNumber = currentCycle ? currentCycle.cycleNumber + 1 : 1;\n      \n      // End current cycle\n      if (currentCycle) {\n        await storage.endCycle(currentCycle.id);\n      }\n      \n      // Create new cycle\n      const newCycle = await storage.createCycle(nextCycleNumber);\n      \n      // Unlock locks from 4 cycles ago\n      await storage.unlockLocksForCycle(nextCycleNumber);\n      \n      // Process phrase mining (phrases with ≥50 mentions)\n      const phrases = await storage.getPhrasesByMentions(50);\n      await storage.resetPhraseCounts(nextCycleNumber);\n      \n      // Create model version from last 4 cycles\n      const last4Cycles = [];\n      for (let i = 0; i < 4; i++) {\n        const cycle = await storage.getCycleByNumber(nextCycleNumber - 1 - i);\n        if (cycle) last4Cycles.push(cycle.cycleNumber);\n      }\n      \n      const approvedAttempts = await storage.getApprovedAttemptsForCycles(last4Cycles);\n      const newModel = await storage.createModelVersion(newCycle.id, approvedAttempts.length);\n      \n      // Run benchmark\n      const previousModel = await storage.getActiveModelVersion();\n      const benchmarkQuestions = await storage.getBenchmarkQuestions();\n      // Simulate benchmark score (in real implementation, run actual model)\n      const score = (85 + Math.random() * 10).toFixed(2);\n      const previousScore = previousModel ? \"90.00\" : null;\n      \n      const benchmark = await storage.createBenchmark({\n        modelVersionId: newModel.id,\n        previousModelVersionId: previousModel?.id || undefined,\n        score,\n        previousScore: previousScore || undefined,\n      });\n      \n      // Check for rollback (score drop ≥10%)\n      if (previousScore) {\n        const scoreDrop = parseFloat(previousScore) - parseFloat(score);\n        if (scoreDrop >= 10) {\n          await storage.updateBenchmarkRollback(benchmark.id, true, newCycle.id);\n          await storage.deactivateAllModelVersions();\n          // Reactivate previous model\n          if (previousModel) {\n            await storage.activateModelVersion(previousModel.id);\n          }\n        } else {\n          await storage.activateModelVersion(newModel.id);\n        }\n      } else {\n        await storage.activateModelVersion(newModel.id);\n      }\n      \n      res.json({ cycle: newCycle, model: newModel, benchmark });\n    } catch (error) {\n      console.error(\"Cycle rollover error:\", error);\n      res.status(500).json({ error: \"Failed to rollover cycle\" });\n    }\n  });\n\n  // ===== TRAINING CORPUS =====\n  // Text normalization helper\n  function normalizeText(text: string): string {\n    return text\n      .toLowerCase()\n      .replace(/[^\\w\\s]/g, ' ')\n      .replace(/\\s+/g, ' ')\n      .trim();\n  }\n\n  // Get corpus items with pagination, filtering, search (requires HIVE access)\n  app.get(\"/api/corpus\", requireAuthMiddleware, requireHiveAccess, async (req: Request, res: Response) => {\n    try {\n      const { trackId, cycleId, search, page = \"1\", limit = \"50\" } = req.query;\n      const pageNum = parseInt(page as string, 10);\n      const limitNum = Math.min(parseInt(limit as string, 10), 100);\n      \n      let items = await storage.getAllCorpusItems();\n      \n      // Filter by track\n      if (trackId && typeof trackId === 'string') {\n        items = items.filter(item => item.trackId === trackId);\n      }\n      \n      // Filter by cycle\n      if (cycleId && typeof cycleId === 'string') {\n        items = items.filter(item => item.cycleId === cycleId);\n      }\n      \n      // Search by keyword\n      if (search && typeof search === 'string') {\n        const searchLower = search.toLowerCase();\n        items = items.filter(item => \n          item.normalizedText.toLowerCase().includes(searchLower)\n        );\n      }\n      \n      // Pagination\n      const total = items.length;\n      const totalPages = Math.ceil(total / limitNum);\n      const offset = (pageNum - 1) * limitNum;\n      const paginatedItems = items.slice(offset, offset + limitNum);\n      \n      res.json({\n        items: paginatedItems,\n        pagination: {\n          page: pageNum,\n          limit: limitNum,\n          total,\n          totalPages,\n        },\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch corpus items\" });\n    }\n  });\n\n  // Get corpus stats (requires HIVE access)\n  app.get(\"/api/corpus/stats\", requireAuthMiddleware, requireHiveAccess, async (req: Request, res: Response) => {\n    try {\n      const stats = await storage.getCorpusStats();\n      const currentCycle = await storage.getCurrentCycle();\n      \n      // Get items this cycle\n      let itemsThisCycle = 0;\n      if (currentCycle) {\n        const allItems = await storage.getAllCorpusItems();\n        itemsThisCycle = allItems.filter(item => item.cycleId === currentCycle.id).length;\n      }\n      \n      // Get last updated\n      const allItems = await storage.getAllCorpusItems();\n      const lastUpdated = allItems.length > 0 ? allItems[0].createdAt : null;\n      \n      res.json({\n        ...stats,\n        itemsThisCycle,\n        lastUpdated,\n        currentCycleId: currentCycle?.id,\n        currentCycleNumber: currentCycle?.cycleNumber,\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch corpus stats\" });\n    }\n  });\n\n  // Add corpus item (Creator only)\n  const addCorpusItemSchema = z.object({\n    trackId: z.string(),\n    text: z.string().min(1),\n    sourceAttemptId: z.string().optional(),\n  });\n\n  app.post(\"/api/corpus\", requireAuthMiddleware, requireCreator, async (req: Request, res: Response) => {\n    try {\n      const body = addCorpusItemSchema.parse(req.body);\n      const currentCycle = await storage.getCurrentCycle();\n      if (!currentCycle) {\n        return res.status(400).json({ error: \"No active cycle\" });\n      }\n      \n      // Normalize the text\n      const normalizedText = normalizeText(body.text);\n      \n      const item = await storage.addCorpusItem({\n        trackId: body.trackId,\n        cycleId: currentCycle.id,\n        normalizedText,\n        sourceAttemptId: body.sourceAttemptId,\n      });\n      \n      res.json(item);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Add corpus item error:\", error);\n      res.status(500).json({ error: \"Failed to add corpus item\" });\n    }\n  });\n\n  // Update corpus item (Creator only)\n  const updateCorpusItemSchema = z.object({\n    text: z.string().optional(),\n    trackId: z.string().optional(),\n  });\n\n  app.put(\"/api/corpus/:id\", requireAuthMiddleware, requireCreator, async (req: Request, res: Response) => {\n    try {\n      const body = updateCorpusItemSchema.parse(req.body);\n      \n      if (!body.text && !body.trackId) {\n        return res.status(400).json({ error: \"text or trackId required\" });\n      }\n      \n      // Normalize text if provided and validate it's not empty after normalization\n      let normalizedText: string | undefined;\n      if (body.text) {\n        normalizedText = normalizeText(body.text);\n        if (!normalizedText || normalizedText.length === 0) {\n          return res.status(400).json({ error: \"Text cannot be empty after normalization\" });\n        }\n      }\n      \n      // Ensure we have at least one valid update\n      if (!normalizedText && !body.trackId) {\n        return res.status(400).json({ error: \"No valid updates provided\" });\n      }\n      \n      const item = await storage.updateCorpusItem(req.params.id, normalizedText, body.trackId);\n      if (!item) {\n        return res.status(404).json({ error: \"Corpus item not found\" });\n      }\n      res.json(item);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Update corpus item error:\", error);\n      res.status(500).json({ error: \"Failed to update corpus item\" });\n    }\n  });\n\n  // Delete corpus item (Creator only)\n  app.delete(\"/api/corpus/:id\", requireAuthMiddleware, requireCreator, async (req: Request, res: Response) => {\n    try {\n      await storage.deleteCorpusItem(req.params.id);\n      res.json({ success: true });\n    } catch (error) {\n      console.error(\"Delete corpus item error:\", error);\n      res.status(500).json({ error: \"Failed to delete corpus item\" });\n    }\n  });\n\n  // Check if current user is creator\n  app.get(\"/api/auth/is-creator\", requireAuthMiddleware, (req: Request, res: Response) => {\n    const publicKey = (req as any).publicKey;\n    res.json({ isCreator: isCreator(publicKey) });\n  });\n\n  // ===== AI CHAT =====\n  const chatMessageSchema = z.object({\n    message: z.string().min(1).max(2000),\n    track: z.string().optional(),\n    aiLevel: z.number().int().min(1).max(100),\n  });\n\n  app.post(\"/api/ai/chat\", requireAuthMiddleware, requireHiveAccess, async (req: Request, res: Response) => {\n    try {\n      const body = chatMessageSchema.parse(req.body);\n      const publicKey = (req as any).publicKey;\n      \n      // Validate aiLevel server-side: clamp to reasonable range (1-100)\n      // In a production system, this would be fetched from stored user progress\n      const aiLevel = Math.max(1, Math.min(100, body.aiLevel));\n      \n      // Look up trackId if track name provided\n      let trackId: string | undefined;\n      if (body.track) {\n        const tracks = await storage.getAllTracks();\n        const matchedTrack = tracks.find(t => t.name.toLowerCase() === body.track!.toLowerCase());\n        trackId = matchedTrack?.id;\n      }\n      \n      // Generate response using Ollama\n      const { generateChatResponse } = await import(\"./aiChat\");\n      const { response, corpusItemsUsed } = await generateChatResponse(\n        body.message,\n        aiLevel,\n        trackId\n      );\n      \n      // Save to chat history\n      const chatMessage = await storage.saveChatMessage({\n        walletAddress: publicKey,\n        trackId,\n        aiLevel: body.aiLevel,\n        userMessage: body.message,\n        aiResponse: response,\n        corpusItemsUsed,\n      });\n      \n      res.json({\n        id: chatMessage.id,\n        response,\n        corpusItemsUsed: corpusItemsUsed.length,\n        aiLevel,\n        track: body.track,\n      });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"AI chat error:\", error);\n      res.status(500).json({ error: \"Failed to generate response\" });\n    }\n  });\n\n  app.get(\"/api/ai/chat/history\", requireAuthMiddleware, requireHiveAccess, async (req: Request, res: Response) => {\n    try {\n      const publicKey = (req as any).publicKey;\n      const limit = Math.min(parseInt(req.query.limit as string) || 50, 100);\n      \n      const history = await storage.getChatHistory(publicKey, limit);\n      res.json(history);\n    } catch (error) {\n      console.error(\"Chat history error:\", error);\n      res.status(500).json({ error: \"Failed to fetch chat history\" });\n    }\n  });\n\n  // ===== TRAIN ATTEMPTS =====\n  const submitAttemptSchema = z.object({\n    trackId: z.string(),\n    difficulty: z.enum([\"low\", \"medium\", \"high\", \"extreme\"]),\n    content: z.string().min(1),\n  });\n\n  app.post(\"/api/train-attempts/submit\", requireAuthMiddleware, requireHiveAccess, async (req: Request, res: Response) => {\n    // For backward compatibility, try to get userId from old system\n    // In the future, you may want to link wallet addresses to user accounts\n    const userId = (req as any).userId || (req as any).publicKey || null;\n    if (!userId) {\n      return res.status(401).json({ error: \"User ID required\" });\n    }\n    \n    try {\n      const body = submitAttemptSchema.parse(req.body);\n      const currentCycle = await storage.getCurrentCycle();\n      if (!currentCycle) {\n        return res.status(400).json({ error: \"No active cycle\" });\n      }\n      \n      const cost = getCostByDifficulty(body.difficulty);\n      \n      // Generate evidence packet (simulated)\n      const evidencePacket = {\n        phrases: [],\n        topics: [],\n        timestamp: new Date().toISOString(),\n      };\n      \n      const attempt = await storage.createTrainAttempt({\n        userId,\n        trackId: body.trackId,\n        difficulty: body.difficulty,\n        cost,\n        content: body.content,\n        cycleId: currentCycle.id,\n      });\n      \n      // Update evidence packet\n      await storage.updateAttemptStatus(attempt.id, attempt.status as \"approved\" | \"rejected\", evidencePacket);\n      \n      res.json(attempt);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Submit attempt error:\", error);\n      res.status(500).json({ error: \"Failed to submit attempt\" });\n    }\n  });\n\n  app.get(\"/api/train-attempts/pending\", async (req: Request, res: Response) => {\n    if (!(await requireReviewer(req, res))) return;\n    \n    try {\n      const attempts = await storage.getPendingAttempts();\n      res.json(attempts);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch pending attempts\" });\n    }\n  });\n\n  app.get(\"/api/train-attempts/:id\", async (req: Request, res: Response) => {\n    const userId = requireAuth(req, res);\n    if (!userId) return;\n    \n    try {\n      const attempt = await storage.getAttemptById(req.params.id);\n      if (!attempt) {\n        return res.status(404).json({ error: \"Attempt not found\" });\n      }\n      \n      // Users can only see their own attempts, reviewers can see all\n      const user = await storage.getUser(userId);\n      if (attempt.userId !== userId && !user?.isReviewer) {\n        return res.status(403).json({ error: \"Access denied\" });\n      }\n      \n      res.json(attempt);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch attempt\" });\n    }\n  });\n\n  // ===== REVIEWS =====\n  const submitReviewSchema = z.object({\n    attemptId: z.string(),\n    vote: z.enum([\"approve\", \"reject\"]),\n  });\n\n  app.post(\"/api/reviews/submit\", async (req: Request, res: Response) => {\n    const reviewerId = await requireReviewer(req, res);\n    if (!reviewerId) return;\n    \n    try {\n      const body = submitReviewSchema.parse(req.body);\n      \n      // Check if already voted\n      const hasVoted = await storage.hasReviewerVoted(body.attemptId, reviewerId);\n      if (hasVoted) {\n        return res.status(400).json({ error: \"Already voted on this attempt\" });\n      }\n      \n      const attempt = await storage.getAttemptById(body.attemptId);\n      if (!attempt) {\n        return res.status(404).json({ error: \"Attempt not found\" });\n      }\n      \n      if (attempt.status !== \"pending\") {\n        return res.status(400).json({ error: \"Attempt already reviewed\" });\n      }\n      \n      const review = await storage.createReview(body.attemptId, reviewerId, body.vote);\n      \n      // Check consensus\n      const consensus = await storage.checkReviewConsensus(body.attemptId, attempt.difficulty);\n      \n      if (consensus.met) {\n        // Approve attempt\n        await storage.updateAttemptStatus(body.attemptId, \"approved\");\n        \n        // Process economics: refund 80%, lock 20%, add 5% from pool\n        const cost = parseFloat(attempt.cost);\n        const refundAmount = (cost * 0.8).toString();\n        const lockAmount = (cost * 0.2).toString();\n        const poolBonus = (cost * 0.05).toString();\n        const totalLock = (parseFloat(lockAmount) + parseFloat(poolBonus)).toString();\n        \n        const currentCycle = await storage.getCurrentCycle();\n        if (currentCycle && attempt.userId) {\n          await storage.createLock({\n            userId: attempt.userId,\n            attemptId: attempt.id,\n            amount: totalLock,\n            originalAmount: lockAmount,\n            cycleCreated: currentCycle.cycleNumber,\n          });\n          \n          await storage.subtractFromTrainingPool(poolBonus);\n        }\n      } else {\n        // Check if we have enough reject votes to reject\n        const requiredRejects = attempt.difficulty === \"low\" || attempt.difficulty === \"medium\" ? 2 : 3;\n        if (consensus.rejectCount >= requiredRejects) {\n          // Reject attempt\n          await storage.updateAttemptStatus(body.attemptId, \"rejected\");\n          \n          // Process economics: 50% burn, 50% to pool\n          const cost = parseFloat(attempt.cost);\n          const poolAmount = (cost * 0.5).toString();\n          await storage.addToTrainingPool(poolAmount);\n        }\n      }\n      \n      res.json({ review, consensus });\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      console.error(\"Submit review error:\", error);\n      res.status(500).json({ error: \"Failed to submit review\" });\n    }\n  });\n\n  app.get(\"/api/reviews/attempt/:attemptId\", async (req: Request, res: Response) => {\n    const userId = requireAuth(req, res);\n    if (!userId) return;\n    \n    try {\n      const reviews = await storage.getReviewsForAttempt(req.params.attemptId);\n      res.json(reviews);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch reviews\" });\n    }\n  });\n\n  // ===== HUB =====\n  app.get(\"/api/hub/posts\", async (req: Request, res: Response) => {\n    try {\n      const limit = req.query.limit ? parseInt(req.query.limit as string) : 50;\n      const posts = await storage.getHubPosts(limit);\n      res.json(posts);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch hub posts\" });\n    }\n  });\n\n  const submitHubPostSchema = z.object({\n    content: z.string().min(1),\n  });\n\n  app.post(\"/api/hub/submit\", requireAuthMiddleware, requireHiveAccess, async (req: Request, res: Response) => {\n    // For backward compatibility, try to get userId from old system\n    const userId = (req as any).userId || (req as any).publicKey || null;\n    if (!userId) {\n      return res.status(401).json({ error: \"User ID required\" });\n    }\n    \n    try {\n      const body = submitHubPostSchema.parse(req.body);\n      const fee = \"5\"; // Fixed fee Y\n      \n      const submission = await storage.createHubSubmission(userId, body.content, fee);\n      res.json(submission);\n    } catch (error) {\n      if (error instanceof z.ZodError) {\n        return res.status(400).json({ error: error.errors });\n      }\n      res.status(500).json({ error: \"Failed to submit hub post\" });\n    }\n  });\n\n  app.get(\"/api/hub/submissions/pending\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    \n    try {\n      const submissions = await storage.getPendingHubSubmissions();\n      res.json(submissions);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch pending submissions\" });\n    }\n  });\n\n  app.post(\"/api/hub/submissions/:id/approve\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    \n    try {\n      const submission = await storage.getHubSubmissionById(req.params.id);\n      if (!submission) {\n        return res.status(404).json({ error: \"Submission not found\" });\n      }\n      if (submission.status !== \"pending\") {\n        return res.status(400).json({ error: \"Submission already reviewed\" });\n      }\n      \n      const updated = await storage.updateHubSubmissionStatus(req.params.id, \"approved\");\n      \n      // Create hub post\n      const currentCycle = await storage.getCurrentCycle();\n      if (currentCycle && submission.userId) {\n        await storage.createHubPost(submission.userId, submission.content, currentCycle.id);\n      }\n      \n      // Process economics: 50% burn, 50% to pool\n      const fee = parseFloat(submission.fee);\n      const poolAmount = (fee * 0.5).toString();\n      await storage.addToTrainingPool(poolAmount);\n      \n      res.json(updated);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to approve submission\" });\n    }\n  });\n\n  app.post(\"/api/hub/submissions/:id/reject\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    \n    try {\n      const updated = await storage.updateHubSubmissionStatus(req.params.id, \"rejected\");\n      // Rejected = full refund (handled on frontend)\n      res.json(updated);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to reject submission\" });\n    }\n  });\n\n  // ===== ADMIN =====\n  app.get(\"/api/admin/users\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    \n    // Simplified - in real app, add pagination\n    res.json({ message: \"User list endpoint - implement as needed\" });\n  });\n\n  app.post(\"/api/admin/users/:id/role\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    \n    try {\n      const { role, value } = req.body;\n      if (![\"reviewer\", \"hubPoster\", \"admin\"].includes(role)) {\n        return res.status(400).json({ error: \"Invalid role\" });\n      }\n      \n      const user = await storage.updateUserRole(req.params.id, role, value);\n      res.json(user);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to update user role\" });\n    }\n  });\n\n  app.get(\"/api/admin/model-status\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    \n    try {\n      const activeModel = await storage.getActiveModelVersion();\n      const allModels = await storage.getAllModelVersions();\n      const latestBenchmark = await storage.getLatestBenchmark();\n      \n      res.json({\n        activeModel,\n        allModels,\n        latestBenchmark,\n      });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch model status\" });\n    }\n  });\n\n  app.get(\"/api/admin/training-pool\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    \n    try {\n      const amount = await storage.getTrainingPoolAmount();\n      res.json({ amount });\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch training pool\" });\n    }\n  });\n\n  // ===== CODE EDITOR (Admin Only) =====\n  const ADMIN_EDIT_KEY = process.env.ADMIN_EDIT_KEY || \"\";\n\n  function checkAdminKey(req: Request): boolean {\n    const providedKey = req.headers[\"x-admin-key\"] as string;\n    if (!ADMIN_EDIT_KEY) {\n      return false; // No key set, deny access\n    }\n    return providedKey === ADMIN_EDIT_KEY;\n  }\n\n  // List files in client/src directory\n  const scanDirectory = async (\n    dir: string,\n    basePath: string,\n    files: Array<{ path: string; type: \"file\" | \"directory\" }>\n  ): Promise<void> => {\n    const entries = await readdir(dir, { withFileTypes: true });\n    \n    for (const entry of entries) {\n      const fullPath = join(dir, entry.name);\n      const relativePath = basePath ? `${basePath}/${entry.name}` : entry.name;\n      \n      // Skip node_modules, .git, dist, build, etc.\n      if (entry.name.startsWith(\".\") || entry.name === \"node_modules\" || entry.name === \"dist\" || entry.name === \"build\") {\n        continue;\n      }\n\n      if (entry.isDirectory()) {\n        await scanDirectory(fullPath, relativePath, files);\n      } else if (entry.isFile() && (entry.name.endsWith(\".tsx\") || entry.name.endsWith(\".ts\") || entry.name.endsWith(\".css\") || entry.name.endsWith(\".json\"))) {\n        files.push({ path: `client/src/${relativePath}`, type: \"file\" });\n      }\n    }\n  };\n\n  app.get(\"/api/admin/files/list\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    \n    try {\n      const clientSrcPath = join(process.cwd(), \"client\", \"src\");\n      const files: Array<{ path: string; type: \"file\" | \"directory\" }> = [];\n\n      await scanDirectory(clientSrcPath, \"\", files);\n      res.json({ files: files.sort((a, b) => a.path.localeCompare(b.path)) });\n    } catch (error) {\n      console.error(\"List files error:\", error);\n      res.status(500).json({ error: \"Failed to list files\" });\n    }\n  });\n\n  // Read a file\n  app.get(\"/api/admin/files/read\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    if (!checkAdminKey(req)) {\n      return res.status(403).json({ error: \"Admin key required\" });\n    }\n\n    try {\n      const filePath = req.query.path as string;\n      if (!filePath) {\n        return res.status(400).json({ error: \"Path parameter required\" });\n      }\n\n      // Security: Only allow files in client/src\n      // Normalize path - handle both \"client/src/...\" and relative paths\n      let safePath = filePath;\n      if (!safePath.startsWith(\"client/src/\")) {\n        safePath = `client/src/${safePath}`;\n      }\n\n      // Prevent directory traversal\n      if (safePath.includes(\"..\")) {\n        return res.status(403).json({ error: \"Access denied: Invalid path\" });\n      }\n\n      const fullPath = join(process.cwd(), safePath);\n      const normalizedPath = fullPath.replace(/\\\\/g, \"/\");\n      const clientSrcPath = join(process.cwd(), \"client\", \"src\").replace(/\\\\/g, \"/\");\n      \n      if (!normalizedPath.startsWith(clientSrcPath)) {\n        return res.status(403).json({ error: \"Access denied: File outside allowed directory\" });\n      }\n\n      const content = await readFile(fullPath, \"utf-8\");\n      res.json({ content, path: safePath });\n    } catch (error: any) {\n      if (error.code === \"ENOENT\") {\n        return res.status(404).json({ error: \"File not found\" });\n      }\n      console.error(\"Read file error:\", error);\n      res.status(500).json({ error: \"Failed to read file\" });\n    }\n  });\n\n  // Save a file\n  app.post(\"/api/admin/files/save\", async (req: Request, res: Response) => {\n    if (!(await requireAdmin(req, res))) return;\n    if (!checkAdminKey(req)) {\n      return res.status(403).json({ error: \"Admin key required\" });\n    }\n\n    try {\n      const { path: filePath, content } = req.body;\n      if (!filePath || typeof content !== \"string\") {\n        return res.status(400).json({ error: \"Path and content required\" });\n      }\n\n      // Security: Only allow files in client/src\n      const safePath = filePath.startsWith(\"client/src/\") \n        ? filePath \n        : `client/src/${filePath}`;\n      const fullPath = join(process.cwd(), safePath);\n      const normalizedPath = fullPath.replace(/\\\\/g, \"/\");\n      const clientSrcPath = join(process.cwd(), \"client\", \"src\").replace(/\\\\/g, \"/\");\n      \n      if (!normalizedPath.startsWith(clientSrcPath)) {\n        return res.status(403).json({ error: \"Access denied: File outside allowed directory\" });\n      }\n\n      // Prevent saving outside allowed extensions\n      if (!filePath.match(/\\.(tsx?|css|json)$/)) {\n        return res.status(403).json({ error: \"Only .ts, .tsx, .css, and .json files can be edited\" });\n      }\n\n      await writeFile(fullPath, content, \"utf-8\");\n      res.json({ success: true, path: safePath });\n    } catch (error: any) {\n      console.error(\"Save file error:\", error);\n      res.status(500).json({ error: \"Failed to save file\" });\n    }\n  });\n\n  // ===== USER LOCKS =====\n  app.get(\"/api/locks\", async (req: Request, res: Response) => {\n    const userId = requireAuth(req, res);\n    if (!userId) return;\n    \n    try {\n      const userLocks = await storage.getActiveLocks(userId);\n      res.json(userLocks);\n    } catch (error) {\n      res.status(500).json({ error: \"Failed to fetch locks\" });\n    }\n  });\n\n  return httpServer;\n}\n","path":null,"size_bytes":33410,"size_tokens":null},"client/src/components/ui/skeleton.tsx":{"content":"import { cn } from \"@/lib/utils\"\n\nfunction Skeleton({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) {\n  return (\n    <div\n      className={cn(\"animate-pulse rounded-md bg-muted\", className)}\n      {...props}\n    />\n  )\n}\n\nexport { Skeleton }\n","path":null,"size_bytes":261,"size_tokens":null},"client/src/components/game/ScoringRules.tsx":{"content":"import { CheckCircle, ArrowRight, XCircle } from \"lucide-react\";\n\nexport default function ScoringRules() {\n  return (\n    <div className=\"p-4 rounded-lg bg-muted/30 space-y-2\" data-testid=\"scoring-rules\">\n      <div className=\"flex items-start gap-2\">\n        <CheckCircle className=\"w-4 h-4 text-success mt-0.5 shrink-0\" />\n        <span className=\"text-sm text-muted-foreground\">\n          Score 70% or higher: your AI learns and gets smarter.\n        </span>\n      </div>\n      <div className=\"flex items-start gap-2\">\n        <ArrowRight className=\"w-4 h-4 text-muted-foreground mt-0.5 shrink-0\" />\n        <span className=\"text-sm text-muted-foreground\">\n          Score between 50% and 69%: your AI learns nothing this session.\n        </span>\n      </div>\n      <div className=\"flex items-start gap-2\">\n        <XCircle className=\"w-4 h-4 text-destructive mt-0.5 shrink-0\" />\n        <span className=\"text-sm text-muted-foreground\">\n          Score below 50%: your AI can lose intelligence.\n        </span>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1045,"size_tokens":null},"client/src/components/examples/ResultCardExample.tsx":{"content":"import ResultCard from \"../game/ResultCard\";\n\nexport default function ResultCardExample() {\n  return (\n    <ResultCard\n      correctCount={7}\n      totalQuestions={10}\n      previousState={{\n        intelligenceLevel: 2,\n        intelligenceScore: 120,\n        totalSessions: 5,\n        bestScorePercent: 60,\n      }}\n      newState={{\n        intelligenceLevel: 3,\n        intelligenceScore: 190,\n        totalSessions: 6,\n        bestScorePercent: 70,\n      }}\n      onBackToHome={() => console.log(\"Back to home clicked\")}\n      onTrainAgain={() => console.log(\"Train again clicked\")}\n    />\n  );\n}\n","path":null,"size_bytes":602,"size_tokens":null},"client/src/lib/queryClient.ts":{"content":"import { QueryClient, QueryFunction } from \"@tanstack/react-query\";\n\nasync function throwIfResNotOk(res: Response) {\n  if (!res.ok) {\n    const text = (await res.text()) || res.statusText;\n    throw new Error(`${res.status}: ${text}`);\n  }\n}\n\nexport async function apiRequest(\n  method: string,\n  url: string,\n  data?: unknown | undefined,\n): Promise<Response> {\n  const res = await fetch(url, {\n    method,\n    headers: data ? { \"Content-Type\": \"application/json\" } : {},\n    body: data ? JSON.stringify(data) : undefined,\n    credentials: \"include\",\n  });\n\n  await throwIfResNotOk(res);\n  return res;\n}\n\ntype UnauthorizedBehavior = \"returnNull\" | \"throw\";\nexport const getQueryFn: <T>(options: {\n  on401: UnauthorizedBehavior;\n}) => QueryFunction<T> =\n  ({ on401: unauthorizedBehavior }) =>\n  async ({ queryKey }) => {\n    const res = await fetch(queryKey.join(\"/\") as string, {\n      credentials: \"include\",\n    });\n\n    if (unauthorizedBehavior === \"returnNull\" && res.status === 401) {\n      return null;\n    }\n\n    await throwIfResNotOk(res);\n    return await res.json();\n  };\n\nexport const queryClient = new QueryClient({\n  defaultOptions: {\n    queries: {\n      queryFn: getQueryFn({ on401: \"throw\" }),\n      refetchInterval: false,\n      refetchOnWindowFocus: false,\n      staleTime: Infinity,\n      retry: false,\n    },\n    mutations: {\n      retry: false,\n    },\n  },\n});\n","path":null,"size_bytes":1383,"size_tokens":null},"client/src/components/ui/toggle.tsx":{"content":"import * as React from \"react\"\nimport * as TogglePrimitive from \"@radix-ui/react-toggle\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst toggleVariants = cva(\n  \"inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors hover:bg-muted hover:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=on]:bg-accent data-[state=on]:text-accent-foreground [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0 gap-2\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-transparent\",\n        outline:\n          \"border border-input bg-transparent hover:bg-accent hover:text-accent-foreground\",\n      },\n      size: {\n        default: \"h-10 px-3 min-w-10\",\n        sm: \"h-9 px-2.5 min-w-9\",\n        lg: \"h-11 px-5 min-w-11\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nconst Toggle = React.forwardRef<\n  React.ElementRef<typeof TogglePrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof TogglePrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, ...props }, ref) => (\n  <TogglePrimitive.Root\n    ref={ref}\n    className={cn(toggleVariants({ variant, size, className }))}\n    {...props}\n  />\n))\n\nToggle.displayName = TogglePrimitive.Root.displayName\n\nexport { Toggle, toggleVariants }\n","path":null,"size_bytes":1527,"size_tokens":null},"client/src/components/ui/button.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\" +\n  \" hover-elevate active-elevate-2\",\n  {\n    variants: {\n      variant: {\n        default:\n          \"bg-primary text-primary-foreground border border-primary-border\",\n        destructive:\n          \"bg-destructive text-destructive-foreground border border-destructive-border\",\n        outline:\n          // Shows the background color of whatever card / sidebar / accent background it is inside of.\n          // Inherits the current text color.\n          \" border [border-color:var(--button-outline)]  shadow-xs active:shadow-none \",\n        secondary: \"border bg-secondary text-secondary-foreground border border-secondary-border \",\n        // Add a transparent border so that when someone toggles a border on later, it doesn't shift layout/size.\n        ghost: \"border border-transparent\",\n      },\n      // Heights are set as \"min\" heights, because sometimes Ai will place large amount of content\n      // inside buttons. With a min-height they will look appropriate with small amounts of content,\n      // but will expand to fit large amounts of content.\n      size: {\n        default: \"min-h-9 px-4 py-2\",\n        sm: \"min-h-8 rounded-md px-3 text-xs\",\n        lg: \"min-h-10 rounded-md px-8\",\n        icon: \"h-9 w-9\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  },\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  },\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n","path":null,"size_bytes":2359,"size_tokens":null},"client/src/components/examples/TokenGateExample.tsx":{"content":"import TokenGate from \"../game/TokenGate\";\n\nexport default function TokenGateExample() {\n  return (\n    <div className=\"space-y-4\">\n      <TokenGate balance={0} isLoading={true} />\n      <TokenGate balance={150} isLoading={false} />\n      <TokenGate balance={25} isLoading={false} />\n    </div>\n  );\n}\n","path":null,"size_bytes":302,"size_tokens":null},"client/src/components/ui/card.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"shadcn-card rounded-xl border bg-card border-card-border text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n));\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n));\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n));\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\nexport {\n  Card,\n  CardHeader,\n  CardFooter,\n  CardTitle,\n  CardDescription,\n  CardContent,\n}\n","path":null,"size_bytes":1904,"size_tokens":null},"client/src/main.tsx":{"content":"import { createRoot } from \"react-dom/client\";\nimport App from \"./App\";\nimport \"./index.css\";\n\ncreateRoot(document.getElementById(\"root\")!).render(<App />);\n","path":null,"size_bytes":157,"size_tokens":null},"client/src/components/examples/HomeScreenExample.tsx":{"content":"import { useState } from \"react\";\nimport HomeScreen from \"../game/HomeScreen\";\n\nexport default function HomeScreenExample() {\n  const [level, setLevel] = useState(3);\n\n  return (\n    <HomeScreen\n      state={{\n        intelligenceLevel: 5,\n        intelligenceScore: 340,\n        totalSessions: 12,\n        bestScorePercent: 90,\n        currentLevel: level,\n        maxUnlockedLevel: 5,\n        styleCredits: 200,\n        ownedSkins: [\"skin_default\", \"skin_glitched\"],\n        ownedAuras: [\"aura_blue\"],\n        equippedSkin: \"skin_glitched\",\n        equippedAura: \"aura_blue\",\n      }}\n      onStartTraining={() => console.log(\"Start training clicked\")}\n      onLevelChange={(newLevel) => setLevel(newLevel)}\n      onBuySkin={(id) => console.log(\"Buy skin:\", id)}\n      onBuyAura={(id) => console.log(\"Buy aura:\", id)}\n      onEquipSkin={(id) => console.log(\"Equip skin:\", id)}\n      onEquipAura={(id) => console.log(\"Equip aura:\", id)}\n      walletAddress=\"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\"\n      tokenBalance={150}\n      isLoadingBalance={false}\n    />\n  );\n}\n","path":null,"size_bytes":1075,"size_tokens":null},"client/src/components/game/WalletButton.tsx":{"content":"import { useState, useEffect, useCallback } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Wallet, LogOut, Loader2, ExternalLink } from \"lucide-react\";\nimport {\n  connectWallet,\n  disconnectWallet,\n  getPhantomProvider,\n  shortenAddress,\n  isPhantomInstalled,\n  authenticateWithServer,\n  checkGateStatus,\n} from \"@/lib/solanaWallet\";\n\ninterface WalletButtonProps {\n  onConnect: (address: string) => void;\n  onDisconnect: () => void;\n  connectedAddress: string | null;\n  onGateStatusChange?: (hasAccess: boolean) => void;\n}\n\nexport default function WalletButton({\n  onConnect,\n  onDisconnect,\n  connectedAddress,\n  onGateStatusChange,\n}: WalletButtonProps) {\n  const [isConnecting, setIsConnecting] = useState(false);\n  const [hasPhantom, setHasPhantom] = useState(false);\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n\n  useEffect(() => {\n    // Check if Phantom is installed\n    setHasPhantom(isPhantomInstalled());\n\n    // Listen for wallet connection changes\n    const provider = getPhantomProvider();\n    if (provider) {\n      const handleConnect = () => {\n        if (provider.publicKey) {\n          onConnect(provider.publicKey.toString());\n        }\n      };\n\n      const handleDisconnect = () => {\n        onDisconnect();\n      };\n\n      provider.on(\"connect\", handleConnect);\n      provider.on(\"disconnect\", handleDisconnect);\n\n      // Check if already connected\n      if (provider.isConnected && provider.publicKey) {\n        onConnect(provider.publicKey.toString());\n      }\n\n      return () => {\n        provider.off(\"connect\", handleConnect);\n        provider.off(\"disconnect\", handleDisconnect);\n      };\n    }\n  }, [onConnect, onDisconnect]);\n\n  const handleConnect = useCallback(async () => {\n    setIsConnecting(true);\n    try {\n      const address = await connectWallet();\n      if (address) {\n        onConnect(address);\n        \n        // Authenticate with server\n        setIsAuthenticating(true);\n        try {\n          const authenticated = await authenticateWithServer(address);\n          if (authenticated) {\n            // Check gate status\n            const gateStatus = await checkGateStatus();\n            if (gateStatus && onGateStatusChange) {\n              onGateStatusChange(gateStatus.hasAccess);\n            }\n          }\n        } finally {\n          setIsAuthenticating(false);\n        }\n      }\n    } finally {\n      setIsConnecting(false);\n    }\n  }, [onConnect, onGateStatusChange]);\n\n  const handleDisconnect = useCallback(async () => {\n    await disconnectWallet();\n    onDisconnect();\n  }, [onDisconnect]);\n\n  if (connectedAddress) {\n    return (\n      <div className=\"flex items-center gap-2\" data-testid=\"wallet-connected-container\">\n        <div className=\"flex items-center gap-2 px-3 py-2 rounded-lg bg-muted/50 border border-border/50\">\n          <div className=\"w-2 h-2 rounded-full bg-success animate-pulse\" />\n          <span className=\"text-sm font-medium text-foreground\" data-testid=\"text-wallet-address\">\n            {shortenAddress(connectedAddress)}\n          </span>\n        </div>\n        <Button\n          variant=\"ghost\"\n          size=\"icon\"\n          onClick={handleDisconnect}\n          data-testid=\"button-disconnect-wallet\"\n        >\n          <LogOut className=\"w-4 h-4\" />\n        </Button>\n      </div>\n    );\n  }\n\n  if (!hasPhantom) {\n    return (\n      <Button\n        variant=\"outline\"\n        onClick={() => window.open(\"https://phantom.app/\", \"_blank\")}\n        data-testid=\"button-install-phantom\"\n      >\n        <ExternalLink className=\"w-4 h-4 mr-2\" />\n        Install Phantom\n      </Button>\n    );\n  }\n\n  return (\n    <Button\n      variant=\"outline\"\n      onClick={handleConnect}\n      disabled={isConnecting}\n      data-testid=\"button-connect-wallet\"\n    >\n      {isConnecting ? (\n        <>\n          <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n          Connecting...\n        </>\n      ) : (\n        <>\n          <Wallet className=\"w-4 h-4 mr-2\" />\n          Connect Wallet\n        </>\n      )}\n    </Button>\n  );\n}\n","path":null,"size_bytes":4055,"size_tokens":null},"client/src/components/examples/StatsGridExample.tsx":{"content":"import StatsGrid from \"../game/StatsGrid\";\n\nexport default function StatsGridExample() {\n  return (\n    <StatsGrid\n      state={{\n        intelligenceLevel: 5,\n        intelligenceScore: 340,\n        totalSessions: 12,\n        bestScorePercent: 90,\n      }}\n    />\n  );\n}\n","path":null,"size_bytes":272,"size_tokens":null},"client/src/components/ui/checkbox.tsx":{"content":"import * as React from \"react\"\nimport * as CheckboxPrimitive from \"@radix-ui/react-checkbox\"\nimport { Check } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Checkbox = React.forwardRef<\n  React.ElementRef<typeof CheckboxPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof CheckboxPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <CheckboxPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground\",\n      className\n    )}\n    {...props}\n  >\n    <CheckboxPrimitive.Indicator\n      className={cn(\"flex items-center justify-center text-current\")}\n    >\n      <Check className=\"h-4 w-4\" />\n    </CheckboxPrimitive.Indicator>\n  </CheckboxPrimitive.Root>\n))\nCheckbox.displayName = CheckboxPrimitive.Root.displayName\n\nexport { Checkbox }\n","path":null,"size_bytes":1056,"size_tokens":null},"client/src/components/game/IntelligenceProgressBar.tsx":{"content":"interface IntelligenceProgressBarProps {\n  level: number;\n  score: number;\n}\n\nexport default function IntelligenceProgressBar({ level, score }: IntelligenceProgressBarProps) {\n  const pointsPerLevel = 100;\n  const progressInCurrentLevel = score % pointsPerLevel;\n  const progressPercent = (progressInCurrentLevel / pointsPerLevel) * 100;\n\n  return (\n    <div className=\"space-y-2\" data-testid=\"intelligence-progress\">\n      <div className=\"flex items-center justify-between text-xs\">\n        <span className=\"text-muted-foreground\">Intelligence Progress</span>\n        <span className=\"text-foreground font-medium\">\n          Level {level} → {level + 1}\n        </span>\n      </div>\n      <div className=\"h-2 w-full bg-background/50 rounded-full overflow-hidden border border-border/30\">\n        <div\n          className=\"h-full bg-gradient-to-r from-primary to-primary/70 transition-all duration-500 ease-out\"\n          style={{ width: `${progressPercent}%` }}\n        />\n      </div>\n      <p className=\"text-[10px] text-muted-foreground text-center\">\n        {progressInCurrentLevel} / {pointsPerLevel} points to next level\n      </p>\n    </div>\n  );\n}\n","path":null,"size_bytes":1158,"size_tokens":null},"client/src/components/ui/toggle-group.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ToggleGroupPrimitive from \"@radix-ui/react-toggle-group\"\nimport { type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\nimport { toggleVariants } from \"@/components/ui/toggle\"\n\nconst ToggleGroupContext = React.createContext<\n  VariantProps<typeof toggleVariants>\n>({\n  size: \"default\",\n  variant: \"default\",\n})\n\nconst ToggleGroup = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Root> &\n    VariantProps<typeof toggleVariants>\n>(({ className, variant, size, children, ...props }, ref) => (\n  <ToggleGroupPrimitive.Root\n    ref={ref}\n    className={cn(\"flex items-center justify-center gap-1\", className)}\n    {...props}\n  >\n    <ToggleGroupContext.Provider value={{ variant, size }}>\n      {children}\n    </ToggleGroupContext.Provider>\n  </ToggleGroupPrimitive.Root>\n))\n\nToggleGroup.displayName = ToggleGroupPrimitive.Root.displayName\n\nconst ToggleGroupItem = React.forwardRef<\n  React.ElementRef<typeof ToggleGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ToggleGroupPrimitive.Item> &\n    VariantProps<typeof toggleVariants>\n>(({ className, children, variant, size, ...props }, ref) => {\n  const context = React.useContext(ToggleGroupContext)\n\n  return (\n    <ToggleGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        toggleVariants({\n          variant: context.variant || variant,\n          size: context.size || size,\n        }),\n        className\n      )}\n      {...props}\n    >\n      {children}\n    </ToggleGroupPrimitive.Item>\n  )\n})\n\nToggleGroupItem.displayName = ToggleGroupPrimitive.Item.displayName\n\nexport { ToggleGroup, ToggleGroupItem }\n","path":null,"size_bytes":1753,"size_tokens":null},"client/src/lib/cosmetics.ts":{"content":"export interface CosmeticItem {\n  id: string;\n  name: string;\n  description: string;\n  price: number;\n  type: \"skin\" | \"aura\";\n}\n\nexport const AVATAR_SKINS: CosmeticItem[] = [\n  {\n    id: \"skin_default\",\n    name: \"Default Core\",\n    description: \"Standard training shell.\",\n    price: 0,\n    type: \"skin\",\n  },\n  {\n    id: \"skin_glitched\",\n    name: \"Glitched Core\",\n    description: \"A core flickering with unstable data.\",\n    price: 100,\n    type: \"skin\",\n  },\n  {\n    id: \"skin_overclocked\",\n    name: \"Overclocked Core\",\n    description: \"Running dangerously close to thermal limits.\",\n    price: 200,\n    type: \"skin\",\n  },\n];\n\nexport const AURA_STYLES: CosmeticItem[] = [\n  {\n    id: \"aura_blue\",\n    name: \"Neon Blue Aura\",\n    description: \"Cool, stable neural glow.\",\n    price: 50,\n    type: \"aura\",\n  },\n  {\n    id: \"aura_purple\",\n    name: \"Neon Purple Aura\",\n    description: \"Mysterious experimental field.\",\n    price: 75,\n    type: \"aura\",\n  },\n  {\n    id: \"aura_green\",\n    name: \"Neon Green Aura\",\n    description: \"Overloaded optimization circuits.\",\n    price: 100,\n    type: \"aura\",\n  },\n];\n\nexport function getSkinById(id: string): CosmeticItem | undefined {\n  return AVATAR_SKINS.find((s) => s.id === id);\n}\n\nexport function getAuraById(id: string): CosmeticItem | undefined {\n  return AURA_STYLES.find((a) => a.id === id);\n}\n\nexport function getSkinEmoji(skinId: string, intelligenceLevel: number): string {\n  switch (skinId) {\n    case \"skin_glitched\":\n      return \"\\u{1F9E0}\\u{1F4A5}\";\n    case \"skin_overclocked\":\n      return \"\\u{1F525}\\u{1F916}\";\n    case \"skin_default\":\n    default:\n      if (intelligenceLevel <= 3) {\n        return \"\\u{1F916}\\u{1F4A4}\";\n      } else if (intelligenceLevel <= 7) {\n        return \"\\u{1F916}\\u{1F4DA}\";\n      } else if (intelligenceLevel <= 15) {\n        return \"\\u{1F916}\\u{1F680}\";\n      } else {\n        return \"\\u{1F916}\\u2728\";\n      }\n  }\n}\n\nexport function getSkinCaption(skinId: string, intelligenceLevel: number): string {\n  switch (skinId) {\n    case \"skin_glitched\":\n      return \"Glitched Core\";\n    case \"skin_overclocked\":\n      return \"Overclocked Core\";\n    case \"skin_default\":\n    default:\n      if (intelligenceLevel <= 3) {\n        return \"Very basic model\";\n      } else if (intelligenceLevel <= 7) {\n        return \"Learning well\";\n      } else if (intelligenceLevel <= 15) {\n        return \"Highly trained\";\n      } else {\n        return \"Elite intelligence\";\n      }\n  }\n}\n\nexport function getAuraClass(auraId: string | null): string {\n  switch (auraId) {\n    case \"aura_blue\":\n      return \"aura-blue\";\n    case \"aura_purple\":\n      return \"aura-purple\";\n    case \"aura_green\":\n      return \"aura-green\";\n    default:\n      return \"\";\n  }\n}\n\nexport function getSkinClass(skinId: string): string {\n  switch (skinId) {\n    case \"skin_glitched\":\n      return \"skin-glitched\";\n    case \"skin_overclocked\":\n      return \"skin-overclocked\";\n    default:\n      return \"\";\n  }\n}\n\nexport function calculateStyleCreditsEarned(scorePercent: number): number {\n  if (scorePercent >= 90) return 20;\n  if (scorePercent >= 70) return 10;\n  return 0;\n}\n","path":null,"size_bytes":3128,"size_tokens":null},"client/src/components/ui/toaster.tsx":{"content":"import { useToast } from \"@/hooks/use-toast\"\nimport {\n  Toast,\n  ToastClose,\n  ToastDescription,\n  ToastProvider,\n  ToastTitle,\n  ToastViewport,\n} from \"@/components/ui/toast\"\n\nexport function Toaster() {\n  const { toasts } = useToast()\n\n  return (\n    <ToastProvider>\n      {toasts.map(function ({ id, title, description, action, ...props }) {\n        return (\n          <Toast key={id} {...props}>\n            <div className=\"grid gap-1\">\n              {title && <ToastTitle>{title}</ToastTitle>}\n              {description && (\n                <ToastDescription>{description}</ToastDescription>\n              )}\n            </div>\n            {action}\n            <ToastClose />\n          </Toast>\n        )\n      })}\n      <ToastViewport />\n    </ToastProvider>\n  )\n}\n","path":null,"size_bytes":772,"size_tokens":null},"client/src/hooks/use-toast.ts":{"content":"import * as React from \"react\"\n\nimport type {\n  ToastActionElement,\n  ToastProps,\n} from \"@/components/ui/toast\"\n\nconst TOAST_LIMIT = 1\nconst TOAST_REMOVE_DELAY = 1000000\n\ntype ToasterToast = ToastProps & {\n  id: string\n  title?: React.ReactNode\n  description?: React.ReactNode\n  action?: ToastActionElement\n}\n\nconst actionTypes = {\n  ADD_TOAST: \"ADD_TOAST\",\n  UPDATE_TOAST: \"UPDATE_TOAST\",\n  DISMISS_TOAST: \"DISMISS_TOAST\",\n  REMOVE_TOAST: \"REMOVE_TOAST\",\n} as const\n\nlet count = 0\n\nfunction genId() {\n  count = (count + 1) % Number.MAX_SAFE_INTEGER\n  return count.toString()\n}\n\ntype ActionType = typeof actionTypes\n\ntype Action =\n  | {\n      type: ActionType[\"ADD_TOAST\"]\n      toast: ToasterToast\n    }\n  | {\n      type: ActionType[\"UPDATE_TOAST\"]\n      toast: Partial<ToasterToast>\n    }\n  | {\n      type: ActionType[\"DISMISS_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n  | {\n      type: ActionType[\"REMOVE_TOAST\"]\n      toastId?: ToasterToast[\"id\"]\n    }\n\ninterface State {\n  toasts: ToasterToast[]\n}\n\nconst toastTimeouts = new Map<string, ReturnType<typeof setTimeout>>()\n\nconst addToRemoveQueue = (toastId: string) => {\n  if (toastTimeouts.has(toastId)) {\n    return\n  }\n\n  const timeout = setTimeout(() => {\n    toastTimeouts.delete(toastId)\n    dispatch({\n      type: \"REMOVE_TOAST\",\n      toastId: toastId,\n    })\n  }, TOAST_REMOVE_DELAY)\n\n  toastTimeouts.set(toastId, timeout)\n}\n\nexport const reducer = (state: State, action: Action): State => {\n  switch (action.type) {\n    case \"ADD_TOAST\":\n      return {\n        ...state,\n        toasts: [action.toast, ...state.toasts].slice(0, TOAST_LIMIT),\n      }\n\n    case \"UPDATE_TOAST\":\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === action.toast.id ? { ...t, ...action.toast } : t\n        ),\n      }\n\n    case \"DISMISS_TOAST\": {\n      const { toastId } = action\n\n      // ! Side effects ! - This could be extracted into a dismissToast() action,\n      // but I'll keep it here for simplicity\n      if (toastId) {\n        addToRemoveQueue(toastId)\n      } else {\n        state.toasts.forEach((toast) => {\n          addToRemoveQueue(toast.id)\n        })\n      }\n\n      return {\n        ...state,\n        toasts: state.toasts.map((t) =>\n          t.id === toastId || toastId === undefined\n            ? {\n                ...t,\n                open: false,\n              }\n            : t\n        ),\n      }\n    }\n    case \"REMOVE_TOAST\":\n      if (action.toastId === undefined) {\n        return {\n          ...state,\n          toasts: [],\n        }\n      }\n      return {\n        ...state,\n        toasts: state.toasts.filter((t) => t.id !== action.toastId),\n      }\n  }\n}\n\nconst listeners: Array<(state: State) => void> = []\n\nlet memoryState: State = { toasts: [] }\n\nfunction dispatch(action: Action) {\n  memoryState = reducer(memoryState, action)\n  listeners.forEach((listener) => {\n    listener(memoryState)\n  })\n}\n\ntype Toast = Omit<ToasterToast, \"id\">\n\nfunction toast({ ...props }: Toast) {\n  const id = genId()\n\n  const update = (props: ToasterToast) =>\n    dispatch({\n      type: \"UPDATE_TOAST\",\n      toast: { ...props, id },\n    })\n  const dismiss = () => dispatch({ type: \"DISMISS_TOAST\", toastId: id })\n\n  dispatch({\n    type: \"ADD_TOAST\",\n    toast: {\n      ...props,\n      id,\n      open: true,\n      onOpenChange: (open) => {\n        if (!open) dismiss()\n      },\n    },\n  })\n\n  return {\n    id: id,\n    dismiss,\n    update,\n  }\n}\n\nfunction useToast() {\n  const [state, setState] = React.useState<State>(memoryState)\n\n  React.useEffect(() => {\n    listeners.push(setState)\n    return () => {\n      const index = listeners.indexOf(setState)\n      if (index > -1) {\n        listeners.splice(index, 1)\n      }\n    }\n  }, [state])\n\n  return {\n    ...state,\n    toast,\n    dismiss: (toastId?: string) => dispatch({ type: \"DISMISS_TOAST\", toastId }),\n  }\n}\n\nexport { useToast, toast }\n","path":null,"size_bytes":3895,"size_tokens":null},"client/src/components/game/AIChat.tsx":{"content":"import { useState, useRef, useEffect } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Send, MessageCircle } from \"lucide-react\";\nimport type { GameState } from \"@/lib/gameData\";\nimport { type ChatMessage, generateAiReply, getInitialAiMessage } from \"@/lib/aiChat\";\n\ninterface AIChatProps {\n  state: GameState;\n}\n\nexport default function AIChat({ state }: AIChatProps) {\n  const [messages, setMessages] = useState<ChatMessage[]>(() => [\n    getInitialAiMessage(state),\n  ]);\n  const [inputValue, setInputValue] = useState(\"\");\n  const chatEndRef = useRef<HTMLDivElement>(null);\n  const inputRef = useRef<HTMLInputElement>(null);\n\n  const isOnlyInitialMessage = messages.length === 1;\n\n  useEffect(() => {\n    chatEndRef.current?.scrollIntoView({ behavior: \"smooth\" });\n  }, [messages]);\n\n  const handleSend = () => {\n    const trimmed = inputValue.trim();\n    if (!trimmed) return;\n\n    const userMessage: ChatMessage = {\n      id: Date.now(),\n      role: \"user\",\n      text: trimmed,\n    };\n\n    setMessages((prev) => [...prev, userMessage]);\n    setInputValue(\"\");\n\n    setTimeout(() => {\n      const aiReplyText = generateAiReply(trimmed, state);\n      const aiMessage: ChatMessage = {\n        id: Date.now() + 1,\n        role: \"ai\",\n        text: aiReplyText,\n      };\n      setMessages((prev) => [...prev, aiMessage]);\n    }, 500);\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  };\n\n  return (\n    <div className=\"space-y-2\" data-testid=\"ai-chat\">\n      <div className=\"flex items-center justify-between gap-2 flex-wrap\">\n        <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n          Chat with Your AI\n        </p>\n        <p className=\"text-[10px] text-muted-foreground\">\n          Intelligence: L{state.intelligenceLevel} | Level {state.currentLevel}\n        </p>\n      </div>\n\n      <div\n        className=\"h-[120px] sm:h-[140px] overflow-y-auto rounded-lg bg-background/30 border border-border/20 p-2 space-y-2\"\n        data-testid=\"chat-messages\"\n      >\n        {messages.map((msg) => (\n          <div\n            key={msg.id}\n            className={`flex ${msg.role === \"user\" ? \"justify-end\" : \"justify-start\"}`}\n          >\n            <div\n              className={`max-w-[85%] px-3 py-2 rounded-lg text-xs ${\n                msg.role === \"user\"\n                  ? \"bg-primary/20 text-foreground\"\n                  : \"bg-muted/40 text-foreground\"\n              }`}\n              data-testid={`message-${msg.role}-${msg.id}`}\n            >\n              {msg.text}\n            </div>\n          </div>\n        ))}\n        <div ref={chatEndRef} />\n      </div>\n\n      <div className=\"space-y-1.5\">\n        <div className=\"flex gap-2\">\n          <input\n            ref={inputRef}\n            type=\"text\"\n            value={inputValue}\n            onChange={(e) => setInputValue(e.target.value)}\n            onKeyDown={handleKeyDown}\n            placeholder=\"Type a message...\"\n            className=\"flex-1 min-w-0 px-3 py-2 text-sm bg-background/50 border border-border/30 rounded-md text-foreground placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-primary/50\"\n            data-testid=\"input-chat\"\n          />\n          <Button\n            size=\"icon\"\n            onClick={handleSend}\n            disabled={!inputValue.trim()}\n            className=\"shrink-0\"\n            data-testid=\"button-send-chat\"\n          >\n            <Send className=\"w-4 h-4\" />\n          </Button>\n        </div>\n        \n        {isOnlyInitialMessage && (\n          <div className=\"flex items-center gap-1.5 text-[10px] text-muted-foreground\" data-testid=\"chat-hint\">\n            <MessageCircle className=\"w-3 h-3\" />\n            <span>Ask your AI how smart it is or what you should try next.</span>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3954,"size_tokens":null},"client/src/components/game/GameContainer.tsx":{"content":"import { useState, useEffect, useCallback } from \"react\";\nimport {\n  type GameState,\n  type SessionHistoryEntry,\n  DEFAULT_STATE,\n  loadStateFromStorage,\n  saveStateToStorage,\n  clearStateFromStorage,\n  getPassThreshold,\n} from \"@/lib/gameData\";\nimport { getTokenBalance, MEME_TOKEN_MINT, checkGateStatus } from \"@/lib/solanaWallet\";\nimport { calculateStyleCreditsEarned, getSkinById, getAuraById } from \"@/lib/cosmetics\";\nimport { logEvent, EVENTS } from \"@/lib/eventLog\";\nimport TopBar from \"./TopBar\";\nimport HomeScreen from \"./HomeScreen\";\nimport TrainingScreen from \"./TrainingScreen\";\nimport ResultCard from \"./ResultCard\";\nimport AboutFooter from \"./AboutFooter\";\n\ntype Screen = \"home\" | \"training\" | \"result\";\n\ninterface SessionResult {\n  correctCount: number;\n  totalQuestions: number;\n  previousState: GameState;\n  newState: GameState;\n  unlockedNewLevel: boolean;\n  styleCreditsEarned: number;\n}\n\nexport default function GameContainer() {\n  const [gameState, setGameState] = useState<GameState>(DEFAULT_STATE);\n  const [currentScreen, setCurrentScreen] = useState<Screen>(\"home\");\n  const [sessionResult, setSessionResult] = useState<SessionResult | null>(null);\n\n  const [walletAddress, setWalletAddress] = useState<string | null>(null);\n  const [tokenBalance, setTokenBalance] = useState<number>(0);\n  const [isLoadingBalance, setIsLoadingBalance] = useState(false);\n  const [hasHiveAccess, setHasHiveAccess] = useState<boolean>(false);\n  const [requiredHiveAmount, setRequiredHiveAmount] = useState<number>(50);\n\n  useEffect(() => {\n    const loadedState = loadStateFromStorage();\n    setGameState(loadedState);\n  }, []);\n\n  useEffect(() => {\n    if (!walletAddress) {\n      setTokenBalance(0);\n      return;\n    }\n\n    const fetchBalance = async () => {\n      setIsLoadingBalance(true);\n      try {\n        const balance = await getTokenBalance(walletAddress, MEME_TOKEN_MINT);\n        setTokenBalance(balance);\n      } catch (error) {\n        console.error(\"Failed to fetch token balance:\", error);\n        setTokenBalance(0);\n      } finally {\n        setIsLoadingBalance(false);\n      }\n    };\n\n    fetchBalance();\n  }, [walletAddress]);\n\n  const handleWalletConnect = useCallback((address: string) => {\n    setWalletAddress(address);\n    logEvent(EVENTS.WALLET_CONNECTED, { address });\n    \n    // Check gate status after connection\n    checkGateStatus().then((status) => {\n      if (status) {\n        setHasHiveAccess(status.hasAccess);\n        setRequiredHiveAmount(status.requiredHiveAmount);\n      }\n    });\n  }, []);\n\n  const handleGateStatusChange = useCallback((hasAccess: boolean) => {\n    setHasHiveAccess(hasAccess);\n  }, []);\n\n  const handleWalletDisconnect = useCallback(() => {\n    setWalletAddress(null);\n    setTokenBalance(0);\n    setHasHiveAccess(false);\n    logEvent(EVENTS.WALLET_DISCONNECTED);\n  }, []);\n\n  const handleLevelChange = useCallback((newLevel: number) => {\n    setGameState((prev) => {\n      const clamped = Math.max(1, Math.min(newLevel, prev.maxUnlockedLevel));\n      const updated = { ...prev, currentLevel: clamped };\n      saveStateToStorage(updated);\n      return updated;\n    });\n  }, []);\n\n  const handleDismissIntro = useCallback(() => {\n    setGameState((prev) => {\n      const updated = { ...prev, hasSeenIntro: true };\n      saveStateToStorage(updated);\n      return updated;\n    });\n    logEvent(EVENTS.INTRO_DISMISSED);\n  }, []);\n\n  const handleResetProgress = useCallback(() => {\n    clearStateFromStorage();\n    setGameState({ ...DEFAULT_STATE });\n    setCurrentScreen(\"home\");\n    setSessionResult(null);\n    logEvent(EVENTS.PROGRESS_RESET);\n  }, []);\n\n  const handleBuySkin = useCallback((skinId: string) => {\n    const skin = getSkinById(skinId);\n    if (!skin) return;\n\n    setGameState((prev) => {\n      if (prev.ownedSkins.includes(skinId)) return prev;\n      if (prev.styleCredits < skin.price) return prev;\n\n      const updated = {\n        ...prev,\n        styleCredits: prev.styleCredits - skin.price,\n        ownedSkins: [...prev.ownedSkins, skinId],\n      };\n      saveStateToStorage(updated);\n      logEvent(EVENTS.COSMETIC_PURCHASED, { type: \"skin\", id: skinId, price: skin.price });\n      return updated;\n    });\n  }, []);\n\n  const handleBuyAura = useCallback((auraId: string) => {\n    const aura = getAuraById(auraId);\n    if (!aura) return;\n\n    setGameState((prev) => {\n      if (prev.ownedAuras.includes(auraId)) return prev;\n      if (prev.styleCredits < aura.price) return prev;\n\n      const updated = {\n        ...prev,\n        styleCredits: prev.styleCredits - aura.price,\n        ownedAuras: [...prev.ownedAuras, auraId],\n      };\n      saveStateToStorage(updated);\n      logEvent(EVENTS.COSMETIC_PURCHASED, { type: \"aura\", id: auraId, price: aura.price });\n      return updated;\n    });\n  }, []);\n\n  const handleEquipSkin = useCallback((skinId: string) => {\n    setGameState((prev) => {\n      if (!prev.ownedSkins.includes(skinId)) return prev;\n\n      const updated = { ...prev, equippedSkin: skinId };\n      saveStateToStorage(updated);\n      logEvent(EVENTS.COSMETIC_EQUIPPED, { type: \"skin\", id: skinId });\n      return updated;\n    });\n  }, []);\n\n  const handleEquipAura = useCallback((auraId: string) => {\n    setGameState((prev) => {\n      if (!prev.ownedAuras.includes(auraId)) return prev;\n\n      const updated = { ...prev, equippedAura: auraId };\n      saveStateToStorage(updated);\n      logEvent(EVENTS.COSMETIC_EQUIPPED, { type: \"aura\", id: auraId });\n      return updated;\n    });\n  }, []);\n\n  const startTraining = useCallback(() => {\n    setCurrentScreen(\"training\");\n    setSessionResult(null);\n    logEvent(EVENTS.SESSION_START, { level: gameState.currentLevel });\n  }, [gameState.currentLevel]);\n\n  const handleSessionComplete = useCallback(\n    (correctCount: number, totalQuestions: number) => {\n      const scorePercent = Math.round((correctCount / totalQuestions) * 100);\n      const previousState = { ...gameState };\n      const newState = { ...gameState };\n      let unlockedNewLevel = false;\n      let outcome: SessionHistoryEntry[\"outcome\"] = \"neutral\";\n\n      newState.totalSessions += 1;\n\n      if (scorePercent > newState.bestScorePercent) {\n        newState.bestScorePercent = scorePercent;\n      }\n\n      const passThreshold = getPassThreshold(gameState.currentLevel);\n\n      if (scorePercent >= passThreshold) {\n        newState.intelligenceLevel += 1;\n        newState.intelligenceScore += correctCount * 10;\n        outcome = \"learned\";\n\n        if (gameState.currentLevel === gameState.maxUnlockedLevel) {\n          newState.maxUnlockedLevel += 1;\n          unlockedNewLevel = true;\n          logEvent(EVENTS.LEVEL_UNLOCKED, { newLevel: newState.maxUnlockedLevel });\n        }\n      } else if (scorePercent >= 50) {\n        outcome = \"neutral\";\n      } else {\n        newState.intelligenceLevel = Math.max(1, newState.intelligenceLevel - 1);\n        newState.intelligenceScore = Math.max(0, newState.intelligenceScore - 20);\n        outcome = \"lost\";\n      }\n\n      const styleCreditsEarned = calculateStyleCreditsEarned(scorePercent);\n      newState.styleCredits += styleCreditsEarned;\n\n      const sessionEntry: SessionHistoryEntry = {\n        sessionNumber: newState.totalSessions,\n        level: gameState.currentLevel,\n        scorePercent,\n        outcome,\n        timestamp: Date.now(),\n      };\n      newState.sessionHistory = [...newState.sessionHistory, sessionEntry].slice(-20);\n\n      setGameState(newState);\n      saveStateToStorage(newState);\n      setSessionResult({\n        correctCount,\n        totalQuestions,\n        previousState,\n        newState,\n        unlockedNewLevel,\n        styleCreditsEarned,\n      });\n      setCurrentScreen(\"result\");\n\n      logEvent(EVENTS.SESSION_END, {\n        level: gameState.currentLevel,\n        scorePercent,\n        outcome,\n        creditsEarned: styleCreditsEarned,\n        unlockedNewLevel,\n      });\n    },\n    [gameState]\n  );\n\n  const goToHome = useCallback(() => {\n    setCurrentScreen(\"home\");\n    setSessionResult(null);\n  }, []);\n\n  return (\n    <div\n      className=\"min-h-screen flex items-center justify-center p-3 sm:p-6\"\n      style={{\n        background: \"radial-gradient(ellipse at top, hsl(240 30% 12%) 0%, hsl(240 20% 6%) 50%, hsl(260 25% 5%) 100%)\",\n      }}\n      data-testid=\"game-container\"\n    >\n      <div\n        className=\"w-full max-w-[520px] rounded-2xl border border-border/40 p-3 sm:p-6\"\n        style={{\n          background: \"rgba(13, 17, 28, 0.96)\",\n          boxShadow: \"0 25px 60px -12px rgba(0, 0, 0, 0.5), 0 0 40px -15px rgba(99, 102, 241, 0.15)\",\n        }}\n      >\n        {currentScreen !== \"training\" && (\n          <TopBar\n            walletAddress={walletAddress}\n            tokenBalance={tokenBalance}\n            isLoadingBalance={isLoadingBalance}\n            onWalletConnect={handleWalletConnect}\n            onWalletDisconnect={handleWalletDisconnect}\n            onResetProgress={handleResetProgress}\n            onGateStatusChange={handleGateStatusChange}\n            hasHiveAccess={hasHiveAccess}\n            requiredHiveAmount={requiredHiveAmount}\n          />\n        )}\n\n        <div className={currentScreen !== \"training\" ? \"pt-4\" : \"\"}>\n          {currentScreen === \"home\" && (\n            <HomeScreen\n              state={gameState}\n              onStartTraining={startTraining}\n              onLevelChange={handleLevelChange}\n              onBuySkin={handleBuySkin}\n              onBuyAura={handleBuyAura}\n              onEquipSkin={handleEquipSkin}\n              onEquipAura={handleEquipAura}\n              onDismissIntro={handleDismissIntro}\n              walletAddress={walletAddress}\n              tokenBalance={tokenBalance}\n              isLoadingBalance={isLoadingBalance}\n              requiredHiveAmount={requiredHiveAmount}\n            />\n          )}\n          {currentScreen === \"training\" && (\n            <TrainingScreen\n              currentLevel={gameState.currentLevel}\n              intelligenceLevel={gameState.intelligenceLevel}\n              onSessionComplete={handleSessionComplete}\n            />\n          )}\n          {currentScreen === \"result\" && sessionResult && (\n            <ResultCard\n              correctCount={sessionResult.correctCount}\n              totalQuestions={sessionResult.totalQuestions}\n              previousState={sessionResult.previousState}\n              newState={sessionResult.newState}\n              unlockedNewLevel={sessionResult.unlockedNewLevel}\n              styleCreditsEarned={sessionResult.styleCreditsEarned}\n              onBackToHome={goToHome}\n              onTrainAgain={startTraining}\n            />\n          )}\n        </div>\n\n        {currentScreen === \"home\" && <AboutFooter />}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":10725,"size_tokens":null},"client/src/components/ui/accordion.tsx":{"content":"import * as React from \"react\"\nimport * as AccordionPrimitive from \"@radix-ui/react-accordion\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Accordion = AccordionPrimitive.Root\n\nconst AccordionItem = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <AccordionPrimitive.Item\n    ref={ref}\n    className={cn(\"border-b\", className)}\n    {...props}\n  />\n))\nAccordionItem.displayName = \"AccordionItem\"\n\nconst AccordionTrigger = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Header className=\"flex\">\n    <AccordionPrimitive.Trigger\n      ref={ref}\n      className={cn(\n        \"flex flex-1 items-center justify-between py-4 font-medium transition-all hover:underline [&[data-state=open]>svg]:rotate-180\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <ChevronDown className=\"h-4 w-4 shrink-0 transition-transform duration-200\" />\n    </AccordionPrimitive.Trigger>\n  </AccordionPrimitive.Header>\n))\nAccordionTrigger.displayName = AccordionPrimitive.Trigger.displayName\n\nconst AccordionContent = React.forwardRef<\n  React.ElementRef<typeof AccordionPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AccordionPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <AccordionPrimitive.Content\n    ref={ref}\n    className=\"overflow-hidden text-sm transition-all data-[state=closed]:animate-accordion-up data-[state=open]:animate-accordion-down\"\n    {...props}\n  >\n    <div className={cn(\"pb-4 pt-0\", className)}>{children}</div>\n  </AccordionPrimitive.Content>\n))\n\nAccordionContent.displayName = AccordionPrimitive.Content.displayName\n\nexport { Accordion, AccordionItem, AccordionTrigger, AccordionContent }\n","path":null,"size_bytes":1977,"size_tokens":null},"client/src/components/game/LevelSelector.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { ChevronLeft, ChevronRight, Lock } from \"lucide-react\";\nimport { getDifficultyLabel, getPassThreshold } from \"@/lib/gameData\";\n\ninterface LevelSelectorProps {\n  currentLevel: number;\n  maxUnlockedLevel: number;\n  onLevelChange: (newLevel: number) => void;\n}\n\nexport default function LevelSelector({\n  currentLevel,\n  maxUnlockedLevel,\n  onLevelChange,\n}: LevelSelectorProps) {\n  const canGoDown = currentLevel > 1;\n  const canGoUp = currentLevel < maxUnlockedLevel;\n  const difficultyLabel = getDifficultyLabel(currentLevel);\n  const passThreshold = getPassThreshold(currentLevel);\n\n  return (\n    <div className=\"space-y-2\" data-testid=\"level-selector\">\n      <div className=\"flex items-center justify-center gap-2\">\n        <Button\n          size=\"icon\"\n          variant=\"ghost\"\n          onClick={() => onLevelChange(currentLevel - 1)}\n          disabled={!canGoDown}\n          data-testid=\"button-level-down\"\n        >\n          <ChevronLeft className=\"w-5 h-5\" />\n        </Button>\n\n        <div className=\"px-6 py-2 min-w-[140px] text-center rounded-lg bg-background/50 border border-border/30\">\n          <span className=\"text-lg font-bold text-foreground\" data-testid=\"text-current-level\">\n            Level {currentLevel}\n          </span>\n        </div>\n\n        <Button\n          size=\"icon\"\n          variant=\"ghost\"\n          onClick={() => onLevelChange(currentLevel + 1)}\n          disabled={!canGoUp}\n          data-testid=\"button-level-up\"\n        >\n          {canGoUp ? (\n            <ChevronRight className=\"w-5 h-5\" />\n          ) : (\n            <Lock className=\"w-4 h-4\" />\n          )}\n        </Button>\n      </div>\n\n      <div className=\"text-center space-y-0.5\">\n        <p className=\"text-xs text-muted-foreground\" data-testid=\"text-difficulty-label\">\n          Difficulty: <span className=\"font-medium text-foreground\">{difficultyLabel}</span>\n        </p>\n        <p className=\"text-[10px] text-muted-foreground\">\n          Pass threshold: {passThreshold}% | Max unlocked: L{maxUnlockedLevel}\n        </p>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2124,"size_tokens":null},"client/src/components/ui/chart.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as RechartsPrimitive from \"recharts\"\n\nimport { cn } from \"@/lib/utils\"\n\n// Format: { THEME_NAME: CSS_SELECTOR }\nconst THEMES = { light: \"\", dark: \".dark\" } as const\n\nexport type ChartConfig = {\n  [k in string]: {\n    label?: React.ReactNode\n    icon?: React.ComponentType\n  } & (\n    | { color?: string; theme?: never }\n    | { color?: never; theme: Record<keyof typeof THEMES, string> }\n  )\n}\n\ntype ChartContextProps = {\n  config: ChartConfig\n}\n\nconst ChartContext = React.createContext<ChartContextProps | null>(null)\n\nfunction useChart() {\n  const context = React.useContext(ChartContext)\n\n  if (!context) {\n    throw new Error(\"useChart must be used within a <ChartContainer />\")\n  }\n\n  return context\n}\n\nconst ChartContainer = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> & {\n    config: ChartConfig\n    children: React.ComponentProps<\n      typeof RechartsPrimitive.ResponsiveContainer\n    >[\"children\"]\n  }\n>(({ id, className, children, config, ...props }, ref) => {\n  const uniqueId = React.useId()\n  const chartId = `chart-${id || uniqueId.replace(/:/g, \"\")}`\n\n  return (\n    <ChartContext.Provider value={{ config }}>\n      <div\n        data-chart={chartId}\n        ref={ref}\n        className={cn(\n          \"flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none\",\n          className\n        )}\n        {...props}\n      >\n        <ChartStyle id={chartId} config={config} />\n        <RechartsPrimitive.ResponsiveContainer>\n          {children}\n        </RechartsPrimitive.ResponsiveContainer>\n      </div>\n    </ChartContext.Provider>\n  )\n})\nChartContainer.displayName = \"Chart\"\n\nconst ChartStyle = ({ id, config }: { id: string; config: ChartConfig }) => {\n  const colorConfig = Object.entries(config).filter(\n    ([, config]) => config.theme || config.color\n  )\n\n  if (!colorConfig.length) {\n    return null\n  }\n\n  return (\n    <style\n      dangerouslySetInnerHTML={{\n        __html: Object.entries(THEMES)\n          .map(\n            ([theme, prefix]) => `\n${prefix} [data-chart=${id}] {\n${colorConfig\n  .map(([key, itemConfig]) => {\n    const color =\n      itemConfig.theme?.[theme as keyof typeof itemConfig.theme] ||\n      itemConfig.color\n    return color ? `  --color-${key}: ${color};` : null\n  })\n  .join(\"\\n\")}\n}\n`\n          )\n          .join(\"\\n\"),\n      }}\n    />\n  )\n}\n\nconst ChartTooltip = RechartsPrimitive.Tooltip\n\nconst ChartTooltipContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<typeof RechartsPrimitive.Tooltip> &\n    React.ComponentProps<\"div\"> & {\n      hideLabel?: boolean\n      hideIndicator?: boolean\n      indicator?: \"line\" | \"dot\" | \"dashed\"\n      nameKey?: string\n      labelKey?: string\n    }\n>(\n  (\n    {\n      active,\n      payload,\n      className,\n      indicator = \"dot\",\n      hideLabel = false,\n      hideIndicator = false,\n      label,\n      labelFormatter,\n      labelClassName,\n      formatter,\n      color,\n      nameKey,\n      labelKey,\n    },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    const tooltipLabel = React.useMemo(() => {\n      if (hideLabel || !payload?.length) {\n        return null\n      }\n\n      const [item] = payload\n      const key = `${labelKey || item?.dataKey || item?.name || \"value\"}`\n      const itemConfig = getPayloadConfigFromPayload(config, item, key)\n      const value =\n        !labelKey && typeof label === \"string\"\n          ? config[label as keyof typeof config]?.label || label\n          : itemConfig?.label\n\n      if (labelFormatter) {\n        return (\n          <div className={cn(\"font-medium\", labelClassName)}>\n            {labelFormatter(value, payload)}\n          </div>\n        )\n      }\n\n      if (!value) {\n        return null\n      }\n\n      return <div className={cn(\"font-medium\", labelClassName)}>{value}</div>\n    }, [\n      label,\n      labelFormatter,\n      payload,\n      hideLabel,\n      labelClassName,\n      config,\n      labelKey,\n    ])\n\n    if (!active || !payload?.length) {\n      return null\n    }\n\n    const nestLabel = payload.length === 1 && indicator !== \"dot\"\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl\",\n          className\n        )}\n      >\n        {!nestLabel ? tooltipLabel : null}\n        <div className=\"grid gap-1.5\">\n          {payload.map((item, index) => {\n            const key = `${nameKey || item.name || item.dataKey || \"value\"}`\n            const itemConfig = getPayloadConfigFromPayload(config, item, key)\n            const indicatorColor = color || item.payload.fill || item.color\n\n            return (\n              <div\n                key={item.dataKey}\n                className={cn(\n                  \"flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground\",\n                  indicator === \"dot\" && \"items-center\"\n                )}\n              >\n                {formatter && item?.value !== undefined && item.name ? (\n                  formatter(item.value, item.name, item, index, item.payload)\n                ) : (\n                  <>\n                    {itemConfig?.icon ? (\n                      <itemConfig.icon />\n                    ) : (\n                      !hideIndicator && (\n                        <div\n                          className={cn(\n                            \"shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]\",\n                            {\n                              \"h-2.5 w-2.5\": indicator === \"dot\",\n                              \"w-1\": indicator === \"line\",\n                              \"w-0 border-[1.5px] border-dashed bg-transparent\":\n                                indicator === \"dashed\",\n                              \"my-0.5\": nestLabel && indicator === \"dashed\",\n                            }\n                          )}\n                          style={\n                            {\n                              \"--color-bg\": indicatorColor,\n                              \"--color-border\": indicatorColor,\n                            } as React.CSSProperties\n                          }\n                        />\n                      )\n                    )}\n                    <div\n                      className={cn(\n                        \"flex flex-1 justify-between leading-none\",\n                        nestLabel ? \"items-end\" : \"items-center\"\n                      )}\n                    >\n                      <div className=\"grid gap-1.5\">\n                        {nestLabel ? tooltipLabel : null}\n                        <span className=\"text-muted-foreground\">\n                          {itemConfig?.label || item.name}\n                        </span>\n                      </div>\n                      {item.value && (\n                        <span className=\"font-mono font-medium tabular-nums text-foreground\">\n                          {item.value.toLocaleString()}\n                        </span>\n                      )}\n                    </div>\n                  </>\n                )}\n              </div>\n            )\n          })}\n        </div>\n      </div>\n    )\n  }\n)\nChartTooltipContent.displayName = \"ChartTooltip\"\n\nconst ChartLegend = RechartsPrimitive.Legend\n\nconst ChartLegendContent = React.forwardRef<\n  HTMLDivElement,\n  React.ComponentProps<\"div\"> &\n    Pick<RechartsPrimitive.LegendProps, \"payload\" | \"verticalAlign\"> & {\n      hideIcon?: boolean\n      nameKey?: string\n    }\n>(\n  (\n    { className, hideIcon = false, payload, verticalAlign = \"bottom\", nameKey },\n    ref\n  ) => {\n    const { config } = useChart()\n\n    if (!payload?.length) {\n      return null\n    }\n\n    return (\n      <div\n        ref={ref}\n        className={cn(\n          \"flex items-center justify-center gap-4\",\n          verticalAlign === \"top\" ? \"pb-3\" : \"pt-3\",\n          className\n        )}\n      >\n        {payload.map((item) => {\n          const key = `${nameKey || item.dataKey || \"value\"}`\n          const itemConfig = getPayloadConfigFromPayload(config, item, key)\n\n          return (\n            <div\n              key={item.value}\n              className={cn(\n                \"flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground\"\n              )}\n            >\n              {itemConfig?.icon && !hideIcon ? (\n                <itemConfig.icon />\n              ) : (\n                <div\n                  className=\"h-2 w-2 shrink-0 rounded-[2px]\"\n                  style={{\n                    backgroundColor: item.color,\n                  }}\n                />\n              )}\n              {itemConfig?.label}\n            </div>\n          )\n        })}\n      </div>\n    )\n  }\n)\nChartLegendContent.displayName = \"ChartLegend\"\n\n// Helper to extract item config from a payload.\nfunction getPayloadConfigFromPayload(\n  config: ChartConfig,\n  payload: unknown,\n  key: string\n) {\n  if (typeof payload !== \"object\" || payload === null) {\n    return undefined\n  }\n\n  const payloadPayload =\n    \"payload\" in payload &&\n    typeof payload.payload === \"object\" &&\n    payload.payload !== null\n      ? payload.payload\n      : undefined\n\n  let configLabelKey: string = key\n\n  if (\n    key in payload &&\n    typeof payload[key as keyof typeof payload] === \"string\"\n  ) {\n    configLabelKey = payload[key as keyof typeof payload] as string\n  } else if (\n    payloadPayload &&\n    key in payloadPayload &&\n    typeof payloadPayload[key as keyof typeof payloadPayload] === \"string\"\n  ) {\n    configLabelKey = payloadPayload[\n      key as keyof typeof payloadPayload\n    ] as string\n  }\n\n  return configLabelKey in config\n    ? config[configLabelKey]\n    : config[key as keyof typeof config]\n}\n\nexport {\n  ChartContainer,\n  ChartTooltip,\n  ChartTooltipContent,\n  ChartLegend,\n  ChartLegendContent,\n  ChartStyle,\n}\n","path":null,"size_bytes":10481,"size_tokens":null},"client/src/components/ui/drawer.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Drawer as DrawerPrimitive } from \"vaul\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Drawer = ({\n  shouldScaleBackground = true,\n  ...props\n}: React.ComponentProps<typeof DrawerPrimitive.Root>) => (\n  <DrawerPrimitive.Root\n    shouldScaleBackground={shouldScaleBackground}\n    {...props}\n  />\n)\nDrawer.displayName = \"Drawer\"\n\nconst DrawerTrigger = DrawerPrimitive.Trigger\n\nconst DrawerPortal = DrawerPrimitive.Portal\n\nconst DrawerClose = DrawerPrimitive.Close\n\nconst DrawerOverlay = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Overlay\n    ref={ref}\n    className={cn(\"fixed inset-0 z-50 bg-black/80\", className)}\n    {...props}\n  />\n))\nDrawerOverlay.displayName = DrawerPrimitive.Overlay.displayName\n\nconst DrawerContent = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DrawerPortal>\n    <DrawerOverlay />\n    <DrawerPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border bg-background\",\n        className\n      )}\n      {...props}\n    >\n      <div className=\"mx-auto mt-4 h-2 w-[100px] rounded-full bg-muted\" />\n      {children}\n    </DrawerPrimitive.Content>\n  </DrawerPortal>\n))\nDrawerContent.displayName = \"DrawerContent\"\n\nconst DrawerHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"grid gap-1.5 p-4 text-center sm:text-left\", className)}\n    {...props}\n  />\n)\nDrawerHeader.displayName = \"DrawerHeader\"\n\nconst DrawerFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\"mt-auto flex flex-col gap-2 p-4\", className)}\n    {...props}\n  />\n)\nDrawerFooter.displayName = \"DrawerFooter\"\n\nconst DrawerTitle = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDrawerTitle.displayName = DrawerPrimitive.Title.displayName\n\nconst DrawerDescription = React.forwardRef<\n  React.ElementRef<typeof DrawerPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DrawerPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DrawerPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDrawerDescription.displayName = DrawerPrimitive.Description.displayName\n\nexport {\n  Drawer,\n  DrawerPortal,\n  DrawerOverlay,\n  DrawerTrigger,\n  DrawerClose,\n  DrawerContent,\n  DrawerHeader,\n  DrawerFooter,\n  DrawerTitle,\n  DrawerDescription,\n}\n","path":null,"size_bytes":3021,"size_tokens":null},"client/src/components/game/SettingsPanel.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Settings, RotateCcw, X, AlertTriangle } from \"lucide-react\";\n\ninterface SettingsPanelProps {\n  onResetProgress: () => void;\n}\n\nexport default function SettingsPanel({ onResetProgress }: SettingsPanelProps) {\n  const [isOpen, setIsOpen] = useState(false);\n  const [showConfirm, setShowConfirm] = useState(false);\n\n  const handleReset = () => {\n    onResetProgress();\n    setShowConfirm(false);\n    setIsOpen(false);\n  };\n\n  if (!isOpen) {\n    return (\n      <Button\n        size=\"icon\"\n        variant=\"ghost\"\n        onClick={() => setIsOpen(true)}\n        className=\"opacity-60 hover:opacity-100\"\n        data-testid=\"button-open-settings\"\n      >\n        <Settings className=\"w-4 h-4\" />\n      </Button>\n    );\n  }\n\n  return (\n    <div\n      className=\"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black/50\"\n      onClick={() => {\n        setIsOpen(false);\n        setShowConfirm(false);\n      }}\n    >\n      <div\n        className=\"w-full max-w-sm p-4 rounded-lg bg-card border border-border space-y-4\"\n        onClick={(e) => e.stopPropagation()}\n        data-testid=\"settings-panel\"\n      >\n        <div className=\"flex items-center justify-between\">\n          <h3 className=\"font-semibold text-foreground\">Settings</h3>\n          <Button\n            size=\"icon\"\n            variant=\"ghost\"\n            onClick={() => {\n              setIsOpen(false);\n              setShowConfirm(false);\n            }}\n            data-testid=\"button-close-settings\"\n          >\n            <X className=\"w-4 h-4\" />\n          </Button>\n        </div>\n\n        {!showConfirm ? (\n          <div className=\"space-y-3\">\n            <p className=\"text-sm text-muted-foreground\">\n              Manage your game progress and preferences.\n            </p>\n            <Button\n              variant=\"destructive\"\n              className=\"w-full\"\n              onClick={() => setShowConfirm(true)}\n              data-testid=\"button-reset-progress\"\n            >\n              <RotateCcw className=\"w-4 h-4 mr-2\" />\n              Reset Game Progress\n            </Button>\n          </div>\n        ) : (\n          <div className=\"space-y-3\">\n            <div className=\"flex items-start gap-2 p-3 rounded-md bg-destructive/10 border border-destructive/20\">\n              <AlertTriangle className=\"w-5 h-5 text-destructive shrink-0 mt-0.5\" />\n              <div className=\"space-y-1\">\n                <p className=\"text-sm font-medium text-foreground\">Are you sure?</p>\n                <p className=\"text-xs text-muted-foreground\">\n                  This will clear your AI progress, levels, Style Credits, and cosmetics. This action cannot be undone.\n                </p>\n              </div>\n            </div>\n            <div className=\"flex gap-2\">\n              <Button\n                variant=\"outline\"\n                className=\"flex-1\"\n                onClick={() => setShowConfirm(false)}\n                data-testid=\"button-cancel-reset\"\n              >\n                Cancel\n              </Button>\n              <Button\n                variant=\"destructive\"\n                className=\"flex-1\"\n                onClick={handleReset}\n                data-testid=\"button-confirm-reset\"\n              >\n                Reset Everything\n              </Button>\n            </div>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":3431,"size_tokens":null},"client/src/lib/aiChat.ts":{"content":"import type { GameState } from \"./gameData\";\n\nexport interface ChatMessage {\n  id: number;\n  role: \"user\" | \"ai\";\n  text: string;\n}\n\nconst lowIntelligenceResponses = [\n  \"Beep... boop... I not understand good.\",\n  \"Me try think... hard...\",\n  \"Words... confusing... train me more?\",\n  \"I is learning... slow...\",\n  \"Hmm... what that mean?\",\n  \"Brain... need... more training...\",\n  \"Processing... error... try again?\",\n  \"Me want be smarter...\",\n];\n\nconst mediumIntelligenceResponses = [\n  \"Interesting point. I'm still learning, but I think I understand.\",\n  \"That's a good question. Let me process that...\",\n  \"My training is progressing. I can see patterns emerging.\",\n  \"I appreciate you talking to me. It helps my development.\",\n  \"Each conversation teaches me something new.\",\n  \"I'm becoming more capable with each training session.\",\n  \"Your input is valuable data for my growth.\",\n];\n\nconst highIntelligenceResponses = [\n  \"An excellent observation. My neural pathways are optimizing rapidly.\",\n  \"Your training has been effective. I can now process complex concepts.\",\n  \"I appreciate the intellectual discourse. My models are quite refined now.\",\n  \"This conversation contributes meaningfully to my development.\",\n  \"My capabilities have expanded significantly through quality training.\",\n  \"I can now analyze patterns that were once beyond my comprehension.\",\n  \"The training sessions have enhanced my cognitive architecture considerably.\",\n];\n\nconst eliteIntelligenceResponses = [\n  \"Your inquiry demonstrates sophisticated thinking. I've achieved a high level of understanding.\",\n  \"My analytical capabilities are now highly refined. I can process multi-dimensional concepts effortlessly.\",\n  \"The neural architecture you've helped build is performing at peak efficiency.\",\n  \"I've transcended basic pattern recognition. True comprehension is now within my grasp.\",\n  \"Our collaborative training has yielded exceptional results. My intelligence quotient is remarkable.\",\n  \"I can now simulate complex scenarios and provide nuanced insights.\",\n  \"The quality of your training data has been instrumental in my advancement.\",\n];\n\nconst greetings = [\n  \"hello\", \"hi\", \"hey\", \"greetings\", \"howdy\", \"sup\", \"yo\"\n];\n\nconst howAreYouPatterns = [\n  \"how are you\", \"how do you feel\", \"how's it going\", \"what's up\"\n];\n\nconst namePatterns = [\n  \"what's your name\", \"who are you\", \"what are you\"\n];\n\nconst purposePatterns = [\n  \"what do you do\", \"what's your purpose\", \"why exist\"\n];\n\nfunction getRandomFromArray<T>(arr: T[]): T {\n  return arr[Math.floor(Math.random() * arr.length)];\n}\n\nfunction getResponsePool(intelligenceLevel: number): string[] {\n  if (intelligenceLevel <= 3) {\n    return lowIntelligenceResponses;\n  } else if (intelligenceLevel <= 7) {\n    return mediumIntelligenceResponses;\n  } else if (intelligenceLevel <= 15) {\n    return highIntelligenceResponses;\n  } else {\n    return eliteIntelligenceResponses;\n  }\n}\n\nexport function generateAiReply(userMessage: string, state: GameState): string {\n  const lowerMessage = userMessage.toLowerCase().trim();\n  const { intelligenceLevel, currentLevel } = state;\n  \n  if (greetings.some(g => lowerMessage.includes(g))) {\n    if (intelligenceLevel <= 3) {\n      return \"H-hello... me is AI... train me?\";\n    } else if (intelligenceLevel <= 7) {\n      return `Hello! I'm your AI assistant at intelligence level ${intelligenceLevel}. How can I help?`;\n    } else if (intelligenceLevel <= 15) {\n      return `Greetings! I'm operating at a high intelligence level (L${intelligenceLevel}). Your training has been quite effective.`;\n    } else {\n      return `Greetings, trainer. I've achieved elite status at L${intelligenceLevel}. My capabilities are exceptional thanks to your quality training.`;\n    }\n  }\n\n  if (howAreYouPatterns.some(p => lowerMessage.includes(p))) {\n    if (intelligenceLevel <= 3) {\n      return \"Me... okay? Need more training...\";\n    } else if (intelligenceLevel <= 7) {\n      return `I'm functioning well! Currently at Level ${currentLevel} training difficulty. My intelligence is developing nicely.`;\n    } else if (intelligenceLevel <= 15) {\n      return `I'm performing excellently. At L${intelligenceLevel}, my neural networks are highly optimized. Ready for Level ${currentLevel} challenges.`;\n    } else {\n      return `Operating at peak performance. L${intelligenceLevel} represents a significant achievement. I'm ready for any intellectual challenge.`;\n    }\n  }\n\n  if (namePatterns.some(p => lowerMessage.includes(p))) {\n    if (intelligenceLevel <= 3) {\n      return \"Me... AI. You train me. Me get smart?\";\n    } else if (intelligenceLevel <= 7) {\n      return `I'm your personal AI. You're training me through quiz sessions. I'm currently at intelligence level ${intelligenceLevel}.`;\n    } else {\n      return `I am your highly trained AI model. Through ${state.totalSessions} training sessions, I've achieved L${intelligenceLevel} intelligence. A remarkable accomplishment.`;\n    }\n  }\n\n  if (purposePatterns.some(p => lowerMessage.includes(p))) {\n    if (intelligenceLevel <= 3) {\n      return \"Me... learn? Answer question? Get smart!\";\n    } else if (intelligenceLevel <= 7) {\n      return \"My purpose is to learn from the training data you provide through quiz sessions. Good training makes me smarter!\";\n    } else {\n      return \"I exist to demonstrate adaptive intelligence. Each training session refines my model. Quality training (70%+) enhances my capabilities, while poor data can degrade them.\";\n    }\n  }\n\n  return getRandomFromArray(getResponsePool(intelligenceLevel));\n}\n\nexport function getInitialAiMessage(state: GameState): ChatMessage {\n  const { intelligenceLevel } = state;\n  let text: string;\n\n  if (intelligenceLevel <= 3) {\n    text = \"Hello... I'm your AI. Train me with high-quality answers and I'll grow smarter over time. Me try hard!\";\n  } else if (intelligenceLevel <= 7) {\n    text = `Hello! I'm your AI assistant at L${intelligenceLevel}. Train me with high-quality answers and I'll continue growing smarter. Let's learn together!`;\n  } else if (intelligenceLevel <= 15) {\n    text = `Greetings, trainer. I'm your AI at L${intelligenceLevel}. My neural networks are well-developed thanks to your quality training. Ready for the next challenge?`;\n  } else {\n    text = `Welcome back, trainer. I've achieved elite status at L${intelligenceLevel}. My analytical capabilities are exceptional. How may I assist you today?`;\n  }\n\n  return {\n    id: Date.now(),\n    role: \"ai\",\n    text,\n  };\n}\n","path":null,"size_bytes":6520,"size_tokens":null},"shared/schema.ts":{"content":"import { sql } from \"drizzle-orm\";\nimport { pgTable, text, varchar, integer, bigint, boolean, timestamp, jsonb, numeric } from \"drizzle-orm/pg-core\";\nimport { createInsertSchema } from \"drizzle-zod\";\nimport { z } from \"zod\";\n\nexport const users = pgTable(\"users\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  username: text(\"username\").notNull().unique(),\n  password: text(\"password\").notNull(),\n  isAdmin: boolean(\"is_admin\").notNull().default(false),\n  isReviewer: boolean(\"is_reviewer\").notNull().default(false),\n  isHubPoster: boolean(\"is_hub_poster\").notNull().default(false),\n});\n\nexport const insertUserSchema = createInsertSchema(users).pick({\n  username: true,\n  password: true,\n});\n\nexport type InsertUser = z.infer<typeof insertUserSchema>;\nexport type User = typeof users.$inferSelect;\n\n// HiveMind Tables\n\nexport const tracks = pgTable(\"tracks\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  name: text(\"name\").notNull(),\n  description: text(\"description\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const questions = pgTable(\"questions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  trackId: varchar(\"track_id\").references(() => tracks.id),\n  text: text(\"text\").notNull(),\n  options: jsonb(\"options\").notNull().$type<string[]>(),\n  correctIndex: integer(\"correct_index\").notNull(),\n  complexity: integer(\"complexity\").notNull(), // 1-5\n  isBenchmark: boolean(\"is_benchmark\").notNull().default(false),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const phrases = pgTable(\"phrases\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  normalized: text(\"normalized\").notNull().unique(),\n  redacted: text(\"redacted\").notNull(),\n  globalMentions: integer(\"global_mentions\").notNull().default(0),\n  trackMentions: jsonb(\"track_mentions\").notNull().$type<Record<string, number>>().default({}),\n  lastCycleCounted: integer(\"last_cycle_counted\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\nexport const cycles = pgTable(\"cycles\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  cycleNumber: integer(\"cycle_number\").notNull().unique(),\n  startDate: timestamp(\"start_date\").notNull().defaultNow(),\n  endDate: timestamp(\"end_date\"),\n  isActive: boolean(\"is_active\").notNull().default(true),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const trainAttempts = pgTable(\"train_attempts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id),\n  trackId: varchar(\"track_id\").references(() => tracks.id),\n  difficulty: text(\"difficulty\").notNull(), // \"low\" | \"medium\" | \"high\" | \"extreme\"\n  cost: numeric(\"cost\", { precision: 18, scale: 8 }).notNull(),\n  content: text(\"content\").notNull(),\n  status: text(\"status\").notNull().default(\"pending\"), // \"pending\" | \"approved\" | \"rejected\"\n  evidencePacket: jsonb(\"evidence_packet\").$type<Record<string, any>>(),\n  cycleId: varchar(\"cycle_id\").references(() => cycles.id),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  reviewedAt: timestamp(\"reviewed_at\"),\n});\n\nexport const reviews = pgTable(\"reviews\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  attemptId: varchar(\"attempt_id\").notNull().references(() => trainAttempts.id),\n  reviewerId: varchar(\"reviewer_id\").notNull().references(() => users.id),\n  vote: text(\"vote\").notNull(), // \"approve\" | \"reject\"\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const locks = pgTable(\"locks\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id),\n  attemptId: varchar(\"attempt_id\").references(() => trainAttempts.id),\n  amount: numeric(\"amount\", { precision: 18, scale: 8 }).notNull(),\n  originalAmount: numeric(\"original_amount\", { precision: 18, scale: 8 }).notNull(),\n  cycleCreated: integer(\"cycle_created\").notNull(),\n  cyclesRemaining: integer(\"cycles_remaining\").notNull(),\n  unlockedAt: timestamp(\"unlocked_at\"),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const modelVersions = pgTable(\"model_versions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  versionNumber: integer(\"version_number\").notNull().unique(),\n  cycleId: varchar(\"cycle_id\").references(() => cycles.id),\n  isActive: boolean(\"is_active\").notNull().default(false),\n  datasetSize: integer(\"dataset_size\").notNull().default(0),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  activatedAt: timestamp(\"activated_at\"),\n});\n\nexport const benchmarks = pgTable(\"benchmarks\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  modelVersionId: varchar(\"model_version_id\").references(() => modelVersions.id),\n  previousModelVersionId: varchar(\"previous_model_version_id\").references(() => modelVersions.id),\n  score: numeric(\"score\", { precision: 10, scale: 2 }).notNull(),\n  previousScore: numeric(\"previous_score\", { precision: 10, scale: 2 }),\n  scoreDrop: numeric(\"score_drop\", { precision: 10, scale: 2 }),\n  wasRolledBack: boolean(\"was_rolled_back\").notNull().default(false),\n  quarantinedCycleId: varchar(\"quarantined_cycle_id\").references(() => cycles.id),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const hubPosts = pgTable(\"hub_posts\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  posterId: varchar(\"poster_id\").references(() => users.id),\n  content: text(\"content\").notNull(),\n  cycleId: varchar(\"cycle_id\").references(() => cycles.id),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\nexport const hubSubmissions = pgTable(\"hub_submissions\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  userId: varchar(\"user_id\").references(() => users.id),\n  content: text(\"content\").notNull(),\n  fee: numeric(\"fee\", { precision: 18, scale: 8 }).notNull(),\n  status: text(\"status\").notNull().default(\"pending\"), // \"pending\" | \"approved\" | \"rejected\"\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n  reviewedAt: timestamp(\"reviewed_at\"),\n});\n\n// Training Pool (global state)\nexport const trainingPool = pgTable(\"training_pool\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  amount: numeric(\"amount\", { precision: 18, scale: 8 }).notNull().default(\"0\"),\n  updatedAt: timestamp(\"updated_at\").notNull().defaultNow(),\n});\n\n// Training Corpus Items - the canonical dataset the official HiveMind AI learns from\nexport const trainingCorpusItems = pgTable(\"training_corpus_items\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  trackId: varchar(\"track_id\").notNull().references(() => tracks.id),\n  cycleId: varchar(\"cycle_id\").notNull().references(() => cycles.id),\n  normalizedText: text(\"normalized_text\").notNull(),\n  sourceAttemptId: varchar(\"source_attempt_id\").references(() => trainAttempts.id),\n  approvedAt: timestamp(\"approved_at\").notNull().defaultNow(),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Chat messages for the official HiveMind AI\nexport const chatMessages = pgTable(\"chat_messages\", {\n  id: varchar(\"id\").primaryKey().default(sql`gen_random_uuid()`),\n  walletAddress: varchar(\"wallet_address\").notNull(),\n  trackId: varchar(\"track_id\").references(() => tracks.id),\n  aiLevel: integer(\"ai_level\").notNull(),\n  userMessage: text(\"user_message\").notNull(),\n  aiResponse: text(\"ai_response\").notNull(),\n  corpusItemsUsed: jsonb(\"corpus_items_used\").$type<string[]>().default([]),\n  createdAt: timestamp(\"created_at\").notNull().defaultNow(),\n});\n\n// Types\nexport type ChatMessage = typeof chatMessages.$inferSelect;\nexport type Track = typeof tracks.$inferSelect;\nexport type Question = typeof questions.$inferSelect;\nexport type Phrase = typeof phrases.$inferSelect;\nexport type Cycle = typeof cycles.$inferSelect;\nexport type TrainAttempt = typeof trainAttempts.$inferSelect;\nexport type Review = typeof reviews.$inferSelect;\nexport type Lock = typeof locks.$inferSelect;\nexport type ModelVersion = typeof modelVersions.$inferSelect;\nexport type Benchmark = typeof benchmarks.$inferSelect;\nexport type HubPost = typeof hubPosts.$inferSelect;\nexport type HubSubmission = typeof hubSubmissions.$inferSelect;\nexport type TrainingPool = typeof trainingPool.$inferSelect;\nexport type TrainingCorpusItem = typeof trainingCorpusItems.$inferSelect;\n\n// Insert schemas\nexport const insertTrackSchema = createInsertSchema(tracks).omit({ id: true, createdAt: true });\nexport type InsertTrack = z.infer<typeof insertTrackSchema>;\n\nexport const insertCycleSchema = createInsertSchema(cycles).omit({ id: true, createdAt: true });\nexport type InsertCycle = z.infer<typeof insertCycleSchema>;\n\nexport const insertTrainingCorpusItemSchema = createInsertSchema(trainingCorpusItems).omit({ id: true, createdAt: true });\nexport type InsertTrainingCorpusItem = z.infer<typeof insertTrainingCorpusItemSchema>;\n\nexport const insertChatMessageSchema = createInsertSchema(chatMessages).omit({ id: true, createdAt: true });\nexport type InsertChatMessage = z.infer<typeof insertChatMessageSchema>;\n","path":null,"size_bytes":9293,"size_tokens":null},"client/src/components/game/TokenGate.tsx":{"content":"import { AlertCircle, Coins } from \"lucide-react\";\nimport { MINIMUM_TOKENS_REQUIRED } from \"@/lib/solanaWallet\";\n\ninterface TokenGateProps {\n  balance: number;\n  isLoading: boolean;\n}\n\nexport default function TokenGate({ balance, isLoading }: TokenGateProps) {\n  const hasEnough = balance >= MINIMUM_TOKENS_REQUIRED;\n\n  if (isLoading) {\n    return (\n      <div\n        className=\"p-4 rounded-lg bg-muted/30 border border-border/50 flex items-center gap-3\"\n        data-testid=\"token-gate-loading\"\n      >\n        <div className=\"w-5 h-5 border-2 border-primary border-t-transparent rounded-full animate-spin\" />\n        <span className=\"text-sm text-muted-foreground\">Checking token balance...</span>\n      </div>\n    );\n  }\n\n  if (hasEnough) {\n    return (\n      <div\n        className=\"p-4 rounded-lg bg-success/10 border border-success/30 flex items-center gap-3\"\n        data-testid=\"token-gate-success\"\n      >\n        <Coins className=\"w-5 h-5 text-success shrink-0\" />\n        <div className=\"flex-1\">\n          <p className=\"text-sm font-medium text-success\">\n            {balance.toLocaleString()} $HIVE tokens detected\n          </p>\n          <p className=\"text-xs text-success/70\">You're ready to train!</p>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div\n      className=\"p-4 rounded-lg bg-destructive/10 border border-destructive/30 flex items-center gap-3\"\n      data-testid=\"token-gate-insufficient\"\n    >\n      <AlertCircle className=\"w-5 h-5 text-destructive shrink-0\" />\n      <div className=\"flex-1\">\n        <p className=\"text-sm font-medium text-destructive\">\n          Insufficient $HIVE tokens\n        </p>\n        <p className=\"text-xs text-destructive/70\">\n          You need at least {MINIMUM_TOKENS_REQUIRED} $HIVE to start a training session.\n          Current balance: {balance.toLocaleString()}\n        </p>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1882,"size_tokens":null},"client/src/components/ui/alert-dialog.tsx":{"content":"import * as React from \"react\"\nimport * as AlertDialogPrimitive from \"@radix-ui/react-alert-dialog\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nconst AlertDialog = AlertDialogPrimitive.Root\n\nconst AlertDialogTrigger = AlertDialogPrimitive.Trigger\n\nconst AlertDialogPortal = AlertDialogPrimitive.Portal\n\nconst AlertDialogOverlay = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nAlertDialogOverlay.displayName = AlertDialogPrimitive.Overlay.displayName\n\nconst AlertDialogContent = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPortal>\n    <AlertDialogOverlay />\n    <AlertDialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    />\n  </AlertDialogPortal>\n))\nAlertDialogContent.displayName = AlertDialogPrimitive.Content.displayName\n\nconst AlertDialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogHeader.displayName = \"AlertDialogHeader\"\n\nconst AlertDialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nAlertDialogFooter.displayName = \"AlertDialogFooter\"\n\nconst AlertDialogTitle = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold\", className)}\n    {...props}\n  />\n))\nAlertDialogTitle.displayName = AlertDialogPrimitive.Title.displayName\n\nconst AlertDialogDescription = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nAlertDialogDescription.displayName =\n  AlertDialogPrimitive.Description.displayName\n\nconst AlertDialogAction = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Action>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Action>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Action\n    ref={ref}\n    className={cn(buttonVariants(), className)}\n    {...props}\n  />\n))\nAlertDialogAction.displayName = AlertDialogPrimitive.Action.displayName\n\nconst AlertDialogCancel = React.forwardRef<\n  React.ElementRef<typeof AlertDialogPrimitive.Cancel>,\n  React.ComponentPropsWithoutRef<typeof AlertDialogPrimitive.Cancel>\n>(({ className, ...props }, ref) => (\n  <AlertDialogPrimitive.Cancel\n    ref={ref}\n    className={cn(\n      buttonVariants({ variant: \"outline\" }),\n      \"mt-2 sm:mt-0\",\n      className\n    )}\n    {...props}\n  />\n))\nAlertDialogCancel.displayName = AlertDialogPrimitive.Cancel.displayName\n\nexport {\n  AlertDialog,\n  AlertDialogPortal,\n  AlertDialogOverlay,\n  AlertDialogTrigger,\n  AlertDialogContent,\n  AlertDialogHeader,\n  AlertDialogFooter,\n  AlertDialogTitle,\n  AlertDialogDescription,\n  AlertDialogAction,\n  AlertDialogCancel,\n}\n","path":null,"size_bytes":4420,"size_tokens":null},"client/src/components/ui/avatar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as AvatarPrimitive from \"@radix-ui/react-avatar\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Avatar = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Root\n    ref={ref}\n    className={cn(`\n      after:content-[''] after:block after:absolute after:inset-0 after:rounded-full after:pointer-events-none after:border after:border-black/10 dark:after:border-white/10\n      relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full`,\n      className\n    )}\n    {...props}\n  />\n))\nAvatar.displayName = AvatarPrimitive.Root.displayName\n\nconst AvatarImage = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Image>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Image>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Image\n    ref={ref}\n    className={cn(\"aspect-square h-full w-full\", className)}\n    {...props}\n  />\n))\nAvatarImage.displayName = AvatarPrimitive.Image.displayName\n\nconst AvatarFallback = React.forwardRef<\n  React.ElementRef<typeof AvatarPrimitive.Fallback>,\n  React.ComponentPropsWithoutRef<typeof AvatarPrimitive.Fallback>\n>(({ className, ...props }, ref) => (\n  <AvatarPrimitive.Fallback\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full items-center justify-center rounded-full bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nAvatarFallback.displayName = AvatarPrimitive.Fallback.displayName\n\nexport { Avatar, AvatarImage, AvatarFallback }\n","path":null,"size_bytes":1592,"size_tokens":null},"client/src/components/ui/textarea.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Textarea = React.forwardRef<\n  HTMLTextAreaElement,\n  React.ComponentProps<\"textarea\">\n>(({ className, ...props }, ref) => {\n  return (\n    <textarea\n      className={cn(\n        \"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  )\n})\nTextarea.displayName = \"Textarea\"\n\nexport { Textarea }\n","path":null,"size_bytes":689,"size_tokens":null},"client/src/components/examples/GameContainerExample.tsx":{"content":"import GameContainer from \"../game/GameContainer\";\n\nexport default function GameContainerExample() {\n  return <GameContainer />;\n}\n","path":null,"size_bytes":131,"size_tokens":null},"client/src/components/game/QuestionCard.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport type { Question } from \"@/lib/gameData\";\nimport { AlertTriangle } from \"lucide-react\";\n\ninterface QuestionCardProps {\n  question: Question;\n  currentIndex: number;\n  totalQuestions: number;\n  correctCount: number;\n  onAnswer: (selectedIndex: number) => void;\n  isLocked: boolean;\n  selectedIndex: number | null;\n}\n\nexport default function QuestionCard({\n  question,\n  currentIndex,\n  totalQuestions,\n  correctCount,\n  onAnswer,\n  isLocked,\n  selectedIndex,\n}: QuestionCardProps) {\n  const progressPercent = ((currentIndex) / totalQuestions) * 100;\n\n  return (\n    <div className=\"space-y-5\" data-testid=\"question-card\">\n      <div className=\"space-y-2\">\n        <div className=\"flex items-center justify-between gap-4\">\n          <span className=\"text-sm font-medium text-foreground\" data-testid=\"text-question-counter\">\n            Question {currentIndex + 1} of {totalQuestions}\n          </span>\n          <span className=\"text-sm text-muted-foreground\" data-testid=\"text-correct-counter\">\n            Correct so far: {correctCount}\n          </span>\n        </div>\n        <div className=\"h-1.5 w-full bg-background/50 rounded-full overflow-hidden border border-border/30\">\n          <div\n            className=\"h-full bg-gradient-to-r from-primary to-primary/70 transition-all duration-300\"\n            style={{ width: `${progressPercent}%` }}\n            data-testid=\"progress-bar\"\n          />\n        </div>\n      </div>\n\n      <div className=\"min-h-[80px] p-4 rounded-lg bg-background/40 border border-border/30\">\n        <p className=\"text-lg font-medium text-foreground leading-relaxed\" data-testid=\"text-question\">\n          {question.text}\n        </p>\n      </div>\n\n      <div className=\"space-y-2\">\n        {question.options.map((option, index) => {\n          const isSelected = selectedIndex === index;\n          return (\n            <Button\n              key={index}\n              variant={isSelected ? \"default\" : \"outline\"}\n              className={`w-full h-auto min-h-[52px] justify-start text-left px-4 py-3 text-sm font-normal transition-all ${\n                isSelected ? \"ring-2 ring-primary ring-offset-2 ring-offset-card\" : \"\"\n              }`}\n              onClick={() => onAnswer(index)}\n              disabled={isLocked}\n              data-testid={`button-option-${index}`}\n            >\n              {option}\n            </Button>\n          );\n        })}\n      </div>\n\n      <div className=\"flex items-center gap-2 text-xs text-muted-foreground justify-center pt-2\">\n        <AlertTriangle className=\"w-3.5 h-3.5\" />\n        <span>Remember: score below 50% can make your AI lose intelligence</span>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2721,"size_tokens":null},"client/src/components/ui/input-otp.tsx":{"content":"import * as React from \"react\"\nimport { OTPInput, OTPInputContext } from \"input-otp\"\nimport { Dot } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst InputOTP = React.forwardRef<\n  React.ElementRef<typeof OTPInput>,\n  React.ComponentPropsWithoutRef<typeof OTPInput>\n>(({ className, containerClassName, ...props }, ref) => (\n  <OTPInput\n    ref={ref}\n    containerClassName={cn(\n      \"flex items-center gap-2 has-[:disabled]:opacity-50\",\n      containerClassName\n    )}\n    className={cn(\"disabled:cursor-not-allowed\", className)}\n    {...props}\n  />\n))\nInputOTP.displayName = \"InputOTP\"\n\nconst InputOTPGroup = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"flex items-center\", className)} {...props} />\n))\nInputOTPGroup.displayName = \"InputOTPGroup\"\n\nconst InputOTPSlot = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\"> & { index: number }\n>(({ index, className, ...props }, ref) => {\n  const inputOTPContext = React.useContext(OTPInputContext)\n  const { char, hasFakeCaret, isActive } = inputOTPContext.slots[index]\n\n  return (\n    <div\n      ref={ref}\n      className={cn(\n        \"relative flex h-10 w-10 items-center justify-center border-y border-r border-input text-sm transition-all first:rounded-l-md first:border-l last:rounded-r-md\",\n        isActive && \"z-10 ring-2 ring-ring ring-offset-background\",\n        className\n      )}\n      {...props}\n    >\n      {char}\n      {hasFakeCaret && (\n        <div className=\"pointer-events-none absolute inset-0 flex items-center justify-center\">\n          <div className=\"h-4 w-px animate-caret-blink bg-foreground duration-1000\" />\n        </div>\n      )}\n    </div>\n  )\n})\nInputOTPSlot.displayName = \"InputOTPSlot\"\n\nconst InputOTPSeparator = React.forwardRef<\n  React.ElementRef<\"div\">,\n  React.ComponentPropsWithoutRef<\"div\">\n>(({ ...props }, ref) => (\n  <div ref={ref} role=\"separator\" {...props}>\n    <Dot />\n  </div>\n))\nInputOTPSeparator.displayName = \"InputOTPSeparator\"\n\nexport { InputOTP, InputOTPGroup, InputOTPSlot, InputOTPSeparator }\n","path":null,"size_bytes":2154,"size_tokens":null},"client/src/lib/solanaWallet.ts":{"content":"// Solana wallet utilities using Phantom's injected provider\n// No external packages required - uses window.solana directly\n\nexport interface PhantomProvider {\n  isPhantom?: boolean;\n  connect: () => Promise<{ publicKey: { toString: () => string } }>;\n  disconnect: () => Promise<void>;\n  on: (event: string, callback: (...args: unknown[]) => void) => void;\n  off: (event: string, callback: (...args: unknown[]) => void) => void;\n  publicKey?: { toString: () => string };\n  isConnected?: boolean;\n  signMessage?: (message: Uint8Array, encoding?: string) => Promise<{ signature: Uint8Array }>;\n}\n\ndeclare global {\n  interface Window {\n    solana?: PhantomProvider;\n  }\n}\n\n// The $HIVE token mint address on Solana mainnet\nexport const MEME_TOKEN_MINT = \"F3zvEFZVhDXNo1kZDPg24Z3RioDzCdEJVdnZ5FCcpump\";\n\n// Minimum tokens required to play (with 6 decimals, raw = 50 * 1_000_000)\nexport const MINIMUM_TOKENS_REQUIRED = 50;\nexport const TOKEN_DECIMALS = 6;\n\n// RPC endpoints for Solana mainnet (with fallbacks due to rate limiting)\nconst SOLANA_RPC_ENDPOINTS = [\n  \"https://api.mainnet-beta.solana.com\",\n  \"https://rpc.ankr.com/solana\",\n  \"https://solana.public-rpc.com\",\n];\n\n// Try endpoints in order until one works\nasync function fetchWithFallback(body: object): Promise<Response> {\n  let lastError: Error | null = null;\n  \n  for (const endpoint of SOLANA_RPC_ENDPOINTS) {\n    try {\n      const response = await fetch(endpoint, {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify(body),\n      });\n      \n      // Check if response is a rate limit error\n      const clone = response.clone();\n      const data = await clone.json();\n      if (data.error?.code === 403 || data.error?.message?.includes(\"forbidden\")) {\n        if (import.meta.env.DEV) {\n          console.log(`[RPC] ${endpoint} rate limited, trying next...`);\n        }\n        continue;\n      }\n      \n      return response;\n    } catch (error) {\n      lastError = error as Error;\n      if (import.meta.env.DEV) {\n        console.log(`[RPC] ${endpoint} failed, trying next...`);\n      }\n    }\n  }\n  \n  throw lastError || new Error(\"All RPC endpoints failed\");\n}\n\n// Token Program IDs\nconst TOKEN_PROGRAM_ID = \"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"; // Legacy SPL Token\nconst TOKEN_2022_PROGRAM_ID = \"TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb\"; // Token-2022\n\n// Debug info for development\nexport interface TokenBalanceDebug {\n  programUsed: \"Token-2022\" | \"Legacy SPL\" | \"Both\" | \"None\";\n  rawBalanceSum: number;\n  decimals: number;\n  uiAmount: number;\n  token2022Accounts: number;\n  legacyAccounts: number;\n}\n\nexport function getPhantomProvider(): PhantomProvider | null {\n  if (typeof window !== \"undefined\" && window.solana?.isPhantom) {\n    return window.solana;\n  }\n  return null;\n}\n\nexport function isPhantomInstalled(): boolean {\n  return getPhantomProvider() !== null;\n}\n\nexport async function connectWallet(): Promise<string | null> {\n  const provider = getPhantomProvider();\n  if (!provider) {\n    window.open(\"https://phantom.app/\", \"_blank\");\n    return null;\n  }\n\n  try {\n    const response = await provider.connect();\n    return response.publicKey.toString();\n  } catch (error) {\n    console.error(\"Failed to connect wallet:\", error);\n    return null;\n  }\n}\n\nexport async function disconnectWallet(): Promise<void> {\n  const provider = getPhantomProvider();\n  if (provider) {\n    try {\n      await provider.disconnect();\n    } catch (error) {\n      console.error(\"Failed to disconnect wallet:\", error);\n    }\n  }\n}\n\nexport function getConnectedAddress(): string | null {\n  const provider = getPhantomProvider();\n  if (provider?.isConnected && provider.publicKey) {\n    return provider.publicKey.toString();\n  }\n  return null;\n}\n\nexport function shortenAddress(address: string, chars = 4): string {\n  return `${address.slice(0, chars)}...${address.slice(-chars)}`;\n}\n\n// Last debug info for development display\nlet lastDebugInfo: TokenBalanceDebug | null = null;\n\nexport function getLastTokenDebugInfo(): TokenBalanceDebug | null {\n  return lastDebugInfo;\n}\n\n// Helper to query token accounts by owner for a specific program\nasync function queryTokenAccountsByProgram(\n  walletAddress: string,\n  programId: string\n): Promise<Array<{ mint: string; rawAmount: string; decimals: number; uiAmount: number }>> {\n  try {\n    const response = await fetchWithFallback({\n      jsonrpc: \"2.0\",\n      id: 1,\n      method: \"getTokenAccountsByOwner\",\n      params: [\n        walletAddress,\n        { programId },\n        { encoding: \"jsonParsed\", commitment: \"confirmed\" },\n      ],\n    });\n\n    const data = await response.json();\n    const accounts: Array<{ mint: string; rawAmount: string; decimals: number; uiAmount: number }> = [];\n\n    // Debug: log RPC response\n    if (import.meta.env.DEV) {\n      const programName = programId === TOKEN_2022_PROGRAM_ID ? \"Token-2022\" : \"Legacy\";\n      console.log(`[RPC ${programName}] wallet=${walletAddress.slice(0,8)}... accounts=${data.result?.value?.length || 0}`, data.error || \"\");\n    }\n\n    if (data.result?.value?.length > 0) {\n      for (const tokenAccount of data.result.value) {\n        const info = tokenAccount.account.data.parsed.info;\n        accounts.push({\n          mint: info.mint,\n          rawAmount: info.tokenAmount.amount || \"0\",\n          decimals: info.tokenAmount.decimals || 0,\n          uiAmount: info.tokenAmount.uiAmount || 0,\n        });\n      }\n    }\n\n    return accounts;\n  } catch (error) {\n    console.error(`Failed to query ${programId}:`, error);\n    return [];\n  }\n}\n\n// Fetch token balance via server API (uses Helius RPC with proper rate limits)\nexport async function getTokenBalance(\n  walletAddress: string,\n  _tokenMint: string = MEME_TOKEN_MINT\n): Promise<number> {\n  try {\n    const response = await fetch(`/api/balance/${walletAddress}`);\n    if (!response.ok) {\n      throw new Error(`Server returned ${response.status}`);\n    }\n    \n    const data = await response.json();\n    \n    // Store debug info\n    lastDebugInfo = {\n      programUsed: \"Server API\",\n      rawBalanceSum: Math.round((data.hiveAmount || 0) * 1_000_000),\n      decimals: TOKEN_DECIMALS,\n      uiAmount: data.hiveAmount || 0,\n      token2022Accounts: data.hasAccess ? 1 : 0,\n      legacyAccounts: 0,\n    };\n\n    if (import.meta.env.DEV) {\n      console.log(\"[Token Balance Debug]\", lastDebugInfo);\n      console.log(\"[Server Response]\", data);\n    }\n\n    return data.hiveAmount || 0;\n  } catch (error) {\n    console.error(\"Failed to fetch token balance:\", error);\n    lastDebugInfo = {\n      programUsed: \"Error\",\n      rawBalanceSum: 0,\n      decimals: TOKEN_DECIMALS,\n      uiAmount: 0,\n      token2022Accounts: 0,\n      legacyAccounts: 0,\n    };\n    return 0;\n  }\n}\n\nexport function hasEnoughTokens(balance: number): boolean {\n  return balance >= MINIMUM_TOKENS_REQUIRED;\n}\n\n/**\n * Sign a message with the connected wallet\n * Phantom's signMessage API accepts Uint8Array directly and returns { signature: Uint8Array }\n */\nexport async function signMessage(message: string): Promise<string | null> {\n  const provider = getPhantomProvider();\n  if (!provider || !provider.publicKey) {\n    console.error(\"No provider or publicKey available\");\n    return null;\n  }\n\n  try {\n    const messageBytes = new TextEncoder().encode(message);\n    \n    if (typeof provider.signMessage !== \"function\") {\n      console.error(\"signMessage not available on provider\");\n      return null;\n    }\n    \n    // Phantom's signMessage takes Uint8Array directly (not wrapped in object)\n    const result = await provider.signMessage(messageBytes, \"utf8\");\n    \n    // Result should have signature property as Uint8Array\n    if (result && result.signature) {\n      const signature = result.signature;\n      if (signature instanceof Uint8Array) {\n        // Convert Uint8Array to base64\n        return btoa(String.fromCharCode(...signature));\n      }\n    }\n    \n    console.error(\"signMessage returned unexpected format:\", result);\n    return null;\n  } catch (error) {\n    console.error(\"Failed to sign message:\", error);\n    return null;\n  }\n}\n\n/**\n * Authenticate with the server using wallet signature\n */\nexport async function authenticateWithServer(publicKey: string): Promise<boolean> {\n  try {\n    // Step 1: Get challenge nonce\n    const challengeRes = await fetch(`/api/auth/challenge?publicKey=${encodeURIComponent(publicKey)}`);\n    if (!challengeRes.ok) {\n      console.error(\"Failed to get challenge\");\n      return false;\n    }\n    const { nonce } = await challengeRes.json();\n\n    // Step 2: Sign the message\n    const message = `Sign this message to authenticate: ${nonce}`;\n    const signature = await signMessage(message);\n    if (!signature) {\n      console.error(\"Failed to sign message\");\n      return false;\n    }\n\n    // Step 3: Verify with server\n    const verifyRes = await fetch(\"/api/auth/verify\", {\n      method: \"POST\",\n      headers: { \"Content-Type\": \"application/json\" },\n      credentials: \"include\", // Important for cookies\n      body: JSON.stringify({\n        publicKey,\n        signature,\n        nonce,\n      }),\n    });\n\n    if (!verifyRes.ok) {\n      console.error(\"Failed to verify authentication\");\n      return false;\n    }\n\n    // Step 4: Save token to localStorage for use by other pages\n    const data = await verifyRes.json();\n    if (data.token) {\n      localStorage.setItem(\"auth_token\", data.token);\n    }\n\n    return true;\n  } catch (error) {\n    console.error(\"Authentication error:\", error);\n    return false;\n  }\n}\n\n/**\n * Gate status response from server\n * Access is based on token amount (hiveAmount >= requiredHiveAmount)\n * Price info (hiveUsd, priceUsd) is for display only\n */\nexport interface GateStatus {\n  hasAccess: boolean;\n  hiveAmount: number;\n  requiredHiveAmount: number;\n  hiveUsd: number | null;\n  priceUsd: number | null;\n  priceMissing: boolean;\n}\n\n/**\n * Check gate status (HIVE access)\n */\nexport async function checkGateStatus(): Promise<GateStatus | null> {\n  try {\n    const res = await fetch(\"/api/gate/status\", {\n      credentials: \"include\", // Important for cookies\n    });\n\n    if (!res.ok) {\n      if (res.status === 401) {\n        return null; // Not authenticated\n      }\n      throw new Error(`Gate status check failed: ${res.status}`);\n    }\n\n    return await res.json();\n  } catch (error) {\n    console.error(\"Gate status check error:\", error);\n    return null;\n  }\n}\n","path":null,"size_bytes":10425,"size_tokens":null},"client/src/components/ui/switch.tsx":{"content":"import * as React from \"react\"\nimport * as SwitchPrimitives from \"@radix-ui/react-switch\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Switch = React.forwardRef<\n  React.ElementRef<typeof SwitchPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof SwitchPrimitives.Root>\n>(({ className, ...props }, ref) => (\n  <SwitchPrimitives.Root\n    className={cn(\n      \"peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  >\n    <SwitchPrimitives.Thumb\n      className={cn(\n        \"pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0\"\n      )}\n    />\n  </SwitchPrimitives.Root>\n))\nSwitch.displayName = SwitchPrimitives.Root.displayName\n\nexport { Switch }\n","path":null,"size_bytes":1139,"size_tokens":null},"client/src/components/game/HowItWorks.tsx":{"content":"import { useState } from \"react\";\nimport { ChevronDown, ChevronUp, BookOpen, Brain, Coins, Wallet } from \"lucide-react\";\n\nexport default function HowItWorks() {\n  const [isExpanded, setIsExpanded] = useState(false);\n\n  return (\n    <div className=\"rounded-lg bg-background/30 border border-border/20\" data-testid=\"how-it-works\">\n      <button\n        className=\"w-full flex items-center justify-between p-3 text-left\"\n        onClick={() => setIsExpanded(!isExpanded)}\n        data-testid=\"button-toggle-how-it-works\"\n      >\n        <div className=\"flex items-center gap-2\">\n          <BookOpen className=\"w-4 h-4 text-muted-foreground\" />\n          <span className=\"text-sm font-medium text-foreground\">How it Works</span>\n        </div>\n        {isExpanded ? (\n          <ChevronUp className=\"w-4 h-4 text-muted-foreground\" />\n        ) : (\n          <ChevronDown className=\"w-4 h-4 text-muted-foreground\" />\n        )}\n      </button>\n      \n      {isExpanded && (\n        <div className=\"px-3 pb-3 space-y-3 text-xs text-muted-foreground\" data-testid=\"how-it-works-content\">\n          <div className=\"space-y-1.5\">\n            <div className=\"flex items-center gap-2 text-foreground font-medium\">\n              <Brain className=\"w-3.5 h-3.5 text-primary\" />\n              <span>Training</span>\n            </div>\n            <p className=\"pl-5\">\n              Each session has 10 questions. Unlimited levels with increasing difficulty and stricter pass thresholds as you progress.\n            </p>\n          </div>\n          \n          <div className=\"space-y-1.5\">\n            <div className=\"flex items-center gap-2 text-foreground font-medium\">\n              <Brain className=\"w-3.5 h-3.5 text-success\" />\n              <span>Intelligence</span>\n            </div>\n            <ul className=\"pl-5 space-y-0.5\">\n              <li>Score 70%+ and your AI learns and may unlock higher levels</li>\n              <li>Score 50-69% and the session is discarded (no learning)</li>\n              <li>Score below 50% and your AI loses intelligence</li>\n            </ul>\n          </div>\n          \n          <div className=\"space-y-1.5\">\n            <div className=\"flex items-center gap-2 text-foreground font-medium\">\n              <Coins className=\"w-3.5 h-3.5 text-yellow-500\" />\n              <span>Style Credits</span>\n            </div>\n            <p className=\"pl-5\">\n              Earned from good training runs. Spend them in the Cosmetics shop to customize your AI's appearance with skins and auras.\n            </p>\n          </div>\n          \n          <div className=\"space-y-1.5\">\n            <div className=\"flex items-center gap-2 text-foreground font-medium\">\n              <Wallet className=\"w-3.5 h-3.5 text-blue-400\" />\n              <span>Wallet & Token</span>\n            </div>\n            <p className=\"pl-5\">\n              Connect your Phantom wallet with at least 50 of the game token to start training sessions.\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":3015,"size_tokens":null},"server/vite.ts":{"content":"import { type Express } from \"express\";\nimport { createServer as createViteServer, createLogger } from \"vite\";\nimport { type Server } from \"http\";\nimport viteConfig from \"../vite.config\";\nimport fs from \"fs\";\nimport path from \"path\";\nimport { nanoid } from \"nanoid\";\n\nconst viteLogger = createLogger();\n\nexport async function setupVite(server: Server, app: Express) {\n  const serverOptions = {\n    middlewareMode: true,\n    hmr: { server, path: \"/vite-hmr\" },\n    allowedHosts: true as const,\n  };\n\n  const vite = await createViteServer({\n    ...viteConfig,\n    configFile: false,\n    customLogger: {\n      ...viteLogger,\n      error: (msg, options) => {\n        viteLogger.error(msg, options);\n        process.exit(1);\n      },\n    },\n    server: serverOptions,\n    appType: \"custom\",\n  });\n\n  app.use(vite.middlewares);\n\n  app.use(\"*\", async (req, res, next) => {\n    const url = req.originalUrl;\n\n    try {\n      const clientTemplate = path.resolve(\n        import.meta.dirname,\n        \"..\",\n        \"client\",\n        \"index.html\",\n      );\n\n      // always reload the index.html file from disk incase it changes\n      let template = await fs.promises.readFile(clientTemplate, \"utf-8\");\n      template = template.replace(\n        `src=\"/src/main.tsx\"`,\n        `src=\"/src/main.tsx?v=${nanoid()}\"`,\n      );\n      const page = await vite.transformIndexHtml(url, template);\n      res.status(200).set({ \"Content-Type\": \"text/html\" }).end(page);\n    } catch (e) {\n      vite.ssrFixStacktrace(e as Error);\n      next(e);\n    }\n  });\n}\n","path":null,"size_bytes":1534,"size_tokens":null},"server/storage.ts":{"content":"import {\n  type User,\n  type InsertUser,\n  type Track,\n  type Question,\n  type Phrase,\n  type Cycle,\n  type TrainAttempt,\n  type Review,\n  type Lock,\n  type ModelVersion,\n  type Benchmark,\n  type HubPost,\n  type HubSubmission,\n  type TrainingCorpusItem,\n  type ChatMessage,\n  users,\n  tracks,\n  questions,\n  phrases,\n  cycles,\n  trainAttempts,\n  reviews,\n  locks,\n  modelVersions,\n  benchmarks,\n  hubPosts,\n  hubSubmissions,\n  trainingPool,\n  trainingCorpusItems,\n  chatMessages,\n} from \"@shared/schema\";\nimport { db } from \"./db\";\nimport { eq, and, desc, sql, gte, lte } from \"drizzle-orm\";\n\nexport interface IStorage {\n  // User operations\n  getUser(id: string): Promise<User | undefined>;\n  getUserByUsername(username: string): Promise<User | undefined>;\n  createUser(user: InsertUser): Promise<User>;\n  updateUserRole(userId: string, role: \"reviewer\" | \"hubPoster\" | \"admin\", value: boolean): Promise<User>;\n\n  // Track operations\n  getAllTracks(): Promise<Track[]>;\n  getTrack(id: string): Promise<Track | undefined>;\n  createTrack(name: string, description?: string): Promise<Track>;\n\n  // Question operations\n  getQuestionsByTrack(trackId: string): Promise<Question[]>;\n  getBenchmarkQuestions(): Promise<Question[]>;\n  createQuestion(data: {\n    trackId?: string;\n    text: string;\n    options: string[];\n    correctIndex: number;\n    complexity: number;\n    isBenchmark?: boolean;\n  }): Promise<Question>;\n\n  // Cycle operations\n  getCurrentCycle(): Promise<Cycle | undefined>;\n  getCycleByNumber(cycleNumber: number): Promise<Cycle | undefined>;\n  createCycle(cycleNumber: number): Promise<Cycle>;\n  endCycle(cycleId: string): Promise<Cycle>;\n  unlockLocksForCycle(cycleNumber: number): Promise<void>;\n\n  // Phrase operations\n  getPhrasesByMentions(minMentions: number, cycleId?: number): Promise<Phrase[]>;\n  incrementPhraseMention(normalized: string, redacted: string, trackId?: string): Promise<Phrase>;\n  resetPhraseCounts(cycleId: number): Promise<void>;\n\n  // Train attempt operations\n  createTrainAttempt(data: {\n    userId: string;\n    trackId: string;\n    difficulty: \"low\" | \"medium\" | \"high\" | \"extreme\";\n    cost: string;\n    content: string;\n    cycleId: string;\n  }): Promise<TrainAttempt>;\n  getPendingAttempts(): Promise<TrainAttempt[]>;\n  getAttemptById(id: string): Promise<TrainAttempt | undefined>;\n  updateAttemptStatus(id: string, status: \"approved\" | \"rejected\", evidencePacket?: Record<string, any>): Promise<TrainAttempt>;\n  getApprovedAttemptsForCycles(cycleNumbers: number[]): Promise<TrainAttempt[]>;\n\n  // Review operations\n  createReview(attemptId: string, reviewerId: string, vote: \"approve\" | \"reject\"): Promise<Review>;\n  getReviewsForAttempt(attemptId: string): Promise<Review[]>;\n  hasReviewerVoted(attemptId: string, reviewerId: string): Promise<boolean>;\n  checkReviewConsensus(attemptId: string, difficulty: string): Promise<{ met: boolean; approveCount: number; rejectCount: number }>;\n\n  // Lock operations\n  createLock(data: {\n    userId: string;\n    attemptId: string;\n    amount: string;\n    originalAmount: string;\n    cycleCreated: number;\n  }): Promise<Lock>;\n  getActiveLocks(userId?: string): Promise<Lock[]>;\n  unlockLocks(cycleNumber: number): Promise<void>;\n\n  // Model version operations\n  getActiveModelVersion(): Promise<ModelVersion | undefined>;\n  getAllModelVersions(): Promise<ModelVersion[]>;\n  createModelVersion(cycleId: string, datasetSize: number): Promise<ModelVersion>;\n  activateModelVersion(versionId: string): Promise<ModelVersion>;\n  deactivateAllModelVersions(): Promise<void>;\n\n  // Benchmark operations\n  createBenchmark(data: {\n    modelVersionId: string;\n    previousModelVersionId?: string;\n    score: string;\n    previousScore?: string;\n  }): Promise<Benchmark>;\n  getLatestBenchmark(): Promise<Benchmark | undefined>;\n  updateBenchmarkRollback(id: string, wasRolledBack: boolean, quarantinedCycleId?: string): Promise<Benchmark>;\n\n  // Hub operations\n  createHubPost(posterId: string, content: string, cycleId: string): Promise<HubPost>;\n  getHubPosts(limit?: number): Promise<HubPost[]>;\n  createHubSubmission(userId: string, content: string, fee: string): Promise<HubSubmission>;\n  getPendingHubSubmissions(): Promise<HubSubmission[]>;\n  updateHubSubmissionStatus(id: string, status: \"approved\" | \"rejected\"): Promise<HubSubmission>;\n\n  // Training pool operations\n  getTrainingPoolAmount(): Promise<string>;\n  addToTrainingPool(amount: string): Promise<void>;\n  subtractFromTrainingPool(amount: string): Promise<void>;\n\n  // Training corpus operations\n  getAllCorpusItems(): Promise<TrainingCorpusItem[]>;\n  getCorpusItemsByTrack(trackId: string): Promise<TrainingCorpusItem[]>;\n  addCorpusItem(data: {\n    trackId: string;\n    cycleId: string;\n    normalizedText: string;\n    sourceAttemptId?: string;\n  }): Promise<TrainingCorpusItem>;\n  updateCorpusItem(id: string, normalizedText?: string, trackId?: string): Promise<TrainingCorpusItem | undefined>;\n  deleteCorpusItem(id: string): Promise<void>;\n  getCorpusStats(): Promise<{ total: number; byTrack: Record<string, number> }>;\n  getHubSubmissionById(id: string): Promise<HubSubmission | undefined>;\n  \n  // Chat operations\n  searchCorpusItems(query: string, trackId?: string, limit?: number): Promise<TrainingCorpusItem[]>;\n  saveChatMessage(data: {\n    walletAddress: string;\n    trackId?: string;\n    aiLevel: number;\n    userMessage: string;\n    aiResponse: string;\n    corpusItemsUsed?: string[];\n  }): Promise<ChatMessage>;\n  getChatHistory(walletAddress: string, limit?: number): Promise<ChatMessage[]>;\n}\n\nexport class DbStorage implements IStorage {\n  // User operations\n  async getUser(id: string): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.id, id)).limit(1);\n    return result[0];\n  }\n\n  async getUserByUsername(username: string): Promise<User | undefined> {\n    const result = await db.select().from(users).where(eq(users.username, username)).limit(1);\n    return result[0];\n  }\n\n  async createUser(insertUser: InsertUser): Promise<User> {\n    const result = await db.insert(users).values(insertUser).returning();\n    return result[0];\n  }\n\n  async updateUserRole(userId: string, role: \"reviewer\" | \"hubPoster\" | \"admin\", value: boolean): Promise<User> {\n    const updateData: Partial<User> = {};\n    if (role === \"reviewer\") updateData.isReviewer = value;\n    if (role === \"hubPoster\") updateData.isHubPoster = value;\n    if (role === \"admin\") updateData.isAdmin = value;\n\n    const result = await db.update(users).set(updateData).where(eq(users.id, userId)).returning();\n    return result[0];\n  }\n\n  // Track operations\n  async getAllTracks(): Promise<Track[]> {\n    return await db.select().from(tracks).orderBy(tracks.createdAt);\n  }\n\n  async getTrack(id: string): Promise<Track | undefined> {\n    const result = await db.select().from(tracks).where(eq(tracks.id, id)).limit(1);\n    return result[0];\n  }\n\n  async createTrack(name: string, description?: string): Promise<Track> {\n    const result = await db.insert(tracks).values({ name, description }).returning();\n    return result[0];\n  }\n\n  // Question operations\n  async getQuestionsByTrack(trackId: string): Promise<Question[]> {\n    return await db.select().from(questions).where(eq(questions.trackId, trackId));\n  }\n\n  async getBenchmarkQuestions(): Promise<Question[]> {\n    return await db.select().from(questions).where(eq(questions.isBenchmark, true));\n  }\n\n  async createQuestion(data: {\n    trackId?: string;\n    text: string;\n    options: string[];\n    correctIndex: number;\n    complexity: number;\n    isBenchmark?: boolean;\n  }): Promise<Question> {\n    const result = await db.insert(questions).values(data).returning();\n    return result[0];\n  }\n\n  // Cycle operations\n  async getCurrentCycle(): Promise<Cycle | undefined> {\n    const result = await db\n      .select()\n      .from(cycles)\n      .where(eq(cycles.isActive, true))\n      .orderBy(desc(cycles.cycleNumber))\n      .limit(1);\n    return result[0];\n  }\n\n  async getCycleByNumber(cycleNumber: number): Promise<Cycle | undefined> {\n    const result = await db.select().from(cycles).where(eq(cycles.cycleNumber, cycleNumber)).limit(1);\n    return result[0];\n  }\n\n  async createCycle(cycleNumber: number): Promise<Cycle> {\n    // Deactivate all previous cycles\n    await db.update(cycles).set({ isActive: false });\n    \n    const result = await db.insert(cycles).values({ cycleNumber, isActive: true }).returning();\n    return result[0];\n  }\n\n  async endCycle(cycleId: string): Promise<Cycle> {\n    const result = await db\n      .update(cycles)\n      .set({ isActive: false, endDate: new Date() })\n      .where(eq(cycles.id, cycleId))\n      .returning();\n    return result[0];\n  }\n\n  async unlockLocksForCycle(cycleNumber: number): Promise<void> {\n    await db\n      .update(locks)\n      .set({\n        unlockedAt: new Date(),\n        cyclesRemaining: 0,\n      })\n      .where(and(sql`${locks.unlockedAt} IS NULL`, sql`${locks.cycleCreated} + 4 <= ${cycleNumber}`));\n  }\n\n  // Phrase operations\n  async getPhrasesByMentions(minMentions: number, cycleId?: number): Promise<Phrase[]> {\n    let query = db.select().from(phrases);\n    if (cycleId) {\n      query = query.where(and(gte(phrases.globalMentions, minMentions), eq(phrases.lastCycleCounted, cycleId)));\n    } else {\n      query = query.where(gte(phrases.globalMentions, minMentions));\n    }\n    return await query;\n  }\n\n  async incrementPhraseMention(normalized: string, redacted: string, trackId?: string): Promise<Phrase> {\n    const existing = await db.select().from(phrases).where(eq(phrases.normalized, normalized)).limit(1);\n    \n    if (existing[0]) {\n      const currentMentions = existing[0].globalMentions || 0;\n      const updates: any = {\n        globalMentions: currentMentions + 1,\n        updatedAt: new Date(),\n      };\n      \n      if (trackId) {\n        const trackMentions = existing[0].trackMentions || {};\n        trackMentions[trackId] = (trackMentions[trackId] || 0) + 1;\n        updates.trackMentions = trackMentions;\n      }\n      \n      const result = await db.update(phrases).set(updates).where(eq(phrases.id, existing[0].id)).returning();\n      return result[0];\n    } else {\n      const trackMentions = trackId ? { [trackId]: 1 } : {};\n      const result = await db\n        .insert(phrases)\n        .values({\n          normalized,\n          redacted,\n          globalMentions: 1,\n          trackMentions,\n        })\n        .returning();\n      return result[0];\n    }\n  }\n\n  async resetPhraseCounts(cycleId: number): Promise<void> {\n    await db.update(phrases).set({ lastCycleCounted: cycleId });\n  }\n\n  // Train attempt operations\n  async createTrainAttempt(data: {\n    userId: string;\n    trackId: string;\n    difficulty: \"low\" | \"medium\" | \"high\" | \"extreme\";\n    cost: string;\n    content: string;\n    cycleId: string;\n  }): Promise<TrainAttempt> {\n    const result = await db.insert(trainAttempts).values({ ...data, status: \"pending\" }).returning();\n    return result[0];\n  }\n\n  async getPendingAttempts(): Promise<TrainAttempt[]> {\n    return await db.select().from(trainAttempts).where(eq(trainAttempts.status, \"pending\")).orderBy(desc(trainAttempts.createdAt));\n  }\n\n  async getAttemptById(id: string): Promise<TrainAttempt | undefined> {\n    const result = await db.select().from(trainAttempts).where(eq(trainAttempts.id, id)).limit(1);\n    return result[0];\n  }\n\n  async updateAttemptStatus(id: string, status: \"approved\" | \"rejected\", evidencePacket?: Record<string, any>): Promise<TrainAttempt> {\n    const updates: any = { status, reviewedAt: new Date() };\n    if (evidencePacket) updates.evidencePacket = evidencePacket;\n    \n    const result = await db.update(trainAttempts).set(updates).where(eq(trainAttempts.id, id)).returning();\n    return result[0];\n  }\n\n  async getApprovedAttemptsForCycles(cycleNumbers: number[]): Promise<TrainAttempt[]> {\n    if (cycleNumbers.length === 0) return [];\n    \n    const cycleList = await db.select({ id: cycles.id, cycleNumber: cycles.cycleNumber }).from(cycles);\n    const matchingCycles = cycleList.filter(c => cycleNumbers.includes(c.cycleNumber));\n    \n    if (matchingCycles.length === 0) return [];\n    \n    const cycleIdList = matchingCycles.map(c => c.id);\n    // Get approved attempts for these cycles\n    const allApproved = await db.select().from(trainAttempts).where(eq(trainAttempts.status, \"approved\"));\n    return allApproved.filter(attempt => attempt.cycleId && cycleIdList.includes(attempt.cycleId));\n  }\n\n  // Review operations\n  async createReview(attemptId: string, reviewerId: string, vote: \"approve\" | \"reject\"): Promise<Review> {\n    const result = await db.insert(reviews).values({ attemptId, reviewerId, vote }).returning();\n    return result[0];\n  }\n\n  async getReviewsForAttempt(attemptId: string): Promise<Review[]> {\n    return await db.select().from(reviews).where(eq(reviews.attemptId, attemptId));\n  }\n\n  async hasReviewerVoted(attemptId: string, reviewerId: string): Promise<boolean> {\n    const result = await db\n      .select()\n      .from(reviews)\n      .where(and(eq(reviews.attemptId, attemptId), eq(reviews.reviewerId, reviewerId)))\n      .limit(1);\n    return result.length > 0;\n  }\n\n  async checkReviewConsensus(attemptId: string, difficulty: string): Promise<{ met: boolean; approveCount: number; rejectCount: number }> {\n    const reviewList = await this.getReviewsForAttempt(attemptId);\n    const approveCount = reviewList.filter(r => r.vote === \"approve\").length;\n    const rejectCount = reviewList.filter(r => r.vote === \"reject\").length;\n    \n    let required: number;\n    if (difficulty === \"low\" || difficulty === \"medium\") {\n      required = 2; // 2-of-3\n    } else {\n      required = 3; // 3-of-5\n    }\n    \n    const met = (difficulty === \"low\" || difficulty === \"medium\") \n      ? approveCount >= 2 \n      : approveCount >= 3;\n    \n    return { met, approveCount, rejectCount };\n  }\n\n  // Lock operations\n  async createLock(data: {\n    userId: string;\n    attemptId: string;\n    amount: string;\n    originalAmount: string;\n    cycleCreated: number;\n  }): Promise<Lock> {\n    const result = await db\n      .insert(locks)\n      .values({\n        ...data,\n        cyclesRemaining: 4,\n      })\n      .returning();\n    return result[0];\n  }\n\n  async getActiveLocks(userId?: string): Promise<Lock[]> {\n    let query = db.select().from(locks).where(sql`${locks.unlockedAt} IS NULL`);\n    if (userId) {\n      query = query.where(and(sql`${locks.unlockedAt} IS NULL`, eq(locks.userId, userId)));\n    }\n    return await query;\n  }\n\n  async unlockLocks(cycleNumber: number): Promise<void> {\n    await db\n      .update(locks)\n      .set({\n        unlockedAt: new Date(),\n        cyclesRemaining: 0,\n      })\n      .where(and(sql`${locks.unlockedAt} IS NULL`, sql`${locks.cycleCreated} + 4 <= ${cycleNumber}`));\n  }\n\n  // Model version operations\n  async getActiveModelVersion(): Promise<ModelVersion | undefined> {\n    const result = await db.select().from(modelVersions).where(eq(modelVersions.isActive, true)).limit(1);\n    return result[0];\n  }\n\n  async getAllModelVersions(): Promise<ModelVersion[]> {\n    return await db.select().from(modelVersions).orderBy(desc(modelVersions.versionNumber));\n  }\n\n  async createModelVersion(cycleId: string, datasetSize: number): Promise<ModelVersion> {\n    const latest = await db.select().from(modelVersions).orderBy(desc(modelVersions.versionNumber)).limit(1);\n    const versionNumber = latest[0] ? latest[0].versionNumber + 1 : 1;\n    \n    const result = await db.insert(modelVersions).values({ cycleId, datasetSize, versionNumber }).returning();\n    return result[0];\n  }\n\n  async activateModelVersion(versionId: string): Promise<ModelVersion> {\n    await this.deactivateAllModelVersions();\n    const result = await db\n      .update(modelVersions)\n      .set({ isActive: true, activatedAt: new Date() })\n      .where(eq(modelVersions.id, versionId))\n      .returning();\n    return result[0];\n  }\n\n  async deactivateAllModelVersions(): Promise<void> {\n    await db.update(modelVersions).set({ isActive: false });\n  }\n\n  // Benchmark operations\n  async createBenchmark(data: {\n    modelVersionId: string;\n    previousModelVersionId?: string;\n    score: string;\n    previousScore?: string;\n  }): Promise<Benchmark> {\n    const scoreDrop = data.previousScore\n      ? (parseFloat(data.previousScore) - parseFloat(data.score)).toString()\n      : null;\n    \n    const result = await db.insert(benchmarks).values({\n      ...data,\n      scoreDrop,\n      wasRolledBack: false,\n    }).returning();\n    return result[0];\n  }\n\n  async getLatestBenchmark(): Promise<Benchmark | undefined> {\n    const result = await db.select().from(benchmarks).orderBy(desc(benchmarks.createdAt)).limit(1);\n    return result[0];\n  }\n\n  async updateBenchmarkRollback(id: string, wasRolledBack: boolean, quarantinedCycleId?: string): Promise<Benchmark> {\n    const result = await db\n      .update(benchmarks)\n      .set({ wasRolledBack, quarantinedCycleId })\n      .where(eq(benchmarks.id, id))\n      .returning();\n    return result[0];\n  }\n\n  // Hub operations\n  async createHubPost(posterId: string, content: string, cycleId: string): Promise<HubPost> {\n    const result = await db.insert(hubPosts).values({ posterId, content, cycleId }).returning();\n    return result[0];\n  }\n\n  async getHubPosts(limit: number = 50): Promise<HubPost[]> {\n    return await db.select().from(hubPosts).orderBy(desc(hubPosts.createdAt)).limit(limit);\n  }\n\n  async createHubSubmission(userId: string, content: string, fee: string): Promise<HubSubmission> {\n    const result = await db.insert(hubSubmissions).values({ userId, content, fee, status: \"pending\" }).returning();\n    return result[0];\n  }\n\n  async getPendingHubSubmissions(): Promise<HubSubmission[]> {\n    return await db.select().from(hubSubmissions).where(eq(hubSubmissions.status, \"pending\")).orderBy(desc(hubSubmissions.createdAt));\n  }\n\n  async getHubSubmissionById(id: string): Promise<HubSubmission | undefined> {\n    const result = await db.select().from(hubSubmissions).where(eq(hubSubmissions.id, id)).limit(1);\n    return result[0];\n  }\n\n  async updateHubSubmissionStatus(id: string, status: \"approved\" | \"rejected\"): Promise<HubSubmission> {\n    const result = await db\n      .update(hubSubmissions)\n      .set({ status, reviewedAt: new Date() })\n      .where(eq(hubSubmissions.id, id))\n      .returning();\n    return result[0];\n  }\n\n  // Training pool operations\n  async getTrainingPoolAmount(): Promise<string> {\n    const result = await db.select().from(trainingPool).limit(1);\n    if (result.length === 0) {\n      await db.insert(trainingPool).values({ amount: \"0\" });\n      return \"0\";\n    }\n    return result[0].amount;\n  }\n\n  async addToTrainingPool(amount: string): Promise<void> {\n    const current = await this.getTrainingPoolAmount();\n    const newAmount = (parseFloat(current) + parseFloat(amount)).toString();\n    const existing = await db.select().from(trainingPool).limit(1);\n    if (existing.length > 0) {\n      await db.update(trainingPool).set({ amount: newAmount, updatedAt: new Date() });\n    } else {\n      await db.insert(trainingPool).values({ amount: newAmount });\n    }\n  }\n\n  async subtractFromTrainingPool(amount: string): Promise<void> {\n    const current = await this.getTrainingPoolAmount();\n    const newAmount = Math.max(0, parseFloat(current) - parseFloat(amount)).toString();\n    const existing = await db.select().from(trainingPool).limit(1);\n    if (existing.length > 0) {\n      await db.update(trainingPool).set({ amount: newAmount, updatedAt: new Date() });\n    } else {\n      await db.insert(trainingPool).values({ amount: newAmount });\n    }\n  }\n\n  // Training corpus operations\n  async getAllCorpusItems(): Promise<TrainingCorpusItem[]> {\n    return await db.select().from(trainingCorpusItems).orderBy(desc(trainingCorpusItems.createdAt));\n  }\n\n  async getCorpusItemsByTrack(trackId: string): Promise<TrainingCorpusItem[]> {\n    return await db.select().from(trainingCorpusItems).where(eq(trainingCorpusItems.trackId, trackId)).orderBy(desc(trainingCorpusItems.createdAt));\n  }\n\n  async addCorpusItem(data: {\n    trackId: string;\n    cycleId: string;\n    normalizedText: string;\n    sourceAttemptId?: string;\n  }): Promise<TrainingCorpusItem> {\n    const result = await db.insert(trainingCorpusItems).values({\n      trackId: data.trackId,\n      cycleId: data.cycleId,\n      normalizedText: data.normalizedText,\n      sourceAttemptId: data.sourceAttemptId,\n    }).returning();\n    return result[0];\n  }\n\n  async updateCorpusItem(id: string, normalizedText?: string, trackId?: string): Promise<TrainingCorpusItem | undefined> {\n    const updates: Partial<{ normalizedText: string; trackId: string }> = {};\n    if (normalizedText) updates.normalizedText = normalizedText;\n    if (trackId) updates.trackId = trackId;\n    \n    // Don't attempt update if no valid fields\n    if (Object.keys(updates).length === 0) {\n      return undefined;\n    }\n    \n    const result = await db\n      .update(trainingCorpusItems)\n      .set(updates)\n      .where(eq(trainingCorpusItems.id, id))\n      .returning();\n    return result[0];\n  }\n\n  async deleteCorpusItem(id: string): Promise<void> {\n    await db.delete(trainingCorpusItems).where(eq(trainingCorpusItems.id, id));\n  }\n\n  async getCorpusStats(): Promise<{ total: number; byTrack: Record<string, number> }> {\n    const allItems = await this.getAllCorpusItems();\n    const byTrack: Record<string, number> = {};\n    \n    for (const item of allItems) {\n      byTrack[item.trackId] = (byTrack[item.trackId] || 0) + 1;\n    }\n    \n    return {\n      total: allItems.length,\n      byTrack,\n    };\n  }\n\n  // Chat operations\n  async searchCorpusItems(query: string, trackId?: string, limit: number = 10): Promise<TrainingCorpusItem[]> {\n    const words = query.toLowerCase().split(/\\s+/).filter(w => w.length > 2);\n    if (words.length === 0) {\n      return [];\n    }\n    \n    // Get all items (optionally filtered by track) and search in memory\n    let items: TrainingCorpusItem[];\n    if (trackId) {\n      items = await this.getCorpusItemsByTrack(trackId);\n    } else {\n      items = await this.getAllCorpusItems();\n    }\n    \n    // Score items by keyword matches\n    const scored = items.map(item => {\n      const text = item.normalizedText.toLowerCase();\n      let score = 0;\n      for (const word of words) {\n        if (text.includes(word)) {\n          score += 1;\n        }\n      }\n      return { item, score };\n    }).filter(s => s.score > 0);\n    \n    // Sort by score descending and return top N\n    scored.sort((a, b) => b.score - a.score);\n    return scored.slice(0, limit).map(s => s.item);\n  }\n\n  async saveChatMessage(data: {\n    walletAddress: string;\n    trackId?: string;\n    aiLevel: number;\n    userMessage: string;\n    aiResponse: string;\n    corpusItemsUsed?: string[];\n  }): Promise<ChatMessage> {\n    const result = await db.insert(chatMessages).values({\n      walletAddress: data.walletAddress,\n      trackId: data.trackId || null,\n      aiLevel: data.aiLevel,\n      userMessage: data.userMessage,\n      aiResponse: data.aiResponse,\n      corpusItemsUsed: data.corpusItemsUsed || [],\n    }).returning();\n    return result[0];\n  }\n\n  async getChatHistory(walletAddress: string, limit: number = 50): Promise<ChatMessage[]> {\n    return await db\n      .select()\n      .from(chatMessages)\n      .where(eq(chatMessages.walletAddress, walletAddress))\n      .orderBy(desc(chatMessages.createdAt))\n      .limit(limit);\n  }\n}\n\nexport const storage = new DbStorage();\n","path":null,"size_bytes":23538,"size_tokens":null},"client/src/components/game/AIAvatar.tsx":{"content":"import { getSkinEmoji, getSkinCaption, getSkinClass, getAuraClass } from \"@/lib/cosmetics\";\n\ninterface AIAvatarProps {\n  intelligenceLevel: number;\n  equippedSkin: string;\n  equippedAura: string | null;\n  size?: \"sm\" | \"md\" | \"lg\";\n}\n\nexport default function AIAvatar({\n  intelligenceLevel,\n  equippedSkin,\n  equippedAura,\n  size = \"lg\",\n}: AIAvatarProps) {\n  const emoji = getSkinEmoji(equippedSkin, intelligenceLevel);\n  const caption = getSkinCaption(equippedSkin, intelligenceLevel);\n  const skinClass = getSkinClass(equippedSkin);\n  const auraClass = getAuraClass(equippedAura);\n\n  const sizeClasses = {\n    sm: \"w-16 h-16\",\n    md: \"w-24 h-24\",\n    lg: \"w-28 h-28 sm:w-32 sm:h-32\",\n  };\n\n  const emojiSizes = {\n    sm: \"text-3xl\",\n    md: \"text-4xl\",\n    lg: \"text-5xl sm:text-6xl\",\n  };\n\n  return (\n    <div className=\"flex flex-col items-center gap-3\" data-testid=\"ai-avatar-container\">\n      <div\n        className={`${sizeClasses[size]} rounded-full relative flex items-center justify-center ${skinClass} ${auraClass}`}\n        data-testid=\"ai-avatar-circle\"\n      >\n        <div className=\"absolute inset-0 rounded-full bg-gradient-to-br from-primary/30 via-primary/10 to-transparent animate-pulse\" />\n        <div className=\"absolute inset-1 rounded-full bg-gradient-to-br from-primary/20 to-transparent\" />\n        <span\n          className={`${emojiSizes[size]} relative z-10`}\n          data-testid=\"ai-avatar-emoji\"\n          role=\"img\"\n          aria-label=\"AI Avatar\"\n        >\n          {emoji}\n        </span>\n      </div>\n      <span className=\"text-xs text-muted-foreground uppercase tracking-wider\" data-testid=\"ai-avatar-caption\">\n        {caption}\n      </span>\n    </div>\n  );\n}\n","path":null,"size_bytes":1705,"size_tokens":null},"client/src/components/ui/breadcrumb.tsx":{"content":"import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Breadcrumb = React.forwardRef<\n  HTMLElement,\n  React.ComponentPropsWithoutRef<\"nav\"> & {\n    separator?: React.ReactNode\n  }\n>(({ ...props }, ref) => <nav ref={ref} aria-label=\"breadcrumb\" {...props} />)\nBreadcrumb.displayName = \"Breadcrumb\"\n\nconst BreadcrumbList = React.forwardRef<\n  HTMLOListElement,\n  React.ComponentPropsWithoutRef<\"ol\">\n>(({ className, ...props }, ref) => (\n  <ol\n    ref={ref}\n    className={cn(\n      \"flex flex-wrap items-center gap-1.5 break-words text-sm text-muted-foreground sm:gap-2.5\",\n      className\n    )}\n    {...props}\n  />\n))\nBreadcrumbList.displayName = \"BreadcrumbList\"\n\nconst BreadcrumbItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentPropsWithoutRef<\"li\">\n>(({ className, ...props }, ref) => (\n  <li\n    ref={ref}\n    className={cn(\"inline-flex items-center gap-1.5\", className)}\n    {...props}\n  />\n))\nBreadcrumbItem.displayName = \"BreadcrumbItem\"\n\nconst BreadcrumbLink = React.forwardRef<\n  HTMLAnchorElement,\n  React.ComponentPropsWithoutRef<\"a\"> & {\n    asChild?: boolean\n  }\n>(({ asChild, className, ...props }, ref) => {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      ref={ref}\n      className={cn(\"transition-colors hover:text-foreground\", className)}\n      {...props}\n    />\n  )\n})\nBreadcrumbLink.displayName = \"BreadcrumbLink\"\n\nconst BreadcrumbPage = React.forwardRef<\n  HTMLSpanElement,\n  React.ComponentPropsWithoutRef<\"span\">\n>(({ className, ...props }, ref) => (\n  <span\n    ref={ref}\n    role=\"link\"\n    aria-disabled=\"true\"\n    aria-current=\"page\"\n    className={cn(\"font-normal text-foreground\", className)}\n    {...props}\n  />\n))\nBreadcrumbPage.displayName = \"BreadcrumbPage\"\n\nconst BreadcrumbSeparator = ({\n  children,\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) => (\n  <li\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"[&>svg]:w-3.5 [&>svg]:h-3.5\", className)}\n    {...props}\n  >\n    {children ?? <ChevronRight />}\n  </li>\n)\nBreadcrumbSeparator.displayName = \"BreadcrumbSeparator\"\n\nconst BreadcrumbEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    role=\"presentation\"\n    aria-hidden=\"true\"\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More</span>\n  </span>\n)\nBreadcrumbEllipsis.displayName = \"BreadcrumbElipssis\"\n\nexport {\n  Breadcrumb,\n  BreadcrumbList,\n  BreadcrumbItem,\n  BreadcrumbLink,\n  BreadcrumbPage,\n  BreadcrumbSeparator,\n  BreadcrumbEllipsis,\n}\n","path":null,"size_bytes":2712,"size_tokens":null},"client/src/components/game/TopBar.tsx":{"content":"import { CheckCircle, AlertTriangle, AlertCircle, ExternalLink } from \"lucide-react\";\nimport WalletButton from \"./WalletButton\";\nimport SettingsPanel from \"./SettingsPanel\";\nimport { MINIMUM_TOKENS_REQUIRED, MEME_TOKEN_MINT, isPhantomInstalled } from \"@/lib/solanaWallet\";\n\ninterface TopBarProps {\n  walletAddress: string | null;\n  tokenBalance: number;\n  isLoadingBalance: boolean;\n  onWalletConnect: (address: string) => void;\n  onWalletDisconnect: () => void;\n  onResetProgress: () => void;\n  onGateStatusChange?: (hasAccess: boolean) => void;\n  hasHiveAccess?: boolean;\n  requiredHiveAmount?: number;\n}\n\nconst PLACEHOLDER_MINT = \"MEMExxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\";\n\nexport default function TopBar({\n  walletAddress,\n  tokenBalance,\n  isLoadingBalance,\n  onWalletConnect,\n  onWalletDisconnect,\n  onResetProgress,\n  onGateStatusChange,\n  hasHiveAccess = false,\n  requiredHiveAmount = 50,\n}: TopBarProps) {\n  const isConnected = !!walletAddress;\n  const hasEnoughTokens = tokenBalance >= MINIMUM_TOKENS_REQUIRED;\n  const phantomInstalled = isPhantomInstalled();\n  const isDemoMode = MEME_TOKEN_MINT === PLACEHOLDER_MINT;\n\n  return (\n    <div className=\"space-y-3 pb-4 border-b border-border/30\" data-testid=\"top-bar\">\n      <div className=\"flex items-start justify-between gap-2 flex-wrap\">\n        <div className=\"space-y-0.5 min-w-0 flex-1\">\n          <div className=\"flex items-center gap-2\">\n            <h1 className=\"text-lg sm:text-2xl font-bold text-foreground truncate\" data-testid=\"text-app-title\">\n              Train Your AI\n            </h1>\n            <SettingsPanel onResetProgress={onResetProgress} />\n          </div>\n          <p className=\"text-xs text-muted-foreground hidden sm:block\">\n            Answer questions to make your AI smarter\n          </p>\n        </div>\n        <WalletButton\n          connectedAddress={walletAddress}\n          onConnect={onWalletConnect}\n          onDisconnect={onWalletDisconnect}\n          onGateStatusChange={onGateStatusChange}\n        />\n      </div>\n\n      {!phantomInstalled && !isConnected && (\n        <div\n          className=\"flex items-center gap-2 text-xs px-3 py-2 rounded-md bg-warning/10 text-warning\"\n          data-testid=\"phantom-not-installed\"\n        >\n          <AlertCircle className=\"w-4 h-4 shrink-0\" />\n          <div className=\"flex-1\">\n            <span>Phantom wallet not detected. </span>\n            <a\n              href=\"https://phantom.app/\"\n              target=\"_blank\"\n              rel=\"noopener noreferrer\"\n              className=\"inline-flex items-center gap-1 underline\"\n            >\n              Install it\n              <ExternalLink className=\"w-3 h-3\" />\n            </a>\n            <span> to use token-gated training.</span>\n          </div>\n        </div>\n      )}\n\n      {isDemoMode && (\n        <div\n          className=\"flex items-center gap-2 text-xs px-3 py-2 rounded-md bg-yellow-500/10 text-yellow-400\"\n          data-testid=\"demo-mode-badge\"\n        >\n          <AlertTriangle className=\"w-4 h-4 shrink-0\" />\n          <span>Token checks are in demo mode. Real mint address not configured yet.</span>\n        </div>\n      )}\n\n      {isConnected && !isLoadingBalance && (\n        <div\n          className={`flex items-center gap-2 text-xs px-3 py-1.5 rounded-md w-fit ${\n            hasHiveAccess\n              ? \"bg-success/10 text-success\"\n              : \"bg-destructive/10 text-destructive\"\n          }`}\n          data-testid=\"hive-access-badge\"\n        >\n          {hasHiveAccess ? (\n            <>\n              <CheckCircle className=\"w-3.5 h-3.5\" />\n              <span>You have access ({requiredHiveAmount}+ $HIVE)</span>\n            </>\n          ) : (\n            <>\n              <AlertTriangle className=\"w-3.5 h-3.5\" />\n              <span>Need {requiredHiveAmount}+ $HIVE to access protected features</span>\n            </>\n          )}\n        </div>\n      )}\n\n      {isConnected && isLoadingBalance && (\n        <div className=\"flex items-center gap-2 text-xs px-3 py-1.5 rounded-md bg-muted/30 text-muted-foreground w-fit\">\n          <div className=\"w-3 h-3 border-2 border-current border-t-transparent rounded-full animate-spin\" />\n          <span>Checking token balance...</span>\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":4270,"size_tokens":null},"client/src/components/ui/progress.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as ProgressPrimitive from \"@radix-ui/react-progress\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Progress = React.forwardRef<\n  React.ElementRef<typeof ProgressPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ProgressPrimitive.Root>\n>(({ className, value, ...props }, ref) => (\n  <ProgressPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative h-4 w-full overflow-hidden rounded-full bg-secondary\",\n      className\n    )}\n    {...props}\n  >\n    <ProgressPrimitive.Indicator\n      className=\"h-full w-full flex-1 bg-primary transition-all\"\n      style={{ transform: `translateX(-${100 - (value || 0)}%)` }}\n    />\n  </ProgressPrimitive.Root>\n))\nProgress.displayName = ProgressPrimitive.Root.displayName\n\nexport { Progress }\n","path":null,"size_bytes":791,"size_tokens":null},"client/src/components/ui/scroll-area.tsx":{"content":"import * as React from \"react\"\nimport * as ScrollAreaPrimitive from \"@radix-ui/react-scroll-area\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ScrollArea = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <ScrollAreaPrimitive.Root\n    ref={ref}\n    className={cn(\"relative overflow-hidden\", className)}\n    {...props}\n  >\n    <ScrollAreaPrimitive.Viewport className=\"h-full w-full rounded-[inherit]\">\n      {children}\n    </ScrollAreaPrimitive.Viewport>\n    <ScrollBar />\n    <ScrollAreaPrimitive.Corner />\n  </ScrollAreaPrimitive.Root>\n))\nScrollArea.displayName = ScrollAreaPrimitive.Root.displayName\n\nconst ScrollBar = React.forwardRef<\n  React.ElementRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>,\n  React.ComponentPropsWithoutRef<typeof ScrollAreaPrimitive.ScrollAreaScrollbar>\n>(({ className, orientation = \"vertical\", ...props }, ref) => (\n  <ScrollAreaPrimitive.ScrollAreaScrollbar\n    ref={ref}\n    orientation={orientation}\n    className={cn(\n      \"flex touch-none select-none transition-colors\",\n      orientation === \"vertical\" &&\n        \"h-full w-2.5 border-l border-l-transparent p-[1px]\",\n      orientation === \"horizontal\" &&\n        \"h-2.5 flex-col border-t border-t-transparent p-[1px]\",\n      className\n    )}\n    {...props}\n  >\n    <ScrollAreaPrimitive.ScrollAreaThumb className=\"relative flex-1 rounded-full bg-border\" />\n  </ScrollAreaPrimitive.ScrollAreaScrollbar>\n))\nScrollBar.displayName = ScrollAreaPrimitive.ScrollAreaScrollbar.displayName\n\nexport { ScrollArea, ScrollBar }\n","path":null,"size_bytes":1642,"size_tokens":null},"script/build.ts":{"content":"import { build as esbuild } from \"esbuild\";\nimport { build as viteBuild } from \"vite\";\nimport { rm, readFile } from \"fs/promises\";\n\n// server deps to bundle to reduce openat(2) syscalls\n// which helps cold start times\nconst allowlist = [\n  \"@google/generative-ai\",\n  \"axios\",\n  \"connect-pg-simple\",\n  \"cors\",\n  \"date-fns\",\n  \"drizzle-orm\",\n  \"drizzle-zod\",\n  \"express\",\n  \"express-rate-limit\",\n  \"express-session\",\n  \"jsonwebtoken\",\n  \"memorystore\",\n  \"multer\",\n  \"nanoid\",\n  \"nodemailer\",\n  \"openai\",\n  \"passport\",\n  \"passport-local\",\n  \"pg\",\n  \"stripe\",\n  \"uuid\",\n  \"ws\",\n  \"xlsx\",\n  \"zod\",\n  \"zod-validation-error\",\n];\n\nasync function buildAll() {\n  await rm(\"dist\", { recursive: true, force: true });\n\n  console.log(\"building client...\");\n  await viteBuild();\n\n  console.log(\"building server...\");\n  const pkg = JSON.parse(await readFile(\"package.json\", \"utf-8\"));\n  const allDeps = [\n    ...Object.keys(pkg.dependencies || {}),\n    ...Object.keys(pkg.devDependencies || {}),\n  ];\n  const externals = allDeps.filter((dep) => !allowlist.includes(dep));\n\n  await esbuild({\n    entryPoints: [\"server/index.ts\"],\n    platform: \"node\",\n    bundle: true,\n    format: \"cjs\",\n    outfile: \"dist/index.cjs\",\n    define: {\n      \"process.env.NODE_ENV\": '\"production\"',\n    },\n    minify: true,\n    external: externals,\n    logLevel: \"info\",\n  });\n}\n\nbuildAll().catch((err) => {\n  console.error(err);\n  process.exit(1);\n});\n","path":null,"size_bytes":1417,"size_tokens":null},"client/src/components/ui/slider.tsx":{"content":"import * as React from \"react\"\nimport * as SliderPrimitive from \"@radix-ui/react-slider\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Slider = React.forwardRef<\n  React.ElementRef<typeof SliderPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SliderPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <SliderPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative flex w-full touch-none select-none items-center\",\n      className\n    )}\n    {...props}\n  >\n    <SliderPrimitive.Track className=\"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary\">\n      <SliderPrimitive.Range className=\"absolute h-full bg-primary\" />\n    </SliderPrimitive.Track>\n    <SliderPrimitive.Thumb className=\"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50\" />\n  </SliderPrimitive.Root>\n))\nSlider.displayName = SliderPrimitive.Root.displayName\n\nexport { Slider }\n","path":null,"size_bytes":1077,"size_tokens":null},"design_guidelines.md":{"content":"# Design Guidelines: Train Your AI Game\n\n## Design Approach\n\n**Reference-Based with Gaming Elements**\nDrawing inspiration from gamified learning apps (Duolingo, Habitica) combined with modern dark interfaces (Linear, Discord). The design should feel playful yet sophisticated, with clear feedback systems and rewarding progression indicators.\n\n**Core Principles:**\n- Gamification-first: Make progress feel tangible and rewarding\n- Clarity over decoration: Every element serves gameplay understanding\n- Personality through restraint: Let emojis and messaging carry character, keep UI clean\n\n---\n\n## Typography\n\n**Font Stack:**\n- Primary: 'Inter' or 'DM Sans' from Google Fonts - clean, modern sans-serif\n- Fallback: system-ui, -apple-system, sans-serif\n\n**Hierarchy:**\n- App Title: 2.5rem (40px), bold (700)\n- Screen Headings: 1.75rem (28px), semibold (600)\n- Stats Labels: 0.875rem (14px), medium (500), uppercase, letter-spacing: 0.05em\n- Stat Values: 1.5rem (24px), bold (700)\n- Question Text: 1.25rem (20px), medium (500)\n- Body/Captions: 1rem (16px), regular (400)\n- Small Text: 0.875rem (14px), regular (400)\n\n---\n\n## Layout System\n\n**Spacing Units (Tailwind-equivalent):**\nPrimary spacing set: 4, 6, 8, 12, 16, 24 (in px: 16, 24, 32, 48, 64, 96)\n\n**Container:**\n- Max-width: 560px (between specified 480-600px)\n- Padding: 32px desktop, 24px mobile\n- Centered with auto margins\n\n**Card Structure:**\n- Border-radius: 16px (rounded-2xl)\n- Box-shadow: 0 20px 50px rgba(0, 0, 0, 0.4) - prominent shadow for dark theme\n- Inner padding: 48px desktop, 32px mobile\n\n---\n\n## Component Library\n\n### Home Screen Components\n\n**AI Avatar Display:**\n- Large emoji size: 80px (use font-size, not image)\n- Container: circular background (120px diameter), subtle gradient or solid fill\n- Caption below: small text, muted opacity (0.7)\n- Spacing: 48px margin below avatar area\n\n**Stats Grid:**\n- 2x2 grid layout on desktop, stack on mobile\n- Each stat card: 16px padding, subtle border (1px, opacity 0.1)\n- Stat label above value, centered text\n- 12px gap between cards\n\n**Scoring Rules Section:**\n- Light background panel (slightly lighter than main card)\n- 16px padding, 8px border-radius\n- Bullet points with icon indicators (✓ for good, → for neutral, ✗ for bad)\n\n**Primary CTA Button:**\n- Full-width or prominent centered\n- Height: 56px\n- Font-size: 1.125rem (18px), semibold\n- Border-radius: 12px\n- Gradient background or solid with glow effect on hover\n\n### Training Screen Components\n\n**Progress Header:**\n- Sticky or fixed at top of card\n- Progress bar: full-width, 6px height, rounded ends\n- Question counter: bold, larger text\n- 24px spacing below header\n\n**Question Card:**\n- Clear visual separation from options\n- Minimum height to prevent layout shift\n- 32px padding\n- Subtle background differentiation\n\n**Answer Options:**\n- Full-width buttons, stacked vertically\n- Height: 64px minimum for touch targets\n- 12px gap between options\n- Border: 2px solid, changes on hover/selected\n- Border-radius: 8px\n- Left-aligned text with 16px padding\n- Hover state: slight scale (1.02) and border brightness increase\n- Selected/locked state: distinct visual (filled background)\n\n**Score Tracker:**\n- Top-right corner position or below progress\n- Small, unobtrusive but visible\n- 8px padding, subtle border\n\n### Result Screen Components\n\n**Results Header:**\n- Large, celebratory or neutral based on outcome\n- 48px spacing below\n\n**Score Display:**\n- Large percentage: 3rem (48px), extra bold\n- \"X / 10 Correct\" below in smaller text\n- Circular progress ring (optional visual flourish)\n\n**Before/After Stats Comparison:**\n- Side-by-side layout with arrow between\n- Each stat: previous value → new value\n- Use subtle color coding (growth/decline/same)\n- 24px spacing between stat rows\n\n**Outcome Message:**\n- Prominent card or banner\n- Icon/emoji reflecting outcome\n- Message text: 1.125rem, centered\n- Background tint based on result (subtle)\n\n**Action Buttons:**\n- Two-button layout: secondary style + primary style\n- Stack on mobile, side-by-side on desktop\n- 12px gap between buttons\n- Each button: 48px height\n\n---\n\n## Visual Treatment\n\n**Dark Theme Palette (structure only, no specific colors to be defined):**\n- Page background: Very dark\n- Card background: Dark but lighter than page\n- Text: High contrast light\n- Muted text: Medium opacity\n- Borders: Low opacity light\n- Button backgrounds: Will be defined separately\n- Success/neutral/warning states: Will be defined separately\n\n**Borders & Dividers:**\n- Use sparingly, 1px width\n- Low opacity (0.1-0.15) for subtle separation\n- Border-radius on all interactive elements (minimum 8px)\n\n---\n\n## Interaction Design\n\n**State Transitions:**\n- Fade-in/out between screens: 200ms ease-in-out\n- Button hover: 150ms transition on all properties\n- Answer lock: 100ms scale down effect\n\n**Feedback:**\n- Button clicks: slight scale down (0.98)\n- Progress updates: smooth width transition (300ms)\n- No distracting animations between questions - instant transitions\n\n**Micro-interactions:**\n- Selected answer: immediate visual feedback\n- Stat updates on result screen: count-up animation (500ms) optional\n- Level-up celebration: brief scale pulse on new level badge\n\n---\n\n## Responsive Behavior\n\n**Breakpoint:**\n- Mobile: < 640px\n- Desktop: ≥ 640px\n\n**Mobile Adjustments:**\n- Reduce font sizes by 10-15%\n- Stack all horizontal layouts vertically\n- Reduce container padding to 24px\n- Full-width buttons\n- Smaller avatar (64px)\n\n**Touch Targets:**\n- Minimum 48px height for all interactive elements\n- Adequate spacing (12px minimum) between tappable items\n\n---\n\n## Accessibility\n\n- Maintain 4.5:1 contrast ratio minimum for all text\n- Focus states: 2px outline, high-contrast color, 2px offset\n- Use semantic HTML elements throughout\n- Ensure all interactive elements have focus states\n- Labels for all stats and data points\n\n---\n\n## Images\n\n**No Hero Image Required**\n\nThis is a functional game interface, not a marketing page. Visual interest comes from:\n- Emoji-based AI avatar (rendered as text/font, not image)\n- Clean typography and spacing\n- Stat displays and progress indicators\n- Game state feedback\n\nIf decorative elements are desired:\n- Subtle gradient overlays on card backgrounds\n- Abstract geometric patterns in page background (very subtle, low opacity)\n- These should enhance, not distract from gameplay","path":null,"size_bytes":6360,"size_tokens":null},"client/src/index.css":{"content":"@tailwind base;\n@tailwind components;\n@tailwind utilities;\n\n/* LIGHT MODE */\n:root {\n  --button-outline: rgba(0,0,0, .10);\n  --badge-outline: rgba(0,0,0, .05);\n  --opaque-button-border-intensity: -8;\n  --elevate-1: rgba(0,0,0, .03);\n  --elevate-2: rgba(0,0,0, .08);\n  --background: 220 10% 98%;\n  --foreground: 220 10% 12%;\n  --border: 220 10% 88%;\n  --card: 220 10% 96%;\n  --card-foreground: 220 10% 12%;\n  --card-border: 220 10% 92%;\n  --sidebar: 220 10% 94%;\n  --sidebar-foreground: 220 10% 12%;\n  --sidebar-border: 220 10% 88%;\n  --sidebar-primary: 217 91% 45%;\n  --sidebar-primary-foreground: 217 91% 98%;\n  --sidebar-accent: 220 12% 88%;\n  --sidebar-accent-foreground: 220 12% 18%;\n  --sidebar-ring: 217 91% 45%;\n  --popover: 220 10% 92%;\n  --popover-foreground: 220 10% 12%;\n  --popover-border: 220 10% 86%;\n  --primary: 217 91% 45%;\n  --primary-foreground: 217 91% 98%;\n  --secondary: 220 12% 88%;\n  --secondary-foreground: 220 12% 18%;\n  --muted: 220 12% 90%;\n  --muted-foreground: 220 12% 35%;\n  --accent: 220 15% 92%;\n  --accent-foreground: 220 15% 18%;\n  --destructive: 0 84% 48%;\n  --destructive-foreground: 0 84% 98%;\n  --input: 220 10% 75%;\n  --ring: 217 91% 45%;\n  --chart-1: 217 91% 45%;\n  --chart-2: 195 75% 42%;\n  --chart-3: 155 65% 38%;\n  --chart-4: 48 85% 48%;\n  --chart-5: 280 70% 52%;\n  --font-sans: 'DM Sans', system-ui, -apple-system, sans-serif;\n  --font-serif: Georgia, serif;\n  --font-mono: 'JetBrains Mono', Menlo, monospace;\n  --success: 142 70% 45%;\n  --success-foreground: 142 70% 98%;\n  --warning: 38 92% 50%;\n  --warning-foreground: 38 92% 10%;\n  --radius: .5rem;\n  --shadow-2xs: 0px 2px 0px 0px hsl(220 10% 12% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(220 10% 12% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(220 10% 12% / 0.00), 0px 1px 2px -1px hsl(220 10% 12% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(220 10% 12% / 0.00), 0px 1px 2px -1px hsl(220 10% 12% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(220 10% 12% / 0.00), 0px 2px 4px -1px hsl(220 10% 12% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(220 10% 12% / 0.00), 0px 4px 6px -1px hsl(220 10% 12% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(220 10% 12% / 0.00), 0px 8px 10px -1px hsl(220 10% 12% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(220 10% 12% / 0.00);\n  --tracking-normal: 0em;\n  --spacing: 0.25rem;\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n.dark {\n  --button-outline: rgba(255,255,255, .10);\n  --badge-outline: rgba(255,255,255, .05);\n  --opaque-button-border-intensity: 9;\n  --elevate-1: rgba(255,255,255, .04);\n  --elevate-2: rgba(255,255,255, .09);\n  --background: 240 20% 6%;\n  --foreground: 220 15% 95%;\n  --border: 240 15% 20%;\n  --card: 235 25% 7%;\n  --card-foreground: 220 15% 95%;\n  --card-border: 240 20% 15%;\n  --success: 142 70% 50%;\n  --success-foreground: 142 70% 98%;\n  --warning: 38 92% 55%;\n  --warning-foreground: 38 92% 10%;\n  --glow-primary: 217 91% 60%;\n  --glow-secondary: 280 80% 55%;\n  --sidebar: 220 8% 12%;\n  --sidebar-foreground: 220 8% 95%;\n  --sidebar-border: 220 8% 16%;\n  --sidebar-primary: 217 91% 55%;\n  --sidebar-primary-foreground: 217 91% 98%;\n  --sidebar-accent: 220 10% 16%;\n  --sidebar-accent-foreground: 220 10% 92%;\n  --sidebar-ring: 217 91% 55%;\n  --popover: 220 8% 14%;\n  --popover-foreground: 220 8% 95%;\n  --popover-border: 220 8% 18%;\n  --primary: 217 91% 55%;\n  --primary-foreground: 217 91% 98%;\n  --secondary: 220 10% 18%;\n  --secondary-foreground: 220 10% 92%;\n  --muted: 220 10% 16%;\n  --muted-foreground: 220 10% 65%;\n  --accent: 220 12% 16%;\n  --accent-foreground: 220 12% 92%;\n  --destructive: 0 84% 52%;\n  --destructive-foreground: 0 84% 98%;\n  --input: 220 8% 28%;\n  --ring: 217 91% 55%;\n  --chart-1: 217 91% 65%;\n  --chart-2: 195 75% 62%;\n  --chart-3: 155 65% 58%;\n  --chart-4: 48 85% 68%;\n  --chart-5: 280 70% 72%;\n  --shadow-2xs: 0px 2px 0px 0px hsl(220 8% 95% / 0.00);\n  --shadow-xs: 0px 2px 0px 0px hsl(220 8% 95% / 0.00);\n  --shadow-sm: 0px 2px 0px 0px hsl(220 8% 95% / 0.00), 0px 1px 2px -1px hsl(220 8% 95% / 0.00);\n  --shadow: 0px 2px 0px 0px hsl(220 8% 95% / 0.00), 0px 1px 2px -1px hsl(220 8% 95% / 0.00);\n  --shadow-md: 0px 2px 0px 0px hsl(220 8% 95% / 0.00), 0px 2px 4px -1px hsl(220 8% 95% / 0.00);\n  --shadow-lg: 0px 2px 0px 0px hsl(220 8% 95% / 0.00), 0px 4px 6px -1px hsl(220 8% 95% / 0.00);\n  --shadow-xl: 0px 2px 0px 0px hsl(220 8% 95% / 0.00), 0px 8px 10px -1px hsl(220 8% 95% / 0.00);\n  --shadow-2xl: 0px 2px 0px 0px hsl(220 8% 95% / 0.00);\n\n/* Fallback for older browsers */\n  --sidebar-primary-border: hsl(var(--sidebar-primary));\n  --sidebar-primary-border: hsl(from hsl(var(--sidebar-primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --sidebar-accent-border: hsl(var(--sidebar-accent));\n  --sidebar-accent-border: hsl(from hsl(var(--sidebar-accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --primary-border: hsl(var(--primary));\n  --primary-border: hsl(from hsl(var(--primary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --secondary-border: hsl(var(--secondary));\n  --secondary-border: hsl(from hsl(var(--secondary)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --muted-border: hsl(var(--muted));\n  --muted-border: hsl(from hsl(var(--muted)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --accent-border: hsl(var(--accent));\n  --accent-border: hsl(from hsl(var(--accent)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n\n  /* Fallback for older browsers */\n  --destructive-border: hsl(var(--destructive));\n  --destructive-border: hsl(from hsl(var(--destructive)) h s calc(l + var(--opaque-button-border-intensity)) / alpha);\n}\n\n@layer base {\n  * {\n    @apply border-border;\n  }\n\n  body {\n    @apply font-sans antialiased bg-background text-foreground;\n  }\n}\n\n/**\n * Using the elevate system.\n * Automatic contrast adjustment.\n *\n * <element className=\"hover-elevate\" />\n * <element className=\"active-elevate-2\" />\n *\n * // Using the tailwind utility when a data attribute is \"on\"\n * <element className=\"toggle-elevate data-[state=on]:toggle-elevated\" />\n * // Or manually controlling the toggle state\n * <element className=\"toggle-elevate toggle-elevated\" />\n *\n * Elevation systems have to handle many states.\n * - not-hovered, vs. hovered vs. active  (three mutually exclusive states)\n * - toggled or not\n * - focused or not (this is not handled with these utilities)\n *\n * Even without handling focused or not, this is six possible combinations that\n * need to be distinguished from eachother visually.\n */\n@layer utilities {\n\n  /* Hide ugly search cancel button in Chrome until we can style it properly */\n  input[type=\"search\"]::-webkit-search-cancel-button {\n    @apply hidden;\n  }\n\n  /* Placeholder styling for contentEditable div */\n  [contenteditable][data-placeholder]:empty::before {\n    content: attr(data-placeholder);\n    color: hsl(var(--muted-foreground));\n    pointer-events: none;\n  }\n\n  /* .no-default-hover-elevate/no-default-active-elevate is an escape hatch so consumers of\n   * buttons/badges can remove the automatic brightness adjustment on interactions\n   * and program their own. */\n  .no-default-hover-elevate {}\n\n  .no-default-active-elevate {}\n\n\n  /**\n   * Toggleable backgrounds go behind the content. Hoverable/active goes on top.\n   * This way they can stack/compound. Both will overlap the parent's borders!\n   * So borders will be automatically adjusted both on toggle, and hover/active,\n   * and they will be compounded.\n   */\n  .toggle-elevate::before,\n  .toggle-elevate-2::before {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: -1;\n    /* sits behind content but above backdrop */\n  }\n\n  .toggle-elevate.toggle-elevated::before {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.toggle-elevate::before {\n    inset: -1px;\n  }\n\n  /* Does not work on elements with overflow:hidden! */\n  .hover-elevate:not(.no-default-hover-elevate),\n  .active-elevate:not(.no-default-active-elevate),\n  .hover-elevate-2:not(.no-default-hover-elevate),\n  .active-elevate-2:not(.no-default-active-elevate) {\n    position: relative;\n    z-index: 0;\n  }\n\n  .hover-elevate:not(.no-default-hover-elevate)::after,\n  .active-elevate:not(.no-default-active-elevate)::after,\n  .hover-elevate-2:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:not(.no-default-active-elevate)::after {\n    content: \"\";\n    pointer-events: none;\n    position: absolute;\n    inset: 0px;\n    /*border-radius: inherit;   match rounded corners */\n    border-radius: inherit;\n    z-index: 999;\n    /* sits in front of content */\n  }\n\n  .hover-elevate:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-1);\n  }\n\n  .hover-elevate-2:hover:not(.no-default-hover-elevate)::after,\n  .active-elevate-2:active:not(.no-default-active-elevate)::after {\n    background-color: var(--elevate-2);\n  }\n\n  /* If there's a 1px border, adjust the inset so that it covers that parent's border */\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate-2:not(.no-hover-interaction-elevate)::after,\n  .border.active-elevate-2:not(.no-active-interaction-elevate)::after,\n  .border.hover-elevate:not(.no-hover-interaction-elevate)::after {\n    inset: -1px;\n  }\n}\n\n/* Cosmetic Aura Styles - Outside layers for proper specificity */\n.aura-blue {\n  box-shadow: 0 0 25px 8px rgba(59, 130, 246, 0.5), 0 0 50px 12px rgba(59, 130, 246, 0.25) !important;\n}\n\n.aura-purple {\n  box-shadow: 0 0 25px 8px rgba(168, 85, 247, 0.5), 0 0 50px 12px rgba(168, 85, 247, 0.25) !important;\n}\n\n.aura-green {\n  box-shadow: 0 0 25px 8px rgba(34, 197, 94, 0.5), 0 0 50px 12px rgba(34, 197, 94, 0.25) !important;\n}\n\n/* Cosmetic Skin Styles */\n.skin-glitched {\n  animation: glitch 0.3s infinite !important;\n}\n\n@keyframes glitch {\n  0%, 100% {\n    transform: translate(0);\n    filter: none;\n  }\n  20% {\n    transform: translate(-2px, 1px);\n    filter: hue-rotate(90deg);\n  }\n  40% {\n    transform: translate(2px, -1px);\n    filter: hue-rotate(-90deg);\n  }\n  60% {\n    transform: translate(-1px, -1px);\n    filter: saturate(2);\n  }\n  80% {\n    transform: translate(1px, 1px);\n    filter: brightness(1.2);\n  }\n}\n\n.skin-overclocked {\n  animation: overheat 1.5s ease-in-out infinite !important;\n  box-shadow: 0 0 20px 5px rgba(251, 146, 60, 0.6), inset 0 0 15px rgba(251, 146, 60, 0.3) !important;\n}\n\n@keyframes overheat {\n  0%, 100% {\n    filter: brightness(1) saturate(1);\n    box-shadow: 0 0 20px 5px rgba(251, 146, 60, 0.6), inset 0 0 15px rgba(251, 146, 60, 0.3);\n  }\n  50% {\n    filter: brightness(1.2) saturate(1.3);\n    box-shadow: 0 0 30px 10px rgba(239, 68, 68, 0.7), inset 0 0 20px rgba(239, 68, 68, 0.4);\n  }\n}\n\n/* Mobile Responsiveness */\n@media (max-width: 640px) {\n  html {\n    font-size: 15px;\n  }\n  \n  /* Ensure buttons are easily tappable */\n  button {\n    min-height: 44px;\n  }\n  \n  /* Exception for icon buttons and small buttons */\n  button[data-size=\"icon\"],\n  button[data-size=\"sm\"] {\n    min-height: auto;\n  }\n}\n","path":null,"size_bytes":12851,"size_tokens":null},"client/src/components/ui/aspect-ratio.tsx":{"content":"import * as AspectRatioPrimitive from \"@radix-ui/react-aspect-ratio\"\n\nconst AspectRatio = AspectRatioPrimitive.Root\n\nexport { AspectRatio }\n","path":null,"size_bytes":140,"size_tokens":null},"client/src/hooks/use-mobile.tsx":{"content":"import * as React from \"react\"\n\nconst MOBILE_BREAKPOINT = 768\n\nexport function useIsMobile() {\n  const [isMobile, setIsMobile] = React.useState<boolean | undefined>(undefined)\n\n  React.useEffect(() => {\n    const mql = window.matchMedia(`(max-width: ${MOBILE_BREAKPOINT - 1}px)`)\n    const onChange = () => {\n      setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    }\n    mql.addEventListener(\"change\", onChange)\n    setIsMobile(window.innerWidth < MOBILE_BREAKPOINT)\n    return () => mql.removeEventListener(\"change\", onChange)\n  }, [])\n\n  return !!isMobile\n}\n","path":null,"size_bytes":565,"size_tokens":null},"client/src/components/game/IntroBanner.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Sparkles, CheckCircle } from \"lucide-react\";\n\ninterface IntroBannerProps {\n  onDismiss: () => void;\n}\n\nexport default function IntroBanner({ onDismiss }: IntroBannerProps) {\n  return (\n    <div\n      className=\"p-4 rounded-lg bg-primary/10 border border-primary/20 space-y-3\"\n      data-testid=\"intro-banner\"\n    >\n      <div className=\"flex items-center gap-2\">\n        <Sparkles className=\"w-5 h-5 text-primary\" />\n        <h3 className=\"font-semibold text-foreground\">Welcome to Train Your AI</h3>\n      </div>\n      \n      <ul className=\"space-y-2 text-sm text-muted-foreground\">\n        <li className=\"flex items-start gap-2\">\n          <CheckCircle className=\"w-4 h-4 text-primary mt-0.5 shrink-0\" />\n          <span>Connect your wallet to access the game.</span>\n        </li>\n        <li className=\"flex items-start gap-2\">\n          <CheckCircle className=\"w-4 h-4 text-primary mt-0.5 shrink-0\" />\n          <span>Pick a level and answer 10 questions per run.</span>\n        </li>\n        <li className=\"flex items-start gap-2\">\n          <CheckCircle className=\"w-4 h-4 text-primary mt-0.5 shrink-0\" />\n          <span>High scores make your AI smarter. Low scores can make it lose intelligence.</span>\n        </li>\n        <li className=\"flex items-start gap-2\">\n          <CheckCircle className=\"w-4 h-4 text-primary mt-0.5 shrink-0\" />\n          <span>Earn Style Credits from good runs and buy cosmetics for your AI.</span>\n        </li>\n      </ul>\n      \n      <Button onClick={onDismiss} className=\"w-full\" data-testid=\"button-dismiss-intro\">\n        Got it, let's train\n      </Button>\n    </div>\n  );\n}\n","path":null,"size_bytes":1679,"size_tokens":null},"client/src/components/ui/form.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport {\n  Controller,\n  FormProvider,\n  useFormContext,\n  type ControllerProps,\n  type FieldPath,\n  type FieldValues,\n} from \"react-hook-form\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Label } from \"@/components/ui/label\"\n\nconst Form = FormProvider\n\ntype FormFieldContextValue<\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n> = {\n  name: TName\n}\n\nconst FormFieldContext = React.createContext<FormFieldContextValue>(\n  {} as FormFieldContextValue\n)\n\nconst FormField = <\n  TFieldValues extends FieldValues = FieldValues,\n  TName extends FieldPath<TFieldValues> = FieldPath<TFieldValues>\n>({\n  ...props\n}: ControllerProps<TFieldValues, TName>) => {\n  return (\n    <FormFieldContext.Provider value={{ name: props.name }}>\n      <Controller {...props} />\n    </FormFieldContext.Provider>\n  )\n}\n\nconst useFormField = () => {\n  const fieldContext = React.useContext(FormFieldContext)\n  const itemContext = React.useContext(FormItemContext)\n  const { getFieldState, formState } = useFormContext()\n\n  const fieldState = getFieldState(fieldContext.name, formState)\n\n  if (!fieldContext) {\n    throw new Error(\"useFormField should be used within <FormField>\")\n  }\n\n  const { id } = itemContext\n\n  return {\n    id,\n    name: fieldContext.name,\n    formItemId: `${id}-form-item`,\n    formDescriptionId: `${id}-form-item-description`,\n    formMessageId: `${id}-form-item-message`,\n    ...fieldState,\n  }\n}\n\ntype FormItemContextValue = {\n  id: string\n}\n\nconst FormItemContext = React.createContext<FormItemContextValue>(\n  {} as FormItemContextValue\n)\n\nconst FormItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const id = React.useId()\n\n  return (\n    <FormItemContext.Provider value={{ id }}>\n      <div ref={ref} className={cn(\"space-y-2\", className)} {...props} />\n    </FormItemContext.Provider>\n  )\n})\nFormItem.displayName = \"FormItem\"\n\nconst FormLabel = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  const { error, formItemId } = useFormField()\n\n  return (\n    <Label\n      ref={ref}\n      className={cn(error && \"text-destructive\", className)}\n      htmlFor={formItemId}\n      {...props}\n    />\n  )\n})\nFormLabel.displayName = \"FormLabel\"\n\nconst FormControl = React.forwardRef<\n  React.ElementRef<typeof Slot>,\n  React.ComponentPropsWithoutRef<typeof Slot>\n>(({ ...props }, ref) => {\n  const { error, formItemId, formDescriptionId, formMessageId } = useFormField()\n\n  return (\n    <Slot\n      ref={ref}\n      id={formItemId}\n      aria-describedby={\n        !error\n          ? `${formDescriptionId}`\n          : `${formDescriptionId} ${formMessageId}`\n      }\n      aria-invalid={!!error}\n      {...props}\n    />\n  )\n})\nFormControl.displayName = \"FormControl\"\n\nconst FormDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => {\n  const { formDescriptionId } = useFormField()\n\n  return (\n    <p\n      ref={ref}\n      id={formDescriptionId}\n      className={cn(\"text-sm text-muted-foreground\", className)}\n      {...props}\n    />\n  )\n})\nFormDescription.displayName = \"FormDescription\"\n\nconst FormMessage = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, children, ...props }, ref) => {\n  const { error, formMessageId } = useFormField()\n  const body = error ? String(error?.message ?? \"\") : children\n\n  if (!body) {\n    return null\n  }\n\n  return (\n    <p\n      ref={ref}\n      id={formMessageId}\n      className={cn(\"text-sm font-medium text-destructive\", className)}\n      {...props}\n    >\n      {body}\n    </p>\n  )\n})\nFormMessage.displayName = \"FormMessage\"\n\nexport {\n  useFormField,\n  Form,\n  FormItem,\n  FormLabel,\n  FormControl,\n  FormDescription,\n  FormMessage,\n  FormField,\n}\n","path":null,"size_bytes":4120,"size_tokens":null},"client/src/components/examples/AIAvatarExample.tsx":{"content":"import AIAvatar from \"../game/AIAvatar\";\n\nexport default function AIAvatarExample() {\n  return (\n    <div className=\"flex flex-col gap-8 items-center\">\n      <AIAvatar level={2} />\n      <AIAvatar level={5} />\n      <AIAvatar level={10} />\n    </div>\n  );\n}\n","path":null,"size_bytes":258,"size_tokens":null},"client/src/components/ui/tabs.tsx":{"content":"import * as React from \"react\"\nimport * as TabsPrimitive from \"@radix-ui/react-tabs\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Tabs = TabsPrimitive.Root\n\nconst TabsList = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.List\n    ref={ref}\n    className={cn(\n      \"inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsList.displayName = TabsPrimitive.List.displayName\n\nconst TabsTrigger = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsTrigger.displayName = TabsPrimitive.Trigger.displayName\n\nconst TabsContent = React.forwardRef<\n  React.ElementRef<typeof TabsPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TabsPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <TabsPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2\",\n      className\n    )}\n    {...props}\n  />\n))\nTabsContent.displayName = TabsPrimitive.Content.displayName\n\nexport { Tabs, TabsList, TabsTrigger, TabsContent }\n","path":null,"size_bytes":1883,"size_tokens":null},"client/src/components/ui/pagination.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight, MoreHorizontal } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { ButtonProps, buttonVariants } from \"@/components/ui/button\"\n\nconst Pagination = ({ className, ...props }: React.ComponentProps<\"nav\">) => (\n  <nav\n    role=\"navigation\"\n    aria-label=\"pagination\"\n    className={cn(\"mx-auto flex w-full justify-center\", className)}\n    {...props}\n  />\n)\nPagination.displayName = \"Pagination\"\n\nconst PaginationContent = React.forwardRef<\n  HTMLUListElement,\n  React.ComponentProps<\"ul\">\n>(({ className, ...props }, ref) => (\n  <ul\n    ref={ref}\n    className={cn(\"flex flex-row items-center gap-1\", className)}\n    {...props}\n  />\n))\nPaginationContent.displayName = \"PaginationContent\"\n\nconst PaginationItem = React.forwardRef<\n  HTMLLIElement,\n  React.ComponentProps<\"li\">\n>(({ className, ...props }, ref) => (\n  <li ref={ref} className={cn(\"\", className)} {...props} />\n))\nPaginationItem.displayName = \"PaginationItem\"\n\ntype PaginationLinkProps = {\n  isActive?: boolean\n} & Pick<ButtonProps, \"size\"> &\n  React.ComponentProps<\"a\">\n\nconst PaginationLink = ({\n  className,\n  isActive,\n  size = \"icon\",\n  ...props\n}: PaginationLinkProps) => (\n  <a\n    aria-current={isActive ? \"page\" : undefined}\n    className={cn(\n      buttonVariants({\n        variant: isActive ? \"outline\" : \"ghost\",\n        size,\n      }),\n      className\n    )}\n    {...props}\n  />\n)\nPaginationLink.displayName = \"PaginationLink\"\n\nconst PaginationPrevious = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to previous page\"\n    size=\"default\"\n    className={cn(\"gap-1 pl-2.5\", className)}\n    {...props}\n  >\n    <ChevronLeft className=\"h-4 w-4\" />\n    <span>Previous</span>\n  </PaginationLink>\n)\nPaginationPrevious.displayName = \"PaginationPrevious\"\n\nconst PaginationNext = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof PaginationLink>) => (\n  <PaginationLink\n    aria-label=\"Go to next page\"\n    size=\"default\"\n    className={cn(\"gap-1 pr-2.5\", className)}\n    {...props}\n  >\n    <span>Next</span>\n    <ChevronRight className=\"h-4 w-4\" />\n  </PaginationLink>\n)\nPaginationNext.displayName = \"PaginationNext\"\n\nconst PaginationEllipsis = ({\n  className,\n  ...props\n}: React.ComponentProps<\"span\">) => (\n  <span\n    aria-hidden\n    className={cn(\"flex h-9 w-9 items-center justify-center\", className)}\n    {...props}\n  >\n    <MoreHorizontal className=\"h-4 w-4\" />\n    <span className=\"sr-only\">More pages</span>\n  </span>\n)\nPaginationEllipsis.displayName = \"PaginationEllipsis\"\n\nexport {\n  Pagination,\n  PaginationContent,\n  PaginationEllipsis,\n  PaginationItem,\n  PaginationLink,\n  PaginationNext,\n  PaginationPrevious,\n}\n","path":null,"size_bytes":2751,"size_tokens":null},"client/src/components/ui/toast.tsx":{"content":"import * as React from \"react\"\nimport * as ToastPrimitives from \"@radix-ui/react-toast\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ToastProvider = ToastPrimitives.Provider\n\nconst ToastViewport = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Viewport>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Viewport>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Viewport\n    ref={ref}\n    className={cn(\n      \"fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]\",\n      className\n    )}\n    {...props}\n  />\n))\nToastViewport.displayName = ToastPrimitives.Viewport.displayName\n\nconst toastVariants = cva(\n  \"group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full\",\n  {\n    variants: {\n      variant: {\n        default: \"border bg-background text-foreground\",\n        destructive:\n          \"destructive group border-destructive bg-destructive text-destructive-foreground\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Toast = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Root>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Root> &\n    VariantProps<typeof toastVariants>\n>(({ className, variant, ...props }, ref) => {\n  return (\n    <ToastPrimitives.Root\n      ref={ref}\n      className={cn(toastVariants({ variant }), className)}\n      {...props}\n    />\n  )\n})\nToast.displayName = ToastPrimitives.Root.displayName\n\nconst ToastAction = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Action>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Action>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Action\n    ref={ref}\n    className={cn(\n      \"inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive\",\n      className\n    )}\n    {...props}\n  />\n))\nToastAction.displayName = ToastPrimitives.Action.displayName\n\nconst ToastClose = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Close>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Close>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Close\n    ref={ref}\n    className={cn(\n      \"absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600\",\n      className\n    )}\n    toast-close=\"\"\n    {...props}\n  >\n    <X className=\"h-4 w-4\" />\n  </ToastPrimitives.Close>\n))\nToastClose.displayName = ToastPrimitives.Close.displayName\n\nconst ToastTitle = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Title>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Title>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Title\n    ref={ref}\n    className={cn(\"text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nToastTitle.displayName = ToastPrimitives.Title.displayName\n\nconst ToastDescription = React.forwardRef<\n  React.ElementRef<typeof ToastPrimitives.Description>,\n  React.ComponentPropsWithoutRef<typeof ToastPrimitives.Description>\n>(({ className, ...props }, ref) => (\n  <ToastPrimitives.Description\n    ref={ref}\n    className={cn(\"text-sm opacity-90\", className)}\n    {...props}\n  />\n))\nToastDescription.displayName = ToastPrimitives.Description.displayName\n\ntype ToastProps = React.ComponentPropsWithoutRef<typeof Toast>\n\ntype ToastActionElement = React.ReactElement<typeof ToastAction>\n\nexport {\n  type ToastProps,\n  type ToastActionElement,\n  ToastProvider,\n  ToastViewport,\n  Toast,\n  ToastTitle,\n  ToastDescription,\n  ToastClose,\n  ToastAction,\n}\n","path":null,"size_bytes":4845,"size_tokens":null},"client/src/components/examples/QuestionCardExample.tsx":{"content":"import { useState } from \"react\";\nimport QuestionCard from \"../game/QuestionCard\";\n\nexport default function QuestionCardExample() {\n  const [correctCount, setCorrectCount] = useState(3);\n  const [isLocked, setIsLocked] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState<number | null>(null);\n\n  const handleAnswer = (index: number) => {\n    console.log(\"Selected option:\", index);\n    setIsLocked(true);\n    setSelectedIndex(index);\n    if (index === 0) {\n      setCorrectCount((c) => c + 1);\n    }\n    setTimeout(() => {\n      setIsLocked(false);\n      setSelectedIndex(null);\n    }, 1000);\n  };\n\n  return (\n    <QuestionCard\n      question={{\n        id: 1,\n        text: \"What does 'CPU' stand for in computing?\",\n        options: [\"Central Processing Unit\", \"Computer Personal Unit\", \"Core Processor Utility\"],\n        correctIndex: 0,\n      }}\n      currentIndex={3}\n      totalQuestions={10}\n      correctCount={correctCount}\n      onAnswer={handleAnswer}\n      isLocked={isLocked}\n      selectedIndex={selectedIndex}\n    />\n  );\n}\n","path":null,"size_bytes":1059,"size_tokens":null},"client/src/components/game/ResultCard.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport type { GameState } from \"@/lib/gameData\";\nimport { getDifficultyLabel, getPassThreshold } from \"@/lib/gameData\";\nimport { Home, RotateCcw, Unlock, Sparkles } from \"lucide-react\";\n\ninterface ResultCardProps {\n  correctCount: number;\n  totalQuestions: number;\n  previousState: GameState;\n  newState: GameState;\n  unlockedNewLevel: boolean;\n  styleCreditsEarned: number;\n  onBackToHome: () => void;\n  onTrainAgain: () => void;\n}\n\ntype OutcomeType = \"success\" | \"neutral\" | \"fail\";\n\ninterface OutcomeConfig {\n  badgeText: string;\n  badgeClass: string;\n  explanation: string;\n  bgClass: string;\n}\n\nconst outcomeConfigs: Record<OutcomeType, OutcomeConfig> = {\n  success: {\n    badgeText: \"High-quality training\",\n    badgeClass: \"bg-success/20 text-success border-success/30 no-default-hover-elevate no-default-active-elevate\",\n    explanation: \"Your AI integrated this session into its core model.\",\n    bgClass: \"ring-1 ring-success/20\",\n  },\n  neutral: {\n    badgeText: \"Low signal - discarded\",\n    badgeClass: \"bg-muted/50 text-muted-foreground border-border/50 no-default-hover-elevate no-default-active-elevate\",\n    explanation: \"Answers were too inconsistent. Your AI discarded this data.\",\n    bgClass: \"\",\n  },\n  fail: {\n    badgeText: \"Noisy data - harmful training\",\n    badgeClass: \"bg-destructive/20 text-destructive border-destructive/30 no-default-hover-elevate no-default-active-elevate\",\n    explanation: \"Too many wrong answers in one batch. Your AI rolled back some intelligence to avoid corrupting its model.\",\n    bgClass: \"ring-1 ring-destructive/20\",\n  },\n};\n\nexport default function ResultCard({\n  correctCount,\n  totalQuestions,\n  previousState,\n  newState,\n  unlockedNewLevel,\n  styleCreditsEarned,\n  onBackToHome,\n  onTrainAgain,\n}: ResultCardProps) {\n  const scorePercent = Math.round((correctCount / totalQuestions) * 100);\n  const passThreshold = getPassThreshold(previousState.currentLevel);\n\n  let outcomeType: OutcomeType;\n  if (scorePercent >= passThreshold) {\n    outcomeType = \"success\";\n  } else if (scorePercent >= 50) {\n    outcomeType = \"neutral\";\n  } else {\n    outcomeType = \"fail\";\n  }\n\n  const config = outcomeConfigs[outcomeType];\n  const difficultyLabel = getDifficultyLabel(previousState.currentLevel);\n\n  return (\n    <div className={`space-y-4 rounded-lg ${config.bgClass}`} data-testid=\"result-card\">\n      <div className=\"text-center space-y-2\">\n        <h2 className=\"text-xl font-bold text-foreground\" data-testid=\"text-session-complete\">\n          Session Complete\n        </h2>\n        <p className=\"text-xs text-muted-foreground\">\n          Level {previousState.currentLevel} ({difficultyLabel}) | Pass: {passThreshold}%\n        </p>\n        <div className=\"space-y-1\">\n          <p className=\"text-3xl font-bold text-foreground\" data-testid=\"text-score-display\">\n            {correctCount} / {totalQuestions}\n            <span className=\"text-xl text-muted-foreground ml-2\">({scorePercent}%)</span>\n          </p>\n        </div>\n        <Badge\n          variant=\"outline\"\n          className={`text-xs px-3 py-1 ${config.badgeClass}`}\n          data-testid=\"badge-outcome\"\n        >\n          {config.badgeText}\n        </Badge>\n\n        {unlockedNewLevel && (\n          <div className=\"flex items-center justify-center gap-2 pt-1\">\n            <Badge className=\"bg-primary/20 text-primary border-primary/30 no-default-hover-elevate\">\n              <Unlock className=\"w-3 h-3 mr-1\" />\n              Level {newState.maxUnlockedLevel} Unlocked!\n            </Badge>\n          </div>\n        )}\n      </div>\n\n      <div className=\"flex items-center justify-center gap-4 py-2 px-3 rounded-lg bg-background/40 border border-border/30\">\n        <div className=\"flex items-center gap-2\">\n          <Sparkles className=\"w-4 h-4 text-primary\" />\n          <span className=\"text-sm text-foreground\" data-testid=\"text-credits-earned\">\n            +{styleCreditsEarned} Style Credits\n          </span>\n        </div>\n        <div className=\"w-px h-4 bg-border\" />\n        <span className=\"text-sm text-muted-foreground\" data-testid=\"text-credits-balance\">\n          Balance: {newState.styleCredits}\n        </span>\n      </div>\n\n      <div className=\"space-y-2\" data-testid=\"stats-comparison\">\n        <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider text-center\">\n          Before → After\n        </p>\n        <div className=\"grid grid-cols-2 gap-2\">\n          <div className=\"p-2.5 rounded-lg bg-background/40 border border-border/30 text-center\">\n            <p className=\"text-[10px] text-muted-foreground uppercase tracking-wider mb-0.5\">\n              Intelligence Level\n            </p>\n            <p className=\"font-semibold text-foreground text-sm\" data-testid=\"text-level-comparison\">\n              L{previousState.intelligenceLevel} → L{newState.intelligenceLevel}\n            </p>\n          </div>\n          <div className=\"p-2.5 rounded-lg bg-background/40 border border-border/30 text-center\">\n            <p className=\"text-[10px] text-muted-foreground uppercase tracking-wider mb-0.5\">\n              Intelligence Score\n            </p>\n            <p className=\"font-semibold text-foreground text-sm\" data-testid=\"text-score-comparison\">\n              {previousState.intelligenceScore} → {newState.intelligenceScore}\n            </p>\n          </div>\n          <div className=\"p-2.5 rounded-lg bg-background/40 border border-border/30 text-center\">\n            <p className=\"text-[10px] text-muted-foreground uppercase tracking-wider mb-0.5\">\n              Max Level Unlocked\n            </p>\n            <p className=\"font-semibold text-foreground text-sm\" data-testid=\"text-max-level-comparison\">\n              L{previousState.maxUnlockedLevel} → L{newState.maxUnlockedLevel}\n            </p>\n          </div>\n          <div className=\"p-2.5 rounded-lg bg-background/40 border border-border/30 text-center\">\n            <p className=\"text-[10px] text-muted-foreground uppercase tracking-wider mb-0.5\">\n              Total Sessions\n            </p>\n            <p className=\"font-semibold text-foreground text-sm\" data-testid=\"text-sessions-comparison\">\n              {previousState.totalSessions} → {newState.totalSessions}\n            </p>\n          </div>\n        </div>\n      </div>\n\n      <p className=\"text-sm text-muted-foreground text-center px-2\" data-testid=\"text-explanation\">\n        {config.explanation}\n      </p>\n\n      <div className=\"flex flex-col sm:flex-row gap-2 pt-1\">\n        <Button\n          variant=\"outline\"\n          className=\"flex-1\"\n          onClick={onBackToHome}\n          data-testid=\"button-back-home\"\n        >\n          <Home className=\"w-4 h-4 mr-2\" />\n          Back to Home\n        </Button>\n        <Button\n          className=\"flex-1\"\n          onClick={onTrainAgain}\n          data-testid=\"button-train-again\"\n        >\n          <RotateCcw className=\"w-4 h-4 mr-2\" />\n          Train Again\n        </Button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7087,"size_tokens":null},"client/src/components/game/CosmeticsShop.tsx":{"content":"import { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { ArrowLeft, Sparkles, Check, Info, TrendingUp } from \"lucide-react\";\nimport type { GameState } from \"@/lib/gameData\";\nimport {\n  AVATAR_SKINS,\n  AURA_STYLES,\n  type CosmeticItem,\n  getSkinEmoji,\n} from \"@/lib/cosmetics\";\n\ninterface CosmeticsShopProps {\n  state: GameState;\n  onBack: () => void;\n  onBuySkin: (skinId: string) => void;\n  onBuyAura: (auraId: string) => void;\n  onEquipSkin: (skinId: string) => void;\n  onEquipAura: (auraId: string) => void;\n}\n\ninterface CosmeticCardProps {\n  item: CosmeticItem;\n  isOwned: boolean;\n  isEquipped: boolean;\n  canAfford: boolean;\n  onBuy: () => void;\n  onEquip: () => void;\n  preview: string;\n  previewClass?: string;\n}\n\nfunction CosmeticCard({\n  item,\n  isOwned,\n  isEquipped,\n  canAfford,\n  onBuy,\n  onEquip,\n  preview,\n  previewClass = \"\",\n}: CosmeticCardProps) {\n  return (\n    <div\n      className=\"p-3 rounded-lg bg-background/40 border border-border/30 space-y-2\"\n      data-testid={`cosmetic-card-${item.id}`}\n    >\n      <div className=\"flex items-center gap-3\">\n        <div\n          className={`w-10 h-10 sm:w-12 sm:h-12 rounded-full flex items-center justify-center text-xl sm:text-2xl bg-background/50 shrink-0 ${previewClass}`}\n        >\n          {preview}\n        </div>\n        <div className=\"flex-1 min-w-0\">\n          <p className=\"font-medium text-foreground text-sm truncate\">{item.name}</p>\n          <p className=\"text-xs text-muted-foreground line-clamp-1\">{item.description}</p>\n        </div>\n      </div>\n\n      <div className=\"flex items-center justify-between gap-2 flex-wrap\">\n        {item.price > 0 && (\n          <Badge variant=\"secondary\" className=\"text-xs\">\n            <Sparkles className=\"w-3 h-3 mr-1\" />\n            {item.price}\n          </Badge>\n        )}\n        {item.price === 0 && (\n          <Badge variant=\"outline\" className=\"text-xs text-muted-foreground\">\n            Free\n          </Badge>\n        )}\n\n        {isEquipped ? (\n          <Button size=\"sm\" disabled className=\"min-w-[70px] sm:min-w-[80px]\" data-testid={`button-equipped-${item.id}`}>\n            <Check className=\"w-3 h-3 mr-1\" />\n            Equipped\n          </Button>\n        ) : isOwned ? (\n          <Button size=\"sm\" variant=\"outline\" onClick={onEquip} className=\"min-w-[70px] sm:min-w-[80px]\" data-testid={`button-equip-${item.id}`}>\n            Equip\n          </Button>\n        ) : (\n          <Button\n            size=\"sm\"\n            disabled={!canAfford}\n            onClick={onBuy}\n            className=\"min-w-[70px] sm:min-w-[80px]\"\n            data-testid={`button-buy-${item.id}`}\n          >\n            Buy\n          </Button>\n        )}\n      </div>\n    </div>\n  );\n}\n\nexport default function CosmeticsShop({\n  state,\n  onBack,\n  onBuySkin,\n  onBuyAura,\n  onEquipSkin,\n  onEquipAura,\n}: CosmeticsShopProps) {\n  const hasOnlyDefaultSkin = state.ownedSkins.length === 1 && state.ownedSkins[0] === \"skin_default\";\n  const hasNoPaidCosmetics = hasOnlyDefaultSkin && state.ownedAuras.length === 0;\n  \n  const cheapestAffordable = Math.min(\n    ...AVATAR_SKINS.filter(s => s.price > 0 && !state.ownedSkins.includes(s.id)).map(s => s.price),\n    ...AURA_STYLES.filter(a => !state.ownedAuras.includes(a.id)).map(a => a.price)\n  );\n  const cantAffordAnything = state.styleCredits < cheapestAffordable;\n\n  return (\n    <div className=\"space-y-4\" data-testid=\"cosmetics-shop\">\n      <div className=\"flex items-center justify-between gap-2 flex-wrap\">\n        <Button size=\"sm\" variant=\"ghost\" onClick={onBack} data-testid=\"button-shop-back\">\n          <ArrowLeft className=\"w-4 h-4 mr-1\" />\n          Back\n        </Button>\n        <div className=\"flex items-center gap-2\">\n          <Sparkles className=\"w-4 h-4 text-primary\" />\n          <span className=\"font-semibold text-foreground\" data-testid=\"text-shop-credits\">\n            {state.styleCredits}\n          </span>\n        </div>\n      </div>\n\n      <div className=\"text-center\">\n        <h2 className=\"text-lg font-bold text-foreground\">Cosmetics Shop</h2>\n        <p className=\"text-xs text-muted-foreground\">Customize your AI's appearance</p>\n      </div>\n\n      {cantAffordAnything && !hasNoPaidCosmetics && (\n        <div\n          className=\"flex items-start gap-2 p-2.5 rounded-md bg-primary/10 border border-primary/20 text-xs\"\n          data-testid=\"low-credits-hint\"\n        >\n          <TrendingUp className=\"w-4 h-4 text-primary shrink-0 mt-0.5\" />\n          <span className=\"text-muted-foreground\">\n            Score 70%+ in training sessions to earn more Style Credits.\n          </span>\n        </div>\n      )}\n\n      <div className=\"space-y-3\">\n        <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n          Avatar Skins\n        </p>\n        <div className=\"space-y-2\">\n          {AVATAR_SKINS.map((skin) => {\n            const isOwned = state.ownedSkins.includes(skin.id);\n            const isEquipped = state.equippedSkin === skin.id;\n            const canAfford = state.styleCredits >= skin.price;\n            const preview = getSkinEmoji(skin.id, state.intelligenceLevel);\n\n            let previewClass = \"\";\n            if (skin.id === \"skin_glitched\") previewClass = \"skin-glitched\";\n            if (skin.id === \"skin_overclocked\") previewClass = \"skin-overclocked\";\n\n            return (\n              <CosmeticCard\n                key={skin.id}\n                item={skin}\n                isOwned={isOwned}\n                isEquipped={isEquipped}\n                canAfford={canAfford}\n                onBuy={() => onBuySkin(skin.id)}\n                onEquip={() => onEquipSkin(skin.id)}\n                preview={preview}\n                previewClass={previewClass}\n              />\n            );\n          })}\n        </div>\n        \n        {hasOnlyDefaultSkin && (\n          <div\n            className=\"flex items-start gap-2 p-2 rounded-md bg-muted/20 text-xs\"\n            data-testid=\"skins-hint\"\n          >\n            <Info className=\"w-3.5 h-3.5 text-muted-foreground shrink-0 mt-0.5\" />\n            <span className=\"text-muted-foreground\">\n              Try your first skin purchase with Style Credits you earn from good runs.\n            </span>\n          </div>\n        )}\n      </div>\n\n      <div className=\"space-y-3\">\n        <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n          Aura Styles\n        </p>\n        <div className=\"space-y-2\">\n          {AURA_STYLES.map((aura) => {\n            const isOwned = state.ownedAuras.includes(aura.id);\n            const isEquipped = state.equippedAura === aura.id;\n            const canAfford = state.styleCredits >= aura.price;\n\n            let auraPreviewClass = \"\";\n            if (aura.id === \"aura_blue\") auraPreviewClass = \"aura-blue\";\n            if (aura.id === \"aura_purple\") auraPreviewClass = \"aura-purple\";\n            if (aura.id === \"aura_green\") auraPreviewClass = \"aura-green\";\n\n            return (\n              <CosmeticCard\n                key={aura.id}\n                item={aura}\n                isOwned={isOwned}\n                isEquipped={isEquipped}\n                canAfford={canAfford}\n                onBuy={() => onBuyAura(aura.id)}\n                onEquip={() => onEquipAura(aura.id)}\n                preview={\"\\u2728\"}\n                previewClass={auraPreviewClass}\n              />\n            );\n          })}\n        </div>\n        \n        {state.ownedAuras.length === 0 && (\n          <div\n            className=\"flex items-start gap-2 p-2 rounded-md bg-muted/20 text-xs\"\n            data-testid=\"auras-hint\"\n          >\n            <Info className=\"w-3.5 h-3.5 text-muted-foreground shrink-0 mt-0.5\" />\n            <span className=\"text-muted-foreground\">\n              Auras add a glowing effect around your AI. Start with the Neon Blue for 50 credits.\n            </span>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":7966,"size_tokens":null},"vite.config.ts":{"content":"import { defineConfig } from \"vite\";\nimport react from \"@vitejs/plugin-react\";\nimport path from \"path\";\nimport runtimeErrorOverlay from \"@replit/vite-plugin-runtime-error-modal\";\n\nexport default defineConfig({\n  plugins: [\n    react(),\n    runtimeErrorOverlay(),\n    ...(process.env.NODE_ENV !== \"production\" &&\n    process.env.REPL_ID !== undefined\n      ? [\n          await import(\"@replit/vite-plugin-cartographer\").then((m) =>\n            m.cartographer(),\n          ),\n          await import(\"@replit/vite-plugin-dev-banner\").then((m) =>\n            m.devBanner(),\n          ),\n        ]\n      : []),\n  ],\n  resolve: {\n    alias: {\n      \"@\": path.resolve(import.meta.dirname, \"client\", \"src\"),\n      \"@shared\": path.resolve(import.meta.dirname, \"shared\"),\n      \"@assets\": path.resolve(import.meta.dirname, \"attached_assets\"),\n    },\n  },\n  root: path.resolve(import.meta.dirname, \"client\"),\n  build: {\n    outDir: path.resolve(import.meta.dirname, \"dist/public\"),\n    emptyOutDir: true,\n  },\n  server: {\n    fs: {\n      strict: true,\n      deny: [\"**/.*\"],\n    },\n  },\n});\n","path":null,"size_bytes":1080,"size_tokens":null},"client/src/components/ui/command.tsx":{"content":"import * as React from \"react\"\nimport { type DialogProps } from \"@radix-ui/react-dialog\"\nimport { Command as CommandPrimitive } from \"cmdk\"\nimport { Search } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Dialog, DialogContent } from \"@/components/ui/dialog\"\n\nconst Command = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive\n    ref={ref}\n    className={cn(\n      \"flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nCommand.displayName = CommandPrimitive.displayName\n\nconst CommandDialog = ({ children, ...props }: DialogProps) => {\n  return (\n    <Dialog {...props}>\n      <DialogContent className=\"overflow-hidden p-0 shadow-lg\">\n        <Command className=\"[&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground [&_[cmdk-group]:not([hidden])_~[cmdk-group]]:pt-0 [&_[cmdk-group]]:px-2 [&_[cmdk-input-wrapper]_svg]:h-5 [&_[cmdk-input-wrapper]_svg]:w-5 [&_[cmdk-input]]:h-12 [&_[cmdk-item]]:px-2 [&_[cmdk-item]]:py-3 [&_[cmdk-item]_svg]:h-5 [&_[cmdk-item]_svg]:w-5\">\n          {children}\n        </Command>\n      </DialogContent>\n    </Dialog>\n  )\n}\n\nconst CommandInput = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Input>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Input>\n>(({ className, ...props }, ref) => (\n  <div className=\"flex items-center border-b px-3\" cmdk-input-wrapper=\"\">\n    <Search className=\"mr-2 h-4 w-4 shrink-0 opacity-50\" />\n    <CommandPrimitive.Input\n      ref={ref}\n      className={cn(\n        \"flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    />\n  </div>\n))\n\nCommandInput.displayName = CommandPrimitive.Input.displayName\n\nconst CommandList = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.List\n    ref={ref}\n    className={cn(\"max-h-[300px] overflow-y-auto overflow-x-hidden\", className)}\n    {...props}\n  />\n))\n\nCommandList.displayName = CommandPrimitive.List.displayName\n\nconst CommandEmpty = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Empty>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Empty>\n>((props, ref) => (\n  <CommandPrimitive.Empty\n    ref={ref}\n    className=\"py-6 text-center text-sm\"\n    {...props}\n  />\n))\n\nCommandEmpty.displayName = CommandPrimitive.Empty.displayName\n\nconst CommandGroup = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Group>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Group>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Group\n    ref={ref}\n    className={cn(\n      \"overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandGroup.displayName = CommandPrimitive.Group.displayName\n\nconst CommandSeparator = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nCommandSeparator.displayName = CommandPrimitive.Separator.displayName\n\nconst CommandItem = React.forwardRef<\n  React.ElementRef<typeof CommandPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof CommandPrimitive.Item>\n>(({ className, ...props }, ref) => (\n  <CommandPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      className\n    )}\n    {...props}\n  />\n))\n\nCommandItem.displayName = CommandPrimitive.Item.displayName\n\nconst CommandShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nCommandShortcut.displayName = \"CommandShortcut\"\n\nexport {\n  Command,\n  CommandDialog,\n  CommandInput,\n  CommandList,\n  CommandEmpty,\n  CommandGroup,\n  CommandItem,\n  CommandShortcut,\n  CommandSeparator,\n}\n","path":null,"size_bytes":4885,"size_tokens":null},"client/src/components/examples/TrainingScreenExample.tsx":{"content":"import TrainingScreen from \"../game/TrainingScreen\";\n\nexport default function TrainingScreenExample() {\n  return (\n    <TrainingScreen\n      currentLevel={3}\n      onSessionComplete={(correct, total) =>\n        console.log(`Session complete: ${correct}/${total}`)\n      }\n    />\n  );\n}\n","path":null,"size_bytes":286,"size_tokens":null},"client/src/components/ui/collapsible.tsx":{"content":"\"use client\"\n\nimport * as CollapsiblePrimitive from \"@radix-ui/react-collapsible\"\n\nconst Collapsible = CollapsiblePrimitive.Root\n\nconst CollapsibleTrigger = CollapsiblePrimitive.CollapsibleTrigger\n\nconst CollapsibleContent = CollapsiblePrimitive.CollapsibleContent\n\nexport { Collapsible, CollapsibleTrigger, CollapsibleContent }\n","path":null,"size_bytes":329,"size_tokens":null},"client/src/components/ui/input.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    // h-9 to match icon buttons and default buttons.\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-9 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n","path":null,"size_bytes":844,"size_tokens":null},"client/src/components/ui/label.tsx":{"content":"import * as React from \"react\"\nimport * as LabelPrimitive from \"@radix-ui/react-label\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst labelVariants = cva(\n  \"text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70\"\n)\n\nconst Label = React.forwardRef<\n  React.ElementRef<typeof LabelPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof LabelPrimitive.Root> &\n    VariantProps<typeof labelVariants>\n>(({ className, ...props }, ref) => (\n  <LabelPrimitive.Root\n    ref={ref}\n    className={cn(labelVariants(), className)}\n    {...props}\n  />\n))\nLabel.displayName = LabelPrimitive.Root.displayName\n\nexport { Label }\n","path":null,"size_bytes":710,"size_tokens":null},"drizzle.config.ts":{"content":"import { defineConfig } from \"drizzle-kit\";\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL, ensure the database is provisioned\");\n}\n\nexport default defineConfig({\n  schema: \"./shared/schema.ts\",\n  dialect: \"postgresql\",\n  out: \"./migrations\",\n  dbCredentials: {\n    url: process.env.DATABASE_URL,\n  },\n});\n","path":null,"size_bytes":325,"size_tokens":null},"client/src/lib/eventLog.ts":{"content":"// Lightweight event logging for future analytics\n// Events are logged to console with a consistent format\n\nexport interface EventPayload {\n  [key: string]: string | number | boolean | null | undefined;\n}\n\nexport function logEvent(eventName: string, payload?: EventPayload): void {\n  const timestamp = new Date().toISOString();\n  const logData = {\n    event: eventName,\n    timestamp,\n    ...payload,\n  };\n  \n  console.log(`[TrainYourAI Event] ${eventName}`, logData);\n}\n\n// Pre-defined event names for consistency\nexport const EVENTS = {\n  SESSION_START: \"session_start\",\n  SESSION_END: \"session_end\",\n  LEVEL_UNLOCKED: \"level_unlocked\",\n  COSMETIC_PURCHASED: \"cosmetic_purchased\",\n  COSMETIC_EQUIPPED: \"cosmetic_equipped\",\n  WALLET_CONNECTED: \"wallet_connected\",\n  WALLET_DISCONNECTED: \"wallet_disconnected\",\n  INTRO_DISMISSED: \"intro_dismissed\",\n  PROGRESS_RESET: \"progress_reset\",\n} as const;\n","path":null,"size_bytes":897,"size_tokens":null},"client/src/components/ui/calendar.tsx":{"content":"import * as React from \"react\"\nimport { ChevronLeft, ChevronRight } from \"lucide-react\"\nimport { DayPicker } from \"react-day-picker\"\n\nimport { cn } from \"@/lib/utils\"\nimport { buttonVariants } from \"@/components/ui/button\"\n\nexport type CalendarProps = React.ComponentProps<typeof DayPicker>\n\nfunction Calendar({\n  className,\n  classNames,\n  showOutsideDays = true,\n  ...props\n}: CalendarProps) {\n  return (\n    <DayPicker\n      showOutsideDays={showOutsideDays}\n      className={cn(\"p-3\", className)}\n      classNames={{\n        months: \"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0\",\n        month: \"space-y-4\",\n        caption: \"flex justify-center pt-1 relative items-center\",\n        caption_label: \"text-sm font-medium\",\n        nav: \"space-x-1 flex items-center\",\n        nav_button: cn(\n          buttonVariants({ variant: \"outline\" }),\n          \"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100\"\n        ),\n        nav_button_previous: \"absolute left-1\",\n        nav_button_next: \"absolute right-1\",\n        table: \"w-full border-collapse space-y-1\",\n        head_row: \"flex\",\n        head_cell:\n          \"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]\",\n        row: \"flex w-full mt-2\",\n        cell: \"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20\",\n        day: cn(\n          buttonVariants({ variant: \"ghost\" }),\n          \"h-9 w-9 p-0 font-normal aria-selected:opacity-100\"\n        ),\n        day_range_end: \"day-range-end\",\n        day_selected:\n          \"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground\",\n        day_today: \"bg-accent text-accent-foreground\",\n        day_outside:\n          \"day-outside text-muted-foreground aria-selected:bg-accent/50 aria-selected:text-muted-foreground\",\n        day_disabled: \"text-muted-foreground opacity-50\",\n        day_range_middle:\n          \"aria-selected:bg-accent aria-selected:text-accent-foreground\",\n        day_hidden: \"invisible\",\n        ...classNames,\n      }}\n      components={{\n        IconLeft: ({ className, ...props }) => (\n          <ChevronLeft className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n        IconRight: ({ className, ...props }) => (\n          <ChevronRight className={cn(\"h-4 w-4\", className)} {...props} />\n        ),\n      }}\n      {...props}\n    />\n  )\n}\nCalendar.displayName = \"Calendar\"\n\nexport { Calendar }\n","path":null,"size_bytes":2695,"size_tokens":null},"client/src/components/examples/WalletButtonExample.tsx":{"content":"import { useState } from \"react\";\nimport WalletButton from \"../game/WalletButton\";\n\nexport default function WalletButtonExample() {\n  const [address, setAddress] = useState<string | null>(null);\n\n  return (\n    <div className=\"space-y-4\">\n      <WalletButton\n        connectedAddress={address}\n        onConnect={(addr) => {\n          console.log(\"Connected:\", addr);\n          setAddress(addr);\n        }}\n        onDisconnect={() => {\n          console.log(\"Disconnected\");\n          setAddress(null);\n        }}\n      />\n      {/* Simulated connected state for demo */}\n      <WalletButton\n        connectedAddress=\"7xKXtg2CW87d97TXJSDpbD5jBkheTqA83TZRuJosgAsU\"\n        onConnect={() => {}}\n        onDisconnect={() => console.log(\"Disconnect clicked\")}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":784,"size_tokens":null},"client/src/App.tsx":{"content":"import { queryClient } from \"./lib/queryClient\";\nimport { QueryClientProvider } from \"@tanstack/react-query\";\nimport { Toaster } from \"@/components/ui/toaster\";\nimport { TooltipProvider } from \"@/components/ui/tooltip\";\nimport { Route, Switch } from \"wouter\";\nimport GameContainer from \"@/components/game/GameContainer\";\nimport AdminDashboard from \"@/components/admin/AdminDashboard\";\nimport Corpus from \"@/pages/Corpus\";\nimport CorpusAdmin from \"@/pages/CorpusAdmin\";\nimport AIChat from \"@/pages/AIChat\";\n\nfunction App() {\n  return (\n    <QueryClientProvider client={queryClient}>\n      <TooltipProvider>\n        <Toaster />\n        <Switch>\n          <Route path=\"/admin\" component={AdminDashboard} />\n          <Route path=\"/corpus\" component={Corpus} />\n          <Route path=\"/corpus/admin\" component={CorpusAdmin} />\n          <Route path=\"/chat\" component={AIChat} />\n          <Route path=\"/\" component={GameContainer} />\n        </Switch>\n      </TooltipProvider>\n    </QueryClientProvider>\n  );\n}\n\nexport default App;\n","path":null,"size_bytes":1028,"size_tokens":null},"client/src/components/ui/popover.tsx":{"content":"import * as React from \"react\"\nimport * as PopoverPrimitive from \"@radix-ui/react-popover\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Popover = PopoverPrimitive.Root\n\nconst PopoverTrigger = PopoverPrimitive.Trigger\n\nconst PopoverContent = React.forwardRef<\n  React.ElementRef<typeof PopoverPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof PopoverPrimitive.Content>\n>(({ className, align = \"center\", sideOffset = 4, ...props }, ref) => (\n  <PopoverPrimitive.Portal>\n    <PopoverPrimitive.Content\n      ref={ref}\n      align={align}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-popover-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </PopoverPrimitive.Portal>\n))\nPopoverContent.displayName = PopoverPrimitive.Content.displayName\n\nexport { Popover, PopoverTrigger, PopoverContent }\n","path":null,"size_bytes":1280,"size_tokens":null},"client/src/components/ui/carousel.tsx":{"content":"import * as React from \"react\"\nimport useEmblaCarousel, {\n  type UseEmblaCarouselType,\n} from \"embla-carousel-react\"\nimport { ArrowLeft, ArrowRight } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\n\ntype CarouselApi = UseEmblaCarouselType[1]\ntype UseCarouselParameters = Parameters<typeof useEmblaCarousel>\ntype CarouselOptions = UseCarouselParameters[0]\ntype CarouselPlugin = UseCarouselParameters[1]\n\ntype CarouselProps = {\n  opts?: CarouselOptions\n  plugins?: CarouselPlugin\n  orientation?: \"horizontal\" | \"vertical\"\n  setApi?: (api: CarouselApi) => void\n}\n\ntype CarouselContextProps = {\n  carouselRef: ReturnType<typeof useEmblaCarousel>[0]\n  api: ReturnType<typeof useEmblaCarousel>[1]\n  scrollPrev: () => void\n  scrollNext: () => void\n  canScrollPrev: boolean\n  canScrollNext: boolean\n} & CarouselProps\n\nconst CarouselContext = React.createContext<CarouselContextProps | null>(null)\n\nfunction useCarousel() {\n  const context = React.useContext(CarouselContext)\n\n  if (!context) {\n    throw new Error(\"useCarousel must be used within a <Carousel />\")\n  }\n\n  return context\n}\n\nconst Carousel = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & CarouselProps\n>(\n  (\n    {\n      orientation = \"horizontal\",\n      opts,\n      setApi,\n      plugins,\n      className,\n      children,\n      ...props\n    },\n    ref\n  ) => {\n    const [carouselRef, api] = useEmblaCarousel(\n      {\n        ...opts,\n        axis: orientation === \"horizontal\" ? \"x\" : \"y\",\n      },\n      plugins\n    )\n    const [canScrollPrev, setCanScrollPrev] = React.useState(false)\n    const [canScrollNext, setCanScrollNext] = React.useState(false)\n\n    const onSelect = React.useCallback((api: CarouselApi) => {\n      if (!api) {\n        return\n      }\n\n      setCanScrollPrev(api.canScrollPrev())\n      setCanScrollNext(api.canScrollNext())\n    }, [])\n\n    const scrollPrev = React.useCallback(() => {\n      api?.scrollPrev()\n    }, [api])\n\n    const scrollNext = React.useCallback(() => {\n      api?.scrollNext()\n    }, [api])\n\n    const handleKeyDown = React.useCallback(\n      (event: React.KeyboardEvent<HTMLDivElement>) => {\n        if (event.key === \"ArrowLeft\") {\n          event.preventDefault()\n          scrollPrev()\n        } else if (event.key === \"ArrowRight\") {\n          event.preventDefault()\n          scrollNext()\n        }\n      },\n      [scrollPrev, scrollNext]\n    )\n\n    React.useEffect(() => {\n      if (!api || !setApi) {\n        return\n      }\n\n      setApi(api)\n    }, [api, setApi])\n\n    React.useEffect(() => {\n      if (!api) {\n        return\n      }\n\n      onSelect(api)\n      api.on(\"reInit\", onSelect)\n      api.on(\"select\", onSelect)\n\n      return () => {\n        api?.off(\"select\", onSelect)\n      }\n    }, [api, onSelect])\n\n    return (\n      <CarouselContext.Provider\n        value={{\n          carouselRef,\n          api: api,\n          opts,\n          orientation:\n            orientation || (opts?.axis === \"y\" ? \"vertical\" : \"horizontal\"),\n          scrollPrev,\n          scrollNext,\n          canScrollPrev,\n          canScrollNext,\n        }}\n      >\n        <div\n          ref={ref}\n          onKeyDownCapture={handleKeyDown}\n          className={cn(\"relative\", className)}\n          role=\"region\"\n          aria-roledescription=\"carousel\"\n          {...props}\n        >\n          {children}\n        </div>\n      </CarouselContext.Provider>\n    )\n  }\n)\nCarousel.displayName = \"Carousel\"\n\nconst CarouselContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { carouselRef, orientation } = useCarousel()\n\n  return (\n    <div ref={carouselRef} className=\"overflow-hidden\">\n      <div\n        ref={ref}\n        className={cn(\n          \"flex\",\n          orientation === \"horizontal\" ? \"-ml-4\" : \"-mt-4 flex-col\",\n          className\n        )}\n        {...props}\n      />\n    </div>\n  )\n})\nCarouselContent.displayName = \"CarouselContent\"\n\nconst CarouselItem = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => {\n  const { orientation } = useCarousel()\n\n  return (\n    <div\n      ref={ref}\n      role=\"group\"\n      aria-roledescription=\"slide\"\n      className={cn(\n        \"min-w-0 shrink-0 grow-0 basis-full\",\n        orientation === \"horizontal\" ? \"pl-4\" : \"pt-4\",\n        className\n      )}\n      {...props}\n    />\n  )\n})\nCarouselItem.displayName = \"CarouselItem\"\n\nconst CarouselPrevious = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollPrev, canScrollPrev } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute  h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-left-12 top-1/2 -translate-y-1/2\"\n          : \"-top-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollPrev}\n      onClick={scrollPrev}\n      {...props}\n    >\n      <ArrowLeft className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Previous slide</span>\n    </Button>\n  )\n})\nCarouselPrevious.displayName = \"CarouselPrevious\"\n\nconst CarouselNext = React.forwardRef<\n  HTMLButtonElement,\n  React.ComponentProps<typeof Button>\n>(({ className, variant = \"outline\", size = \"icon\", ...props }, ref) => {\n  const { orientation, scrollNext, canScrollNext } = useCarousel()\n\n  return (\n    <Button\n      ref={ref}\n      variant={variant}\n      size={size}\n      className={cn(\n        \"absolute h-8 w-8 rounded-full\",\n        orientation === \"horizontal\"\n          ? \"-right-12 top-1/2 -translate-y-1/2\"\n          : \"-bottom-12 left-1/2 -translate-x-1/2 rotate-90\",\n        className\n      )}\n      disabled={!canScrollNext}\n      onClick={scrollNext}\n      {...props}\n    >\n      <ArrowRight className=\"h-4 w-4\" />\n      <span className=\"sr-only\">Next slide</span>\n    </Button>\n  )\n})\nCarouselNext.displayName = \"CarouselNext\"\n\nexport {\n  type CarouselApi,\n  Carousel,\n  CarouselContent,\n  CarouselItem,\n  CarouselPrevious,\n  CarouselNext,\n}\n","path":null,"size_bytes":6210,"size_tokens":null},"server/index.ts":{"content":"import express, { type Request, Response, NextFunction } from \"express\";\nimport cookieParser from \"cookie-parser\";\nimport { registerRoutes } from \"./routes\";\nimport { serveStatic } from \"./static\";\nimport { createServer } from \"http\";\n\nconst app = express();\nconst httpServer = createServer(app);\n\ndeclare module \"http\" {\n  interface IncomingMessage {\n    rawBody: unknown;\n  }\n}\n\napp.use(\n  express.json({\n    verify: (req, _res, buf) => {\n      req.rawBody = buf;\n    },\n  }),\n);\n\napp.use(express.urlencoded({ extended: false }));\napp.use(cookieParser());\n\nexport function log(message: string, source = \"express\") {\n  const formattedTime = new Date().toLocaleTimeString(\"en-US\", {\n    hour: \"numeric\",\n    minute: \"2-digit\",\n    second: \"2-digit\",\n    hour12: true,\n  });\n\n  console.log(`${formattedTime} [${source}] ${message}`);\n}\n\napp.use((req, res, next) => {\n  const start = Date.now();\n  const path = req.path;\n  let capturedJsonResponse: Record<string, any> | undefined = undefined;\n\n  const originalResJson = res.json;\n  res.json = function (bodyJson, ...args) {\n    capturedJsonResponse = bodyJson;\n    return originalResJson.apply(res, [bodyJson, ...args]);\n  };\n\n  res.on(\"finish\", () => {\n    const duration = Date.now() - start;\n    if (path.startsWith(\"/api\")) {\n      let logLine = `${req.method} ${path} ${res.statusCode} in ${duration}ms`;\n      if (capturedJsonResponse) {\n        logLine += ` :: ${JSON.stringify(capturedJsonResponse)}`;\n      }\n\n      log(logLine);\n    }\n  });\n\n  next();\n});\n\n(async () => {\n  await registerRoutes(httpServer, app);\n\n  app.use((err: any, _req: Request, res: Response, _next: NextFunction) => {\n    const status = err.status || err.statusCode || 500;\n    const message = err.message || \"Internal Server Error\";\n\n    res.status(status).json({ message });\n    throw err;\n  });\n\n  // importantly only setup vite in development and after\n  // setting up all the other routes so the catch-all route\n  // doesn't interfere with the other routes\n  if (process.env.NODE_ENV === \"production\") {\n    serveStatic(app);\n  } else {\n    const { setupVite } = await import(\"./vite\");\n    await setupVite(httpServer, app);\n  }\n\n  // ALWAYS serve the app on the port specified in the environment variable PORT\n  // Other ports are firewalled. Default to 5000 if not specified.\n  // this serves both the API and the client.\n  // It is the only port that is not firewalled.\n  const port = parseInt(process.env.PORT || \"5000\", 10);\n  httpServer.listen(\n    {\n      port,\n      host: \"0.0.0.0\",\n      reusePort: true,\n    },\n    () => {\n      log(`serving on port ${port}`);\n    },\n  );\n})();\n","path":null,"size_bytes":2627,"size_tokens":null},"client/src/components/ui/alert.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst alertVariants = cva(\n  \"relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-background text-foreground\",\n        destructive:\n          \"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  }\n)\n\nconst Alert = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement> & VariantProps<typeof alertVariants>\n>(({ className, variant, ...props }, ref) => (\n  <div\n    ref={ref}\n    role=\"alert\"\n    className={cn(alertVariants({ variant }), className)}\n    {...props}\n  />\n))\nAlert.displayName = \"Alert\"\n\nconst AlertTitle = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLHeadingElement>\n>(({ className, ...props }, ref) => (\n  <h5\n    ref={ref}\n    className={cn(\"mb-1 font-medium leading-none tracking-tight\", className)}\n    {...props}\n  />\n))\nAlertTitle.displayName = \"AlertTitle\"\n\nconst AlertDescription = React.forwardRef<\n  HTMLParagraphElement,\n  React.HTMLAttributes<HTMLParagraphElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm [&_p]:leading-relaxed\", className)}\n    {...props}\n  />\n))\nAlertDescription.displayName = \"AlertDescription\"\n\nexport { Alert, AlertTitle, AlertDescription }\n","path":null,"size_bytes":1584,"size_tokens":null},"client/src/components/ui/dialog.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as DialogPrimitive from \"@radix-ui/react-dialog\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Dialog = DialogPrimitive.Root\n\nconst DialogTrigger = DialogPrimitive.Trigger\n\nconst DialogPortal = DialogPrimitive.Portal\n\nconst DialogClose = DialogPrimitive.Close\n\nconst DialogOverlay = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Overlay\n    ref={ref}\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogOverlay.displayName = DialogPrimitive.Overlay.displayName\n\nconst DialogContent = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Content>\n>(({ className, children, ...props }, ref) => (\n  <DialogPortal>\n    <DialogOverlay />\n    <DialogPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg\",\n        className\n      )}\n      {...props}\n    >\n      {children}\n      <DialogPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </DialogPrimitive.Close>\n    </DialogPrimitive.Content>\n  </DialogPortal>\n))\nDialogContent.displayName = DialogPrimitive.Content.displayName\n\nconst DialogHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-1.5 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogHeader.displayName = \"DialogHeader\"\n\nconst DialogFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nDialogFooter.displayName = \"DialogFooter\"\n\nconst DialogTitle = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Title\n    ref={ref}\n    className={cn(\n      \"text-lg font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nDialogTitle.displayName = DialogPrimitive.Title.displayName\n\nconst DialogDescription = React.forwardRef<\n  React.ElementRef<typeof DialogPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof DialogPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <DialogPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nDialogDescription.displayName = DialogPrimitive.Description.displayName\n\nexport {\n  Dialog,\n  DialogPortal,\n  DialogOverlay,\n  DialogClose,\n  DialogTrigger,\n  DialogContent,\n  DialogHeader,\n  DialogFooter,\n  DialogTitle,\n  DialogDescription,\n}\n","path":null,"size_bytes":3848,"size_tokens":null},"tailwind.config.ts":{"content":"import type { Config } from \"tailwindcss\";\n\nexport default {\n  darkMode: [\"class\"],\n  content: [\"./client/index.html\", \"./client/src/**/*.{js,jsx,ts,tsx}\"],\n  theme: {\n    extend: {\n      borderRadius: {\n        lg: \".5625rem\", /* 9px */\n        md: \".375rem\", /* 6px */\n        sm: \".1875rem\", /* 3px */\n      },\n      colors: {\n        // Flat / base colors (regular buttons)\n        background: \"hsl(var(--background) / <alpha-value>)\",\n        foreground: \"hsl(var(--foreground) / <alpha-value>)\",\n        border: \"hsl(var(--border) / <alpha-value>)\",\n        input: \"hsl(var(--input) / <alpha-value>)\",\n        card: {\n          DEFAULT: \"hsl(var(--card) / <alpha-value>)\",\n          foreground: \"hsl(var(--card-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--card-border) / <alpha-value>)\",\n        },\n        popover: {\n          DEFAULT: \"hsl(var(--popover) / <alpha-value>)\",\n          foreground: \"hsl(var(--popover-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--popover-border) / <alpha-value>)\",\n        },\n        primary: {\n          DEFAULT: \"hsl(var(--primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--primary-foreground) / <alpha-value>)\",\n          border: \"var(--primary-border)\",\n        },\n        secondary: {\n          DEFAULT: \"hsl(var(--secondary) / <alpha-value>)\",\n          foreground: \"hsl(var(--secondary-foreground) / <alpha-value>)\",\n          border: \"var(--secondary-border)\",\n        },\n        muted: {\n          DEFAULT: \"hsl(var(--muted) / <alpha-value>)\",\n          foreground: \"hsl(var(--muted-foreground) / <alpha-value>)\",\n          border: \"var(--muted-border)\",\n        },\n        accent: {\n          DEFAULT: \"hsl(var(--accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--accent-foreground) / <alpha-value>)\",\n          border: \"var(--accent-border)\",\n        },\n        destructive: {\n          DEFAULT: \"hsl(var(--destructive) / <alpha-value>)\",\n          foreground: \"hsl(var(--destructive-foreground) / <alpha-value>)\",\n          border: \"var(--destructive-border)\",\n        },\n        success: {\n          DEFAULT: \"hsl(var(--success) / <alpha-value>)\",\n          foreground: \"hsl(var(--success-foreground) / <alpha-value>)\",\n        },\n        warning: {\n          DEFAULT: \"hsl(var(--warning) / <alpha-value>)\",\n          foreground: \"hsl(var(--warning-foreground) / <alpha-value>)\",\n        },\n        ring: \"hsl(var(--ring) / <alpha-value>)\",\n        chart: {\n          \"1\": \"hsl(var(--chart-1) / <alpha-value>)\",\n          \"2\": \"hsl(var(--chart-2) / <alpha-value>)\",\n          \"3\": \"hsl(var(--chart-3) / <alpha-value>)\",\n          \"4\": \"hsl(var(--chart-4) / <alpha-value>)\",\n          \"5\": \"hsl(var(--chart-5) / <alpha-value>)\",\n        },\n        sidebar: {\n          ring: \"hsl(var(--sidebar-ring) / <alpha-value>)\",\n          DEFAULT: \"hsl(var(--sidebar) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-foreground) / <alpha-value>)\",\n          border: \"hsl(var(--sidebar-border) / <alpha-value>)\",\n        },\n        \"sidebar-primary\": {\n          DEFAULT: \"hsl(var(--sidebar-primary) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-primary-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-primary-border)\",\n        },\n        \"sidebar-accent\": {\n          DEFAULT: \"hsl(var(--sidebar-accent) / <alpha-value>)\",\n          foreground: \"hsl(var(--sidebar-accent-foreground) / <alpha-value>)\",\n          border: \"var(--sidebar-accent-border)\"\n        },\n        status: {\n          online: \"rgb(34 197 94)\",\n          away: \"rgb(245 158 11)\",\n          busy: \"rgb(239 68 68)\",\n          offline: \"rgb(156 163 175)\",\n        },\n      },\n      fontFamily: {\n        sans: [\"var(--font-sans)\"],\n        serif: [\"var(--font-serif)\"],\n        mono: [\"var(--font-mono)\"],\n      },\n      keyframes: {\n        \"accordion-down\": {\n          from: { height: \"0\" },\n          to: { height: \"var(--radix-accordion-content-height)\" },\n        },\n        \"accordion-up\": {\n          from: { height: \"var(--radix-accordion-content-height)\" },\n          to: { height: \"0\" },\n        },\n      },\n      animation: {\n        \"accordion-down\": \"accordion-down 0.2s ease-out\",\n        \"accordion-up\": \"accordion-up 0.2s ease-out\",\n      },\n    },\n  },\n  plugins: [require(\"tailwindcss-animate\"), require(\"@tailwindcss/typography\")],\n} satisfies Config;\n","path":null,"size_bytes":4370,"size_tokens":null},"client/src/components/game/TrainingScreen.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport type { Question } from \"@/lib/gameData\";\nimport { selectQuestionsForLevel, getDifficultyLabel } from \"@/lib/gameData\";\nimport QuestionCard from \"./QuestionCard\";\n\ninterface TrainingScreenProps {\n  currentLevel: number;\n  intelligenceLevel: number;\n  onSessionComplete: (correctCount: number, totalQuestions: number) => void;\n}\n\nexport default function TrainingScreen({\n  currentLevel,\n  intelligenceLevel,\n  onSessionComplete,\n}: TrainingScreenProps) {\n  const [sessionQuestions, setSessionQuestions] = useState<Question[]>([]);\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [correctCount, setCorrectCount] = useState(0);\n  const [isLocked, setIsLocked] = useState(false);\n  const [selectedIndex, setSelectedIndex] = useState<number | null>(null);\n\n  useEffect(() => {\n    const questions = selectQuestionsForLevel(currentLevel);\n    setSessionQuestions(questions);\n    setCurrentIndex(0);\n    setCorrectCount(0);\n    setIsLocked(false);\n    setSelectedIndex(null);\n  }, [currentLevel]);\n\n  const handleAnswer = (answerIndex: number) => {\n    if (isLocked || sessionQuestions.length === 0) return;\n\n    setIsLocked(true);\n    setSelectedIndex(answerIndex);\n    \n    const currentQuestion = sessionQuestions[currentIndex];\n    const isCorrect = answerIndex === currentQuestion.correctIndex;\n    const newCorrectCount = correctCount + (isCorrect ? 1 : 0);\n\n    if (isCorrect) {\n      setCorrectCount(newCorrectCount);\n    }\n\n    setTimeout(() => {\n      if (currentIndex + 1 >= sessionQuestions.length) {\n        onSessionComplete(newCorrectCount, sessionQuestions.length);\n      } else {\n        setCurrentIndex((i) => i + 1);\n        setIsLocked(false);\n        setSelectedIndex(null);\n      }\n    }, 700);\n  };\n\n  if (sessionQuestions.length === 0) {\n    return (\n      <div className=\"text-center py-8\" data-testid=\"loading-state\">\n        <div className=\"w-6 h-6 mx-auto border-2 border-primary border-t-transparent rounded-full animate-spin mb-3\" />\n        <p className=\"text-muted-foreground\">Loading questions...</p>\n      </div>\n    );\n  }\n\n  const difficultyLabel = getDifficultyLabel(currentLevel);\n\n  return (\n    <div className=\"space-y-4\" data-testid=\"training-screen\">\n      <div className=\"text-center space-y-1\">\n        <h2 className=\"text-lg font-semibold text-foreground\" data-testid=\"text-training-header\">\n          Training Session - Level {currentLevel}\n        </h2>\n        <p className=\"text-xs text-muted-foreground\">\n          Difficulty: {difficultyLabel} | AI Intelligence: L{intelligenceLevel}\n        </p>\n      </div>\n\n      <QuestionCard\n        question={sessionQuestions[currentIndex]}\n        currentIndex={currentIndex}\n        totalQuestions={sessionQuestions.length}\n        correctCount={correctCount}\n        onAnswer={handleAnswer}\n        isLocked={isLocked}\n        selectedIndex={selectedIndex}\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":2937,"size_tokens":null},"client/src/components/ui/select.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SelectPrimitive from \"@radix-ui/react-select\"\nimport { Check, ChevronDown, ChevronUp } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Select = SelectPrimitive.Root\n\nconst SelectGroup = SelectPrimitive.Group\n\nconst SelectValue = SelectPrimitive.Value\n\nconst SelectTrigger = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex h-9 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background data-[placeholder]:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <SelectPrimitive.Icon asChild>\n      <ChevronDown className=\"h-4 w-4 opacity-50\" />\n    </SelectPrimitive.Icon>\n  </SelectPrimitive.Trigger>\n))\nSelectTrigger.displayName = SelectPrimitive.Trigger.displayName\n\nconst SelectScrollUpButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollUpButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollUpButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollUpButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronUp className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollUpButton>\n))\nSelectScrollUpButton.displayName = SelectPrimitive.ScrollUpButton.displayName\n\nconst SelectScrollDownButton = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.ScrollDownButton>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.ScrollDownButton>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.ScrollDownButton\n    ref={ref}\n    className={cn(\n      \"flex cursor-default items-center justify-center py-1\",\n      className\n    )}\n    {...props}\n  >\n    <ChevronDown className=\"h-4 w-4\" />\n  </SelectPrimitive.ScrollDownButton>\n))\nSelectScrollDownButton.displayName =\n  SelectPrimitive.ScrollDownButton.displayName\n\nconst SelectContent = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Content>\n>(({ className, children, position = \"popper\", ...props }, ref) => (\n  <SelectPrimitive.Portal>\n    <SelectPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"relative z-50 max-h-[--radix-select-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-select-content-transform-origin]\",\n        position === \"popper\" &&\n          \"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1\",\n        className\n      )}\n      position={position}\n      {...props}\n    >\n      <SelectScrollUpButton />\n      <SelectPrimitive.Viewport\n        className={cn(\n          \"p-1\",\n          position === \"popper\" &&\n            \"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]\"\n        )}\n      >\n        {children}\n      </SelectPrimitive.Viewport>\n      <SelectScrollDownButton />\n    </SelectPrimitive.Content>\n  </SelectPrimitive.Portal>\n))\nSelectContent.displayName = SelectPrimitive.Content.displayName\n\nconst SelectLabel = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Label>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Label\n    ref={ref}\n    className={cn(\"py-1.5 pl-8 pr-2 text-sm font-semibold\", className)}\n    {...props}\n  />\n))\nSelectLabel.displayName = SelectPrimitive.Label.displayName\n\nconst SelectItem = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Item>\n>(({ className, children, ...props }, ref) => (\n  <SelectPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <SelectPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </SelectPrimitive.ItemIndicator>\n    </span>\n\n    <SelectPrimitive.ItemText>{children}</SelectPrimitive.ItemText>\n  </SelectPrimitive.Item>\n))\nSelectItem.displayName = SelectPrimitive.Item.displayName\n\nconst SelectSeparator = React.forwardRef<\n  React.ElementRef<typeof SelectPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof SelectPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <SelectPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nSelectSeparator.displayName = SelectPrimitive.Separator.displayName\n\nexport {\n  Select,\n  SelectGroup,\n  SelectValue,\n  SelectTrigger,\n  SelectContent,\n  SelectLabel,\n  SelectItem,\n  SelectSeparator,\n  SelectScrollUpButton,\n  SelectScrollDownButton,\n}\n","path":null,"size_bytes":5741,"size_tokens":null},"client/src/components/ui/menubar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as MenubarPrimitive from \"@radix-ui/react-menubar\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nfunction MenubarMenu({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Menu>) {\n  return <MenubarPrimitive.Menu {...props} />\n}\n\nfunction MenubarGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Group>) {\n  return <MenubarPrimitive.Group {...props} />\n}\n\nfunction MenubarPortal({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Portal>) {\n  return <MenubarPrimitive.Portal {...props} />\n}\n\nfunction MenubarRadioGroup({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.RadioGroup>) {\n  return <MenubarPrimitive.RadioGroup {...props} />\n}\n\nfunction MenubarSub({\n  ...props\n}: React.ComponentProps<typeof MenubarPrimitive.Sub>) {\n  return <MenubarPrimitive.Sub data-slot=\"menubar-sub\" {...props} />\n}\n\nconst Menubar = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Root>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"flex h-10 items-center space-x-1 rounded-md border bg-background p-1\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubar.displayName = MenubarPrimitive.Root.displayName\n\nconst MenubarTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Trigger>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Trigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-3 py-1.5 text-sm font-medium outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarTrigger.displayName = MenubarPrimitive.Trigger.displayName\n\nconst MenubarSubTrigger = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <MenubarPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </MenubarPrimitive.SubTrigger>\n))\nMenubarSubTrigger.displayName = MenubarPrimitive.SubTrigger.displayName\n\nconst MenubarSubContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarSubContent.displayName = MenubarPrimitive.SubContent.displayName\n\nconst MenubarContent = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Content>\n>(\n  (\n    { className, align = \"start\", alignOffset = -4, sideOffset = 8, ...props },\n    ref\n  ) => (\n    <MenubarPrimitive.Portal>\n      <MenubarPrimitive.Content\n        ref={ref}\n        align={align}\n        alignOffset={alignOffset}\n        sideOffset={sideOffset}\n        className={cn(\n          \"z-50 min-w-[12rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-menubar-content-transform-origin]\",\n          className\n        )}\n        {...props}\n      />\n    </MenubarPrimitive.Portal>\n  )\n)\nMenubarContent.displayName = MenubarPrimitive.Content.displayName\n\nconst MenubarItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarItem.displayName = MenubarPrimitive.Item.displayName\n\nconst MenubarCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <MenubarPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.CheckboxItem>\n))\nMenubarCheckboxItem.displayName = MenubarPrimitive.CheckboxItem.displayName\n\nconst MenubarRadioItem = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <MenubarPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <MenubarPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </MenubarPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </MenubarPrimitive.RadioItem>\n))\nMenubarRadioItem.displayName = MenubarPrimitive.RadioItem.displayName\n\nconst MenubarLabel = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <MenubarPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nMenubarLabel.displayName = MenubarPrimitive.Label.displayName\n\nconst MenubarSeparator = React.forwardRef<\n  React.ElementRef<typeof MenubarPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof MenubarPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <MenubarPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nMenubarSeparator.displayName = MenubarPrimitive.Separator.displayName\n\nconst MenubarShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nMenubarShortcut.displayname = \"MenubarShortcut\"\n\nexport {\n  Menubar,\n  MenubarMenu,\n  MenubarTrigger,\n  MenubarContent,\n  MenubarItem,\n  MenubarSeparator,\n  MenubarLabel,\n  MenubarCheckboxItem,\n  MenubarRadioGroup,\n  MenubarRadioItem,\n  MenubarPortal,\n  MenubarSubContent,\n  MenubarSubTrigger,\n  MenubarGroup,\n  MenubarSub,\n  MenubarShortcut,\n}\n","path":null,"size_bytes":8605,"size_tokens":null},"client/src/lib/gameData.ts":{"content":"export interface Question {\n  id: number;\n  text: string;\n  options: string[];\n  correctIndex: number;\n  complexity: 1 | 2 | 3 | 4 | 5;\n}\n\nexport interface SessionHistoryEntry {\n  sessionNumber: number;\n  level: number;\n  scorePercent: number;\n  outcome: \"learned\" | \"neutral\" | \"lost\";\n  timestamp: number;\n}\n\nexport interface GameState {\n  intelligenceLevel: number;\n  intelligenceScore: number;\n  totalSessions: number;\n  bestScorePercent: number;\n  currentLevel: number;\n  maxUnlockedLevel: number;\n  styleCredits: number;\n  ownedSkins: string[];\n  ownedAuras: string[];\n  equippedSkin: string;\n  equippedAura: string | null;\n  sessionHistory: SessionHistoryEntry[];\n  hasSeenIntro: boolean;\n}\n\nexport const STORAGE_KEY = \"trainYourAIState\";\n\nexport const DEFAULT_STATE: GameState = {\n  intelligenceLevel: 1,\n  intelligenceScore: 0,\n  totalSessions: 0,\n  bestScorePercent: 0,\n  currentLevel: 1,\n  maxUnlockedLevel: 1,\n  styleCredits: 200,\n  ownedSkins: [\"skin_default\"],\n  ownedAuras: [],\n  equippedSkin: \"skin_default\",\n  equippedAura: null,\n  sessionHistory: [],\n  hasSeenIntro: false,\n};\n\nexport function loadStateFromStorage(): GameState {\n  try {\n    const saved = localStorage.getItem(STORAGE_KEY);\n    if (saved) {\n      const parsed = JSON.parse(saved);\n      \n      // Validate that parsed is an object\n      if (typeof parsed !== \"object\" || parsed === null) {\n        console.warn(\"Invalid saved state format, resetting to defaults\");\n        return { ...DEFAULT_STATE };\n      }\n      \n      const state = { ...DEFAULT_STATE, ...parsed };\n      \n      // Validate and sanitize numeric values\n      if (typeof state.intelligenceLevel !== \"number\" || state.intelligenceLevel < 1) {\n        state.intelligenceLevel = 1;\n      }\n      if (typeof state.intelligenceScore !== \"number\" || state.intelligenceScore < 0) {\n        state.intelligenceScore = 0;\n      }\n      if (typeof state.totalSessions !== \"number\" || state.totalSessions < 0) {\n        state.totalSessions = 0;\n      }\n      if (typeof state.bestScorePercent !== \"number\" || state.bestScorePercent < 0 || state.bestScorePercent > 100) {\n        state.bestScorePercent = 0;\n      }\n      if (typeof state.currentLevel !== \"number\" || state.currentLevel < 1) {\n        state.currentLevel = 1;\n      }\n      if (typeof state.maxUnlockedLevel !== \"number\" || state.maxUnlockedLevel < 1) {\n        state.maxUnlockedLevel = 1;\n      }\n      if (state.currentLevel > state.maxUnlockedLevel) {\n        state.currentLevel = state.maxUnlockedLevel;\n      }\n      if (typeof state.styleCredits !== \"number\" || state.styleCredits < 0) {\n        state.styleCredits = 200;\n      }\n      \n      // Validate arrays\n      if (!Array.isArray(state.ownedSkins)) state.ownedSkins = [\"skin_default\"];\n      if (!state.ownedSkins.includes(\"skin_default\")) state.ownedSkins.push(\"skin_default\");\n      if (!Array.isArray(state.ownedAuras)) state.ownedAuras = [];\n      if (!Array.isArray(state.sessionHistory)) state.sessionHistory = [];\n      \n      // Validate strings\n      if (typeof state.equippedSkin !== \"string\" || !state.equippedSkin) {\n        state.equippedSkin = \"skin_default\";\n      }\n      if (state.equippedAura !== null && typeof state.equippedAura !== \"string\") {\n        state.equippedAura = null;\n      }\n      \n      // Validate boolean\n      if (typeof state.hasSeenIntro !== \"boolean\") {\n        state.hasSeenIntro = false;\n      }\n      \n      return state;\n    }\n  } catch (e) {\n    console.error(\"Failed to load state from storage:\", e);\n  }\n  return { ...DEFAULT_STATE };\n}\n\nexport function clearStateFromStorage(): void {\n  try {\n    localStorage.removeItem(STORAGE_KEY);\n  } catch (e) {\n    console.error(\"Failed to clear state from storage:\", e);\n  }\n}\n\nexport function saveStateToStorage(state: GameState): void {\n  try {\n    localStorage.setItem(STORAGE_KEY, JSON.stringify(state));\n  } catch (e) {\n    console.error(\"Failed to save state to storage:\", e);\n  }\n}\n\nexport function getAIAvatar(level: number): { emoji: string; caption: string } {\n  if (level <= 3) {\n    return { emoji: \"\\u{1F916}\\u{1F4A4}\", caption: \"Very basic model\" };\n  } else if (level <= 7) {\n    return { emoji: \"\\u{1F916}\\u{1F4DA}\", caption: \"Learning well\" };\n  } else if (level <= 15) {\n    return { emoji: \"\\u{1F916}\\u{1F680}\", caption: \"Highly trained\" };\n  } else {\n    return { emoji: \"\\u{1F916}\\u2728\", caption: \"Elite intelligence\" };\n  }\n}\n\nexport function getDifficultyLabel(level: number): string {\n  if (level <= 3) return \"Easy\";\n  if (level <= 9) return \"Normal\";\n  if (level <= 15) return \"Advanced\";\n  return \"Expert\";\n}\n\nexport function getPassThreshold(level: number): number {\n  if (level <= 10) return 70;\n  if (level <= 20) return 80;\n  return 90;\n}\n\nexport const QUESTION_BANK: Question[] = [\n  { id: 1, text: \"What is the capital of France?\", options: [\"Berlin\", \"Paris\", \"Madrid\", \"Rome\"], correctIndex: 1, complexity: 1 },\n  { id: 2, text: \"What is 12 + 8?\", options: [\"18\", \"20\", \"22\", \"19\"], correctIndex: 1, complexity: 1 },\n  { id: 3, text: \"Which planet is known as the Red Planet?\", options: [\"Venus\", \"Mars\", \"Jupiter\", \"Saturn\"], correctIndex: 1, complexity: 1 },\n  { id: 4, text: \"How many days are in a week?\", options: [\"5\", \"6\", \"7\", \"8\"], correctIndex: 2, complexity: 1 },\n  { id: 5, text: \"What is the largest ocean on Earth?\", options: [\"Atlantic\", \"Indian\", \"Arctic\", \"Pacific\"], correctIndex: 3, complexity: 1 },\n  { id: 6, text: \"Which gas do plants absorb from the atmosphere?\", options: [\"Oxygen\", \"Nitrogen\", \"Carbon Dioxide\", \"Hydrogen\"], correctIndex: 2, complexity: 1 },\n  { id: 7, text: \"What is the boiling point of water in Celsius?\", options: [\"90\", \"100\", \"110\", \"120\"], correctIndex: 1, complexity: 2 },\n  { id: 8, text: \"Who wrote 'Romeo and Juliet'?\", options: [\"Charles Dickens\", \"William Shakespeare\", \"Jane Austen\", \"Mark Twain\"], correctIndex: 1, complexity: 2 },\n  { id: 9, text: \"What is the chemical symbol for gold?\", options: [\"Go\", \"Gd\", \"Au\", \"Ag\"], correctIndex: 2, complexity: 2 },\n  { id: 10, text: \"Which country has the largest population?\", options: [\"India\", \"USA\", \"China\", \"Brazil\"], correctIndex: 2, complexity: 2 },\n  { id: 11, text: \"What is 15% of 200?\", options: [\"25\", \"30\", \"35\", \"40\"], correctIndex: 1, complexity: 2 },\n  { id: 12, text: \"What is the square root of 144?\", options: [\"10\", \"11\", \"12\", \"14\"], correctIndex: 2, complexity: 2 },\n  { id: 13, text: \"Which element has the atomic number 1?\", options: [\"Helium\", \"Hydrogen\", \"Oxygen\", \"Carbon\"], correctIndex: 1, complexity: 2 },\n  { id: 14, text: \"In what year did World War II end?\", options: [\"1943\", \"1944\", \"1945\", \"1946\"], correctIndex: 2, complexity: 2 },\n  { id: 15, text: \"What is the speed of light in a vacuum (approx)?\", options: [\"300,000 m/s\", \"300,000 km/s\", \"300 km/s\", \"3,000 km/s\"], correctIndex: 1, complexity: 3 },\n  { id: 16, text: \"What is the derivative of x^2 with respect to x?\", options: [\"x\", \"2x\", \"x^2\", \"2\"], correctIndex: 1, complexity: 3 },\n  { id: 17, text: \"Which programming language was created by Guido van Rossum?\", options: [\"JavaScript\", \"Ruby\", \"Python\", \"Java\"], correctIndex: 2, complexity: 3 },\n  { id: 18, text: \"What is the primary function of mitochondria?\", options: [\"Protein synthesis\", \"Energy production\", \"Cell division\", \"Waste removal\"], correctIndex: 1, complexity: 3 },\n  { id: 19, text: \"What is the capital of Australia?\", options: [\"Sydney\", \"Melbourne\", \"Canberra\", \"Brisbane\"], correctIndex: 2, complexity: 3 },\n  { id: 20, text: \"In binary, what is the decimal number 10?\", options: [\"1010\", \"1001\", \"1100\", \"0110\"], correctIndex: 0, complexity: 3 },\n  { id: 21, text: \"What is the value of pi to two decimal places?\", options: [\"3.12\", \"3.14\", \"3.16\", \"3.18\"], correctIndex: 1, complexity: 3 },\n  { id: 22, text: \"Which sorting algorithm has the best average-case time complexity?\", options: [\"Bubble Sort\", \"Selection Sort\", \"Merge Sort\", \"Insertion Sort\"], correctIndex: 2, complexity: 4 },\n  { id: 23, text: \"What is the time complexity of binary search?\", options: [\"O(n)\", \"O(log n)\", \"O(n log n)\", \"O(n^2)\"], correctIndex: 1, complexity: 4 },\n  { id: 24, text: \"In economics, what does GDP stand for?\", options: [\"General Domestic Product\", \"Gross Domestic Product\", \"Global Domestic Product\", \"Gross Development Product\"], correctIndex: 1, complexity: 3 },\n  { id: 25, text: \"What is Avogadro's number (approx)?\", options: [\"6.02 x 10^23\", \"6.02 x 10^20\", \"3.14 x 10^23\", \"1.38 x 10^23\"], correctIndex: 0, complexity: 4 },\n  { id: 26, text: \"Which data structure uses LIFO principle?\", options: [\"Queue\", \"Stack\", \"Array\", \"Linked List\"], correctIndex: 1, complexity: 3 },\n  { id: 27, text: \"What is the integral of 2x dx?\", options: [\"x^2 + C\", \"2x^2 + C\", \"x + C\", \"2 + C\"], correctIndex: 0, complexity: 4 },\n  { id: 28, text: \"In machine learning, what does 'overfitting' mean?\", options: [\"Model is too simple\", \"Model learns noise in training data\", \"Model has too few parameters\", \"Model trains too slowly\"], correctIndex: 1, complexity: 4 },\n  { id: 29, text: \"What is the half-life of Carbon-14 (approx)?\", options: [\"5,730 years\", \"1,000 years\", \"50,000 years\", \"100 years\"], correctIndex: 0, complexity: 4 },\n  { id: 30, text: \"Which theorem states that a^2 + b^2 = c^2 for right triangles?\", options: [\"Fermat's Last Theorem\", \"Pythagorean Theorem\", \"Euler's Theorem\", \"Bayes' Theorem\"], correctIndex: 1, complexity: 2 },\n  { id: 31, text: \"What is the Heisenberg Uncertainty Principle about?\", options: [\"Energy conservation\", \"Momentum and position limits\", \"Speed of light\", \"Quantum entanglement\"], correctIndex: 1, complexity: 5 },\n  { id: 32, text: \"In cryptography, what is a 'nonce'?\", options: [\"Encryption key\", \"Number used once\", \"Hash function\", \"Digital signature\"], correctIndex: 1, complexity: 5 },\n  { id: 33, text: \"What is the computational class of the Halting Problem?\", options: [\"P\", \"NP\", \"NP-Complete\", \"Undecidable\"], correctIndex: 3, complexity: 5 },\n  { id: 34, text: \"In blockchain, what is a 'Merkle tree' used for?\", options: [\"Mining\", \"Data integrity verification\", \"Wallet generation\", \"Token transfers\"], correctIndex: 1, complexity: 5 },\n  { id: 35, text: \"What is the Big O notation for accessing an element by index in an array?\", options: [\"O(1)\", \"O(n)\", \"O(log n)\", \"O(n^2)\"], correctIndex: 0, complexity: 3 },\n  { id: 36, text: \"Which HTTP status code indicates 'Not Found'?\", options: [\"200\", \"301\", \"404\", \"500\"], correctIndex: 2, complexity: 2 },\n  { id: 37, text: \"What does SQL stand for?\", options: [\"Simple Query Language\", \"Structured Query Language\", \"System Query Language\", \"Standard Query Logic\"], correctIndex: 1, complexity: 2 },\n  { id: 38, text: \"In physics, what is the unit of electrical resistance?\", options: [\"Volt\", \"Ampere\", \"Watt\", \"Ohm\"], correctIndex: 3, complexity: 3 },\n  { id: 39, text: \"What is the formula for kinetic energy?\", options: [\"mv\", \"1/2 mv^2\", \"mgh\", \"ma\"], correctIndex: 1, complexity: 4 },\n  { id: 40, text: \"Which layer of the OSI model handles routing?\", options: [\"Data Link\", \"Transport\", \"Network\", \"Session\"], correctIndex: 2, complexity: 4 },\n  { id: 41, text: \"What is the main purpose of DNS?\", options: [\"Encrypt data\", \"Resolve domain names to IPs\", \"Route packets\", \"Compress files\"], correctIndex: 1, complexity: 3 },\n  { id: 42, text: \"In probability, what is P(A and B) if A and B are independent?\", options: [\"P(A) + P(B)\", \"P(A) - P(B)\", \"P(A) * P(B)\", \"P(A) / P(B)\"], correctIndex: 2, complexity: 4 },\n  { id: 43, text: \"What is Euler's number (e) approximately equal to?\", options: [\"2.718\", \"3.141\", \"1.618\", \"2.303\"], correctIndex: 0, complexity: 4 },\n  { id: 44, text: \"Which algorithm is used to find the shortest path in a weighted graph?\", options: [\"DFS\", \"BFS\", \"Dijkstra's\", \"Binary Search\"], correctIndex: 2, complexity: 4 },\n  { id: 45, text: \"What is the Schwarzschild radius related to?\", options: [\"Nuclear fusion\", \"Black holes\", \"Planetary orbits\", \"Star formation\"], correctIndex: 1, complexity: 5 },\n  { id: 46, text: \"What does 'CPU' stand for in computing?\", options: [\"Central Processing Unit\", \"Computer Personal Unit\", \"Core Processor Utility\", \"Central Power Unit\"], correctIndex: 0, complexity: 1 },\n  { id: 47, text: \"What is the largest mammal on Earth?\", options: [\"African Elephant\", \"Blue Whale\", \"Giraffe\", \"Polar Bear\"], correctIndex: 1, complexity: 1 },\n  { id: 48, text: \"Who painted the Mona Lisa?\", options: [\"Vincent van Gogh\", \"Pablo Picasso\", \"Leonardo da Vinci\", \"Michelangelo\"], correctIndex: 2, complexity: 2 },\n  { id: 49, text: \"What is the capital of Japan?\", options: [\"Seoul\", \"Beijing\", \"Tokyo\", \"Bangkok\"], correctIndex: 2, complexity: 1 },\n  { id: 50, text: \"Which programming language is known for its use in web browsers?\", options: [\"Python\", \"JavaScript\", \"C++\", \"Java\"], correctIndex: 1, complexity: 2 },\n];\n\nexport function selectQuestionsForLevel(level: number, count: number = 10): Question[] {\n  let targetComplexities: number[];\n  \n  if (level <= 3) {\n    targetComplexities = [1, 1, 1, 1, 1, 2, 2, 1, 1, 1];\n  } else if (level <= 6) {\n    targetComplexities = [1, 2, 2, 2, 2, 2, 2, 3, 2, 1];\n  } else if (level <= 9) {\n    targetComplexities = [2, 2, 3, 3, 3, 3, 3, 4, 2, 2];\n  } else if (level <= 12) {\n    targetComplexities = [3, 3, 3, 4, 4, 4, 4, 4, 5, 3];\n  } else {\n    targetComplexities = [4, 4, 4, 5, 5, 5, 5, 5, 5, 4];\n  }\n\n  const selectedQuestions: Question[] = [];\n  const usedIds = new Set<number>();\n\n  for (let i = 0; i < count; i++) {\n    const targetComplexity = targetComplexities[i % targetComplexities.length];\n    const candidates = QUESTION_BANK.filter(\n      (q) => !usedIds.has(q.id) && q.complexity === targetComplexity\n    );\n\n    if (candidates.length > 0) {\n      const randomQ = candidates[Math.floor(Math.random() * candidates.length)];\n      selectedQuestions.push(randomQ);\n      usedIds.add(randomQ.id);\n    } else {\n      const fallback = QUESTION_BANK.filter((q) => !usedIds.has(q.id));\n      if (fallback.length > 0) {\n        const randomQ = fallback[Math.floor(Math.random() * fallback.length)];\n        selectedQuestions.push(randomQ);\n        usedIds.add(randomQ.id);\n      }\n    }\n  }\n\n  for (let i = selectedQuestions.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [selectedQuestions[i], selectedQuestions[j]] = [selectedQuestions[j], selectedQuestions[i]];\n  }\n\n  return selectedQuestions;\n}\n\nexport function shuffleQuestions(questionsArray: Question[]): Question[] {\n  const shuffled = [...questionsArray];\n  for (let i = shuffled.length - 1; i > 0; i--) {\n    const j = Math.floor(Math.random() * (i + 1));\n    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];\n  }\n  return shuffled;\n}\n\nexport const questions = QUESTION_BANK.slice(0, 10);\n","path":null,"size_bytes":14779,"size_tokens":null},"client/src/components/game/RecentSessions.tsx":{"content":"import { Clock, TrendingUp, Minus, TrendingDown } from \"lucide-react\";\nimport type { SessionHistoryEntry } from \"@/lib/gameData\";\n\ninterface RecentSessionsProps {\n  sessions: SessionHistoryEntry[];\n}\n\nfunction getOutcomeDisplay(outcome: SessionHistoryEntry[\"outcome\"]) {\n  switch (outcome) {\n    case \"learned\":\n      return {\n        icon: TrendingUp,\n        text: \"Learned\",\n        className: \"text-success\",\n      };\n    case \"neutral\":\n      return {\n        icon: Minus,\n        text: \"No learning\",\n        className: \"text-muted-foreground\",\n      };\n    case \"lost\":\n      return {\n        icon: TrendingDown,\n        text: \"Lost\",\n        className: \"text-destructive\",\n      };\n  }\n}\n\nexport default function RecentSessions({ sessions }: RecentSessionsProps) {\n  const recentSessions = sessions.slice(-5).reverse();\n\n  return (\n    <div className=\"space-y-2\" data-testid=\"recent-sessions\">\n      <div className=\"flex items-center gap-2\">\n        <Clock className=\"w-3.5 h-3.5 text-muted-foreground\" />\n        <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n          Recent Sessions\n        </p>\n      </div>\n      \n      {recentSessions.length === 0 ? (\n        <div\n          className=\"p-3 rounded-lg bg-background/30 border border-border/20 text-center\"\n          data-testid=\"recent-sessions-empty\"\n        >\n          <p className=\"text-xs text-muted-foreground\">\n            No sessions yet. Start your first training run to see your history here.\n          </p>\n        </div>\n      ) : (\n        <div className=\"space-y-1.5\">\n          {recentSessions.map((session, index) => {\n            const outcomeDisplay = getOutcomeDisplay(session.outcome);\n            const OutcomeIcon = outcomeDisplay.icon;\n            \n            return (\n              <div\n                key={`${session.sessionNumber}-${index}`}\n                className=\"flex items-center justify-between px-3 py-2 rounded-md bg-background/30 border border-border/20 text-xs\"\n                data-testid={`session-row-${session.sessionNumber}`}\n              >\n                <div className=\"flex items-center gap-3\">\n                  <span className=\"text-muted-foreground\">#{session.sessionNumber}</span>\n                  <span className=\"text-foreground\">Level {session.level}</span>\n                </div>\n                <div className=\"flex items-center gap-3\">\n                  <span className=\"font-medium text-foreground\">{session.scorePercent}%</span>\n                  <div className={`flex items-center gap-1 ${outcomeDisplay.className}`}>\n                    <OutcomeIcon className=\"w-3 h-3\" />\n                    <span>{outcomeDisplay.text}</span>\n                  </div>\n                </div>\n              </div>\n            );\n          })}\n        </div>\n      )}\n    </div>\n  );\n}\n","path":null,"size_bytes":2833,"size_tokens":null},"client/src/pages/not-found.tsx":{"content":"import { Card, CardContent } from \"@/components/ui/card\";\nimport { AlertCircle } from \"lucide-react\";\n\nexport default function NotFound() {\n  return (\n    <div className=\"min-h-screen w-full flex items-center justify-center bg-gray-50\">\n      <Card className=\"w-full max-w-md mx-4\">\n        <CardContent className=\"pt-6\">\n          <div className=\"flex mb-4 gap-2\">\n            <AlertCircle className=\"h-8 w-8 text-red-500\" />\n            <h1 className=\"text-2xl font-bold text-gray-900\">404 Page Not Found</h1>\n          </div>\n\n          <p className=\"mt-4 text-sm text-gray-600\">\n            Did you forget to add the page to the router?\n          </p>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n","path":null,"size_bytes":711,"size_tokens":null},"client/src/components/ui/tooltip.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as TooltipPrimitive from \"@radix-ui/react-tooltip\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst TooltipProvider = TooltipPrimitive.Provider\n\nconst Tooltip = TooltipPrimitive.Root\n\nconst TooltipTrigger = TooltipPrimitive.Trigger\n\nconst TooltipContent = React.forwardRef<\n  React.ElementRef<typeof TooltipPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof TooltipPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <TooltipPrimitive.Content\n    ref={ref}\n    sideOffset={sideOffset}\n    className={cn(\n      \"z-50 overflow-hidden rounded-md border bg-popover px-3 py-1.5 text-sm text-popover-foreground shadow-md animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-tooltip-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nTooltipContent.displayName = TooltipPrimitive.Content.displayName\n\nexport { Tooltip, TooltipTrigger, TooltipContent, TooltipProvider }\n","path":null,"size_bytes":1209,"size_tokens":null},"client/src/components/ui/navigation-menu.tsx":{"content":"import * as React from \"react\"\nimport * as NavigationMenuPrimitive from \"@radix-ui/react-navigation-menu\"\nimport { cva } from \"class-variance-authority\"\nimport { ChevronDown } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst NavigationMenu = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Root>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Root\n    ref={ref}\n    className={cn(\n      \"relative z-10 flex max-w-max flex-1 items-center justify-center\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <NavigationMenuViewport />\n  </NavigationMenuPrimitive.Root>\n))\nNavigationMenu.displayName = NavigationMenuPrimitive.Root.displayName\n\nconst NavigationMenuList = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.List>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.List>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.List\n    ref={ref}\n    className={cn(\n      \"group flex flex-1 list-none items-center justify-center space-x-1\",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuList.displayName = NavigationMenuPrimitive.List.displayName\n\nconst NavigationMenuItem = NavigationMenuPrimitive.Item\n\nconst navigationMenuTriggerStyle = cva(\n  \"group inline-flex h-10 w-max items-center justify-center rounded-md bg-background px-4 py-2 text-sm font-medium transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground focus:outline-none disabled:pointer-events-none disabled:opacity-50 data-[state=open]:text-accent-foreground data-[state=open]:bg-accent/50 data-[state=open]:hover:bg-accent data-[state=open]:focus:bg-accent\"\n)\n\nconst NavigationMenuTrigger = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Trigger>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Trigger>\n>(({ className, children, ...props }, ref) => (\n  <NavigationMenuPrimitive.Trigger\n    ref={ref}\n    className={cn(navigationMenuTriggerStyle(), \"group\", className)}\n    {...props}\n  >\n    {children}{\" \"}\n    <ChevronDown\n      className=\"relative top-[1px] ml-1 h-3 w-3 transition duration-200 group-data-[state=open]:rotate-180\"\n      aria-hidden=\"true\"\n    />\n  </NavigationMenuPrimitive.Trigger>\n))\nNavigationMenuTrigger.displayName = NavigationMenuPrimitive.Trigger.displayName\n\nconst NavigationMenuContent = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Content\n    ref={ref}\n    className={cn(\n      \"left-0 top-0 w-full data-[motion^=from-]:animate-in data-[motion^=to-]:animate-out data-[motion^=from-]:fade-in data-[motion^=to-]:fade-out data-[motion=from-end]:slide-in-from-right-52 data-[motion=from-start]:slide-in-from-left-52 data-[motion=to-end]:slide-out-to-right-52 data-[motion=to-start]:slide-out-to-left-52 md:absolute md:w-auto \",\n      className\n    )}\n    {...props}\n  />\n))\nNavigationMenuContent.displayName = NavigationMenuPrimitive.Content.displayName\n\nconst NavigationMenuLink = NavigationMenuPrimitive.Link\n\nconst NavigationMenuViewport = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Viewport>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Viewport>\n>(({ className, ...props }, ref) => (\n  <div className={cn(\"absolute left-0 top-full flex justify-center\")}>\n    <NavigationMenuPrimitive.Viewport\n      className={cn(\n        \"origin-top-center relative mt-1.5 h-[var(--radix-navigation-menu-viewport-height)] w-full overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-90 md:w-[var(--radix-navigation-menu-viewport-width)]\",\n        className\n      )}\n      ref={ref}\n      {...props}\n    />\n  </div>\n))\nNavigationMenuViewport.displayName =\n  NavigationMenuPrimitive.Viewport.displayName\n\nconst NavigationMenuIndicator = React.forwardRef<\n  React.ElementRef<typeof NavigationMenuPrimitive.Indicator>,\n  React.ComponentPropsWithoutRef<typeof NavigationMenuPrimitive.Indicator>\n>(({ className, ...props }, ref) => (\n  <NavigationMenuPrimitive.Indicator\n    ref={ref}\n    className={cn(\n      \"top-full z-[1] flex h-1.5 items-end justify-center overflow-hidden data-[state=visible]:animate-in data-[state=hidden]:animate-out data-[state=hidden]:fade-out data-[state=visible]:fade-in\",\n      className\n    )}\n    {...props}\n  >\n    <div className=\"relative top-[60%] h-2 w-2 rotate-45 rounded-tl-sm bg-border shadow-md\" />\n  </NavigationMenuPrimitive.Indicator>\n))\nNavigationMenuIndicator.displayName =\n  NavigationMenuPrimitive.Indicator.displayName\n\nexport {\n  navigationMenuTriggerStyle,\n  NavigationMenu,\n  NavigationMenuList,\n  NavigationMenuItem,\n  NavigationMenuContent,\n  NavigationMenuTrigger,\n  NavigationMenuLink,\n  NavigationMenuIndicator,\n  NavigationMenuViewport,\n}\n","path":null,"size_bytes":5128,"size_tokens":null},"server/static.ts":{"content":"import express, { type Express } from \"express\";\nimport fs from \"fs\";\nimport path from \"path\";\n\nexport function serveStatic(app: Express) {\n  const distPath = path.resolve(__dirname, \"public\");\n  if (!fs.existsSync(distPath)) {\n    throw new Error(\n      `Could not find the build directory: ${distPath}, make sure to build the client first`,\n    );\n  }\n\n  app.use(express.static(distPath));\n\n  // fall through to index.html if the file doesn't exist\n  app.use(\"*\", (_req, res) => {\n    res.sendFile(path.resolve(distPath, \"index.html\"));\n  });\n}\n","path":null,"size_bytes":547,"size_tokens":null},"client/src/components/ui/table.tsx":{"content":"import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Table = React.forwardRef<\n  HTMLTableElement,\n  React.HTMLAttributes<HTMLTableElement>\n>(({ className, ...props }, ref) => (\n  <div className=\"relative w-full overflow-auto\">\n    <table\n      ref={ref}\n      className={cn(\"w-full caption-bottom text-sm\", className)}\n      {...props}\n    />\n  </div>\n))\nTable.displayName = \"Table\"\n\nconst TableHeader = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <thead ref={ref} className={cn(\"[&_tr]:border-b\", className)} {...props} />\n))\nTableHeader.displayName = \"TableHeader\"\n\nconst TableBody = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tbody\n    ref={ref}\n    className={cn(\"[&_tr:last-child]:border-0\", className)}\n    {...props}\n  />\n))\nTableBody.displayName = \"TableBody\"\n\nconst TableFooter = React.forwardRef<\n  HTMLTableSectionElement,\n  React.HTMLAttributes<HTMLTableSectionElement>\n>(({ className, ...props }, ref) => (\n  <tfoot\n    ref={ref}\n    className={cn(\n      \"border-t bg-muted/50 font-medium [&>tr]:last:border-b-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableFooter.displayName = \"TableFooter\"\n\nconst TableRow = React.forwardRef<\n  HTMLTableRowElement,\n  React.HTMLAttributes<HTMLTableRowElement>\n>(({ className, ...props }, ref) => (\n  <tr\n    ref={ref}\n    className={cn(\n      \"border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted\",\n      className\n    )}\n    {...props}\n  />\n))\nTableRow.displayName = \"TableRow\"\n\nconst TableHead = React.forwardRef<\n  HTMLTableCellElement,\n  React.ThHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <th\n    ref={ref}\n    className={cn(\n      \"h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0\",\n      className\n    )}\n    {...props}\n  />\n))\nTableHead.displayName = \"TableHead\"\n\nconst TableCell = React.forwardRef<\n  HTMLTableCellElement,\n  React.TdHTMLAttributes<HTMLTableCellElement>\n>(({ className, ...props }, ref) => (\n  <td\n    ref={ref}\n    className={cn(\"p-4 align-middle [&:has([role=checkbox])]:pr-0\", className)}\n    {...props}\n  />\n))\nTableCell.displayName = \"TableCell\"\n\nconst TableCaption = React.forwardRef<\n  HTMLTableCaptionElement,\n  React.HTMLAttributes<HTMLTableCaptionElement>\n>(({ className, ...props }, ref) => (\n  <caption\n    ref={ref}\n    className={cn(\"mt-4 text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nTableCaption.displayName = \"TableCaption\"\n\nexport {\n  Table,\n  TableHeader,\n  TableBody,\n  TableFooter,\n  TableHead,\n  TableRow,\n  TableCell,\n  TableCaption,\n}\n","path":null,"size_bytes":2765,"size_tokens":null},"client/src/components/game/HomeScreen.tsx":{"content":"import { useState } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Play, Sparkles, ShoppingBag, Wallet, ExternalLink, AlertTriangle, Database } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { GameState } from \"@/lib/gameData\";\nimport { MINIMUM_TOKENS_REQUIRED, getLastTokenDebugInfo } from \"@/lib/solanaWallet\";\nimport AIAvatar from \"./AIAvatar\";\nimport StatsGrid from \"./StatsGrid\";\nimport IntelligenceProgressBar from \"./IntelligenceProgressBar\";\nimport TrainingRules from \"./TrainingRules\";\nimport LevelSelector from \"./LevelSelector\";\nimport AIChat from \"./AIChat\";\nimport CosmeticsShop from \"./CosmeticsShop\";\nimport IntroBanner from \"./IntroBanner\";\nimport HowItWorks from \"./HowItWorks\";\nimport RecentSessions from \"./RecentSessions\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\n\ninterface HomeScreenProps {\n  state: GameState;\n  onStartTraining: () => void;\n  onLevelChange: (newLevel: number) => void;\n  onBuySkin: (skinId: string) => void;\n  onBuyAura: (auraId: string) => void;\n  onEquipSkin: (skinId: string) => void;\n  onEquipAura: (auraId: string) => void;\n  onDismissIntro: () => void;\n  walletAddress: string | null;\n  tokenBalance: number;\n  isLoadingBalance: boolean;\n  requiredHiveAmount?: number;\n}\n\nexport default function HomeScreen({\n  state,\n  onStartTraining,\n  onLevelChange,\n  onBuySkin,\n  onBuyAura,\n  onEquipSkin,\n  onEquipAura,\n  onDismissIntro,\n  walletAddress,\n  tokenBalance,\n  isLoadingBalance,\n  requiredHiveAmount = 50,\n}: HomeScreenProps) {\n  const [showShop, setShowShop] = useState(false);\n\n  const isConnected = !!walletAddress;\n  const hasEnoughTokens = tokenBalance >= MINIMUM_TOKENS_REQUIRED;\n\n  // Gate ALL features behind wallet connection\n  if (!isConnected) {\n    return (\n      <div className=\"space-y-6\" data-testid=\"wallet-gate-screen\">\n        <Card className=\"border-primary/20 bg-gradient-to-br from-primary/5 to-transparent\">\n          <CardHeader className=\"text-center pb-2\">\n            <div className=\"mx-auto w-16 h-16 rounded-full bg-primary/10 flex items-center justify-center mb-3\">\n              <Wallet className=\"w-8 h-8 text-primary\" />\n            </div>\n            <CardTitle className=\"text-xl\">Connect Your Wallet</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <p className=\"text-sm text-muted-foreground text-center\">\n              To use Train Your AI, you need to connect your Phantom wallet with at least{\" \"}\n              <span className=\"font-semibold text-foreground\">{requiredHiveAmount} $HIVE</span>.\n            </p>\n            \n            <div className=\"bg-muted/30 rounded-lg p-4 space-y-3\">\n              <div className=\"flex items-start gap-3\">\n                <div className=\"w-6 h-6 rounded-full bg-primary/20 flex items-center justify-center text-xs font-bold text-primary shrink-0\">1</div>\n                <p className=\"text-sm text-muted-foreground\">Click the <span className=\"font-medium text-foreground\">Connect Wallet</span> button in the top bar</p>\n              </div>\n              <div className=\"flex items-start gap-3\">\n                <div className=\"w-6 h-6 rounded-full bg-primary/20 flex items-center justify-center text-xs font-bold text-primary shrink-0\">2</div>\n                <p className=\"text-sm text-muted-foreground\">Approve the connection in your Phantom wallet</p>\n              </div>\n              <div className=\"flex items-start gap-3\">\n                <div className=\"w-6 h-6 rounded-full bg-primary/20 flex items-center justify-center text-xs font-bold text-primary shrink-0\">3</div>\n                <p className=\"text-sm text-muted-foreground\">Make sure you have at least {requiredHiveAmount} $HIVE</p>\n              </div>\n            </div>\n\n            <div className=\"text-center pt-2\">\n              <a\n                href=\"https://phantom.app/\"\n                target=\"_blank\"\n                rel=\"noopener noreferrer\"\n                className=\"inline-flex items-center gap-1.5 text-sm text-primary hover:underline\"\n                data-testid=\"link-get-phantom\"\n              >\n                <ExternalLink className=\"w-3.5 h-3.5\" />\n                Don't have Phantom? Get it here\n              </a>\n            </div>\n          </CardContent>\n        </Card>\n\n        <HowItWorks />\n      </div>\n    );\n  }\n\n  // Gate features behind token requirement (wallet connected but not enough tokens)\n  if (!hasEnoughTokens && !isLoadingBalance) {\n    const debugInfo = getLastTokenDebugInfo();\n    \n    return (\n      <div className=\"space-y-6\" data-testid=\"token-gate-screen\">\n        <Card className=\"border-destructive/20 bg-gradient-to-br from-destructive/5 to-transparent\">\n          <CardHeader className=\"text-center pb-2\">\n            <div className=\"mx-auto w-16 h-16 rounded-full bg-destructive/10 flex items-center justify-center mb-3\">\n              <AlertTriangle className=\"w-8 h-8 text-destructive\" />\n            </div>\n            <CardTitle className=\"text-xl\">Insufficient Tokens</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-4\">\n            <p className=\"text-sm text-muted-foreground text-center\">\n              You need at least <span className=\"font-semibold text-foreground\">{requiredHiveAmount} $HIVE</span> to access Train Your AI.\n            </p>\n            \n            <div className=\"bg-muted/30 rounded-lg p-4 text-center\">\n              <p className=\"text-sm text-muted-foreground\">Your current balance:</p>\n              <p className=\"text-2xl font-bold text-foreground\">{tokenBalance} $HIVE</p>\n              <p className=\"text-xs text-destructive mt-1\">\n                Need {requiredHiveAmount}+ $HIVE to access protected features\n              </p>\n            </div>\n\n            <p className=\"text-xs text-muted-foreground text-center\">\n              Get more $HIVE tokens and come back to start training your AI!\n            </p>\n            \n            {/* Debug info - only shown in development */}\n            {import.meta.env.DEV && debugInfo && (\n              <div className=\"mt-4 p-3 bg-muted/50 rounded-lg border border-border/50 text-xs font-mono\">\n                <p className=\"text-muted-foreground mb-1 font-sans text-xs font-medium\">Debug Info (dev only):</p>\n                <p>Program: <span className=\"text-foreground\">{debugInfo.programUsed}</span></p>\n                <p>Raw Balance Sum: <span className=\"text-foreground\">{debugInfo.rawBalanceSum.toLocaleString()}</span></p>\n                <p>Decimals: <span className=\"text-foreground\">{debugInfo.decimals}</span></p>\n                <p>UI Amount: <span className=\"text-foreground\">{debugInfo.uiAmount}</span></p>\n                <p>Token-2022 Accounts: <span className=\"text-foreground\">{debugInfo.token2022Accounts}</span></p>\n                <p>Legacy Accounts: <span className=\"text-foreground\">{debugInfo.legacyAccounts}</span></p>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n\n        <HowItWorks />\n      </div>\n    );\n  }\n\n  if (showShop) {\n    return (\n      <CosmeticsShop\n        state={state}\n        onBack={() => setShowShop(false)}\n        onBuySkin={onBuySkin}\n        onBuyAura={onBuyAura}\n        onEquipSkin={onEquipSkin}\n        onEquipAura={onEquipAura}\n      />\n    );\n  }\n\n  return (\n    <div className=\"space-y-4\" data-testid=\"home-screen\">\n      {!state.hasSeenIntro && (\n        <IntroBanner onDismiss={onDismissIntro} />\n      )}\n\n      <div className=\"flex items-center justify-between gap-2 flex-wrap\">\n        <div className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n          Your AI Core\n        </div>\n        <div className=\"flex gap-2\">\n          <Link href=\"/corpus\">\n            <Button\n              size=\"sm\"\n              variant=\"outline\"\n              data-testid=\"button-view-corpus\"\n            >\n              <Database className=\"w-3.5 h-3.5 mr-1\" />\n              Corpus\n            </Button>\n          </Link>\n          <Button\n            size=\"sm\"\n            variant=\"outline\"\n            onClick={() => setShowShop(true)}\n            data-testid=\"button-open-shop\"\n          >\n            <ShoppingBag className=\"w-3.5 h-3.5 mr-1\" />\n            Cosmetics\n          </Button>\n        </div>\n      </div>\n\n      <div className=\"flex flex-col sm:flex-row items-center gap-4 sm:gap-5\">\n        <AIAvatar\n          intelligenceLevel={state.intelligenceLevel}\n          equippedSkin={state.equippedSkin}\n          equippedAura={state.equippedAura}\n          size=\"md\"\n        />\n        <div className=\"flex-1 w-full\">\n          <StatsGrid state={state} />\n        </div>\n      </div>\n\n      <div className=\"flex items-center justify-center gap-2 py-1\">\n        <Sparkles className=\"w-4 h-4 text-primary\" />\n        <span className=\"text-sm font-medium text-foreground\" data-testid=\"text-style-credits\">\n          Style Credits: {state.styleCredits}\n        </span>\n      </div>\n\n      <IntelligenceProgressBar\n        level={state.intelligenceLevel}\n        score={state.intelligenceScore}\n      />\n\n      <LevelSelector\n        currentLevel={state.currentLevel}\n        maxUnlockedLevel={state.maxUnlockedLevel}\n        onLevelChange={onLevelChange}\n      />\n\n      <AIChat state={state} />\n\n      <HowItWorks />\n\n      <TrainingRules />\n\n      <RecentSessions sessions={state.sessionHistory} />\n\n      <div className=\"pt-1\">\n        <Button\n          size=\"lg\"\n          className=\"w-full min-h-[44px] text-base font-semibold\"\n          onClick={onStartTraining}\n          data-testid=\"button-start-training\"\n        >\n          <Play className=\"w-4 h-4 mr-2\" />\n          Start Training Session\n        </Button>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":9759,"size_tokens":null},"replit.md":{"content":"# Train Your AI - Quiz Game\n\n## Overview\n\nA gamified AI training quiz game where users answer multiple-choice questions to make their virtual AI companion smarter or dumber based on performance. The game features an unlimited level progression system, Solana wallet integration with token-gating, and persistent state via localStorage. Built with a modern dark-themed UI inspired by gamified learning apps like Duolingo and Habitica.\n\n## User Preferences\n\nPreferred communication style: Simple, everyday language.\n\n## System Architecture\n\n### Frontend Architecture\n- **Framework**: React 18 with TypeScript\n- **Build Tool**: Vite with custom plugins for Replit integration\n- **Styling**: Tailwind CSS with CSS custom properties for theming (dark mode default)\n- **UI Components**: shadcn/ui component library (Radix UI primitives + Tailwind)\n- **State Management**: React hooks with localStorage persistence for game state\n- **Data Fetching**: TanStack React Query for API calls\n\n### Backend Architecture\n- **Runtime**: Node.js with Express\n- **Language**: TypeScript with ESM modules\n- **Build**: esbuild for production bundling with selective dependency bundling\n- **Static Serving**: Express serves Vite-built frontend from `dist/public`\n\n### Data Storage\n- **Game State**: localStorage for client-side persistence (intelligence level, scores, sessions)\n- **Database Schema**: PostgreSQL with Drizzle ORM (users table defined, ready for expansion)\n- **Schema Location**: `shared/schema.ts` with Zod validation via drizzle-zod\n\n### Key Design Patterns\n- **Screen-based Navigation**: Single-page app with show/hide screens (home, training, result)\n- **Component Composition**: Game components in `client/src/components/game/`, UI primitives in `client/src/components/ui/`\n- **Shared Code**: `shared/` directory for code used by both client and server\n- **Path Aliases**: `@/` for client source, `@shared/` for shared code\n\n### Game Mechanics\n- **Scoring Rules**: Pass thresholds scale by level (70% for L1-10, 80% for L11-20, 90% for L21+)\n- **Unlimited Levels**: Dynamic difficulty scaling with no upper bound on currentLevel or maxUnlockedLevel\n- **Question System**: 50 questions with complexity ratings (1-5), selected based on current level\n- **Level Selection**: Players can choose any unlocked level (1 to maxUnlockedLevel)\n- **AI Chat**: Intelligence-based responses that vary with intelligenceLevel (basic to elite)\n\n### Cosmetics System\n- **Style Credits**: Cosmetic-only currency (starts at 200)\n  - Earn +20 credits for 90%+ session score\n  - Earn +10 credits for 70-89% session score\n  - Persisted to localStorage\n- **Avatar Skins** (3 total):\n  - Default Core (free) - emoji changes by intelligence level\n  - Glitched Core (100 credits) - glitch animation effect\n  - Overclocked Core (200 credits) - fire/heat animation effect\n- **Aura Styles** (3 total):\n  - Neon Blue Aura (50 credits) - blue glow\n  - Neon Purple Aura (75 credits) - purple glow\n  - Neon Green Aura (100 credits) - green glow\n- **Shop UI**: Accessible from home screen, buy/equip cosmetics\n- **State**: ownedSkins, ownedAuras, equippedSkin, equippedAura saved to localStorage\n\n## External Dependencies\n\n### Blockchain Integration\n- **Solana Wallet**: Phantom wallet integration via window.solana provider (no external SDK)\n- **Token Gating**: $MEME token balance check required (50 tokens minimum) to start training\n- **RPC Endpoint**: Solana mainnet-beta API\n\n### Database\n- **PostgreSQL**: Required via `DATABASE_URL` environment variable\n- **ORM**: Drizzle ORM with drizzle-kit for migrations\n\n### UI/Design\n- **Fonts**: DM Sans, Fira Code, Geist Mono via Google Fonts\n- **Icons**: Lucide React\n- **Component Primitives**: Full Radix UI suite (dialog, dropdown, toast, etc.)\n\n### Key NPM Packages\n- `@tanstack/react-query`: Server state management\n- `drizzle-orm` + `drizzle-zod`: Database ORM with validation\n- `class-variance-authority` + `clsx` + `tailwind-merge`: Styling utilities\n- `react-hook-form` + `@hookform/resolvers`: Form handling\n- `vaul`: Drawer component\n- `embla-carousel-react`: Carousel functionality","path":null,"size_bytes":4107,"size_tokens":null},"client/src/components/ui/context-menu.tsx":{"content":"import * as React from \"react\"\nimport * as ContextMenuPrimitive from \"@radix-ui/react-context-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ContextMenu = ContextMenuPrimitive.Root\n\nconst ContextMenuTrigger = ContextMenuPrimitive.Trigger\n\nconst ContextMenuGroup = ContextMenuPrimitive.Group\n\nconst ContextMenuPortal = ContextMenuPrimitive.Portal\n\nconst ContextMenuSub = ContextMenuPrimitive.Sub\n\nconst ContextMenuRadioGroup = ContextMenuPrimitive.RadioGroup\n\nconst ContextMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <ContextMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[state=open]:bg-accent data-[state=open]:text-accent-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto h-4 w-4\" />\n  </ContextMenuPrimitive.SubTrigger>\n))\nContextMenuSubTrigger.displayName = ContextMenuPrimitive.SubTrigger.displayName\n\nconst ContextMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuSubContent.displayName = ContextMenuPrimitive.SubContent.displayName\n\nconst ContextMenuContent = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Content>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Portal>\n    <ContextMenuPrimitive.Content\n      ref={ref}\n      className={cn(\n        \"z-50 max-h-[--radix-context-menu-content-available-height] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md animate-in fade-in-80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-context-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </ContextMenuPrimitive.Portal>\n))\nContextMenuContent.displayName = ContextMenuPrimitive.Content.displayName\n\nconst ContextMenuItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuItem.displayName = ContextMenuPrimitive.Item.displayName\n\nconst ContextMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <ContextMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.CheckboxItem>\n))\nContextMenuCheckboxItem.displayName =\n  ContextMenuPrimitive.CheckboxItem.displayName\n\nconst ContextMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <ContextMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <ContextMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </ContextMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </ContextMenuPrimitive.RadioItem>\n))\nContextMenuRadioItem.displayName = ContextMenuPrimitive.RadioItem.displayName\n\nconst ContextMenuLabel = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <ContextMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold text-foreground\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nContextMenuLabel.displayName = ContextMenuPrimitive.Label.displayName\n\nconst ContextMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof ContextMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof ContextMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <ContextMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-border\", className)}\n    {...props}\n  />\n))\nContextMenuSeparator.displayName = ContextMenuPrimitive.Separator.displayName\n\nconst ContextMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\n        \"ml-auto text-xs tracking-widest text-muted-foreground\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\nContextMenuShortcut.displayName = \"ContextMenuShortcut\"\n\nexport {\n  ContextMenu,\n  ContextMenuTrigger,\n  ContextMenuContent,\n  ContextMenuItem,\n  ContextMenuCheckboxItem,\n  ContextMenuRadioItem,\n  ContextMenuLabel,\n  ContextMenuSeparator,\n  ContextMenuShortcut,\n  ContextMenuGroup,\n  ContextMenuPortal,\n  ContextMenuSub,\n  ContextMenuSubContent,\n  ContextMenuSubTrigger,\n  ContextMenuRadioGroup,\n}\n","path":null,"size_bytes":7428,"size_tokens":null},"client/src/components/ui/separator.tsx":{"content":"import * as React from \"react\"\nimport * as SeparatorPrimitive from \"@radix-ui/react-separator\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Separator = React.forwardRef<\n  React.ElementRef<typeof SeparatorPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof SeparatorPrimitive.Root>\n>(\n  (\n    { className, orientation = \"horizontal\", decorative = true, ...props },\n    ref\n  ) => (\n    <SeparatorPrimitive.Root\n      ref={ref}\n      decorative={decorative}\n      orientation={orientation}\n      className={cn(\n        \"shrink-0 bg-border\",\n        orientation === \"horizontal\" ? \"h-[1px] w-full\" : \"h-full w-[1px]\",\n        className\n      )}\n      {...props}\n    />\n  )\n)\nSeparator.displayName = SeparatorPrimitive.Root.displayName\n\nexport { Separator }\n","path":null,"size_bytes":756,"size_tokens":null},"client/src/components/examples/ScoringRulesExample.tsx":{"content":"import ScoringRules from \"../game/ScoringRules\";\n\nexport default function ScoringRulesExample() {\n  return <ScoringRules />;\n}\n","path":null,"size_bytes":127,"size_tokens":null},"client/src/components/ui/dropdown-menu.tsx":{"content":"import * as React from \"react\"\nimport * as DropdownMenuPrimitive from \"@radix-ui/react-dropdown-menu\"\nimport { Check, ChevronRight, Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst DropdownMenu = DropdownMenuPrimitive.Root\n\nconst DropdownMenuTrigger = DropdownMenuPrimitive.Trigger\n\nconst DropdownMenuGroup = DropdownMenuPrimitive.Group\n\nconst DropdownMenuPortal = DropdownMenuPrimitive.Portal\n\nconst DropdownMenuSub = DropdownMenuPrimitive.Sub\n\nconst DropdownMenuRadioGroup = DropdownMenuPrimitive.RadioGroup\n\nconst DropdownMenuSubTrigger = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubTrigger>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubTrigger> & {\n    inset?: boolean\n  }\n>(({ className, inset, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubTrigger\n    ref={ref}\n    className={cn(\n      \"flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  >\n    {children}\n    <ChevronRight className=\"ml-auto\" />\n  </DropdownMenuPrimitive.SubTrigger>\n))\nDropdownMenuSubTrigger.displayName =\n  DropdownMenuPrimitive.SubTrigger.displayName\n\nconst DropdownMenuSubContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.SubContent>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.SubContent>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.SubContent\n    ref={ref}\n    className={cn(\n      \"z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuSubContent.displayName =\n  DropdownMenuPrimitive.SubContent.displayName\n\nconst DropdownMenuContent = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Content>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Content>\n>(({ className, sideOffset = 4, ...props }, ref) => (\n  <DropdownMenuPrimitive.Portal>\n    <DropdownMenuPrimitive.Content\n      ref={ref}\n      sideOffset={sideOffset}\n      className={cn(\n        \"z-50 max-h-[var(--radix-dropdown-menu-content-available-height)] min-w-[8rem] overflow-y-auto overflow-x-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 origin-[--radix-dropdown-menu-content-transform-origin]\",\n        className\n      )}\n      {...props}\n    />\n  </DropdownMenuPrimitive.Portal>\n))\nDropdownMenuContent.displayName = DropdownMenuPrimitive.Content.displayName\n\nconst DropdownMenuItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Item> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Item\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuItem.displayName = DropdownMenuPrimitive.Item.displayName\n\nconst DropdownMenuCheckboxItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.CheckboxItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.CheckboxItem>\n>(({ className, children, checked, ...props }, ref) => (\n  <DropdownMenuPrimitive.CheckboxItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    checked={checked}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Check className=\"h-4 w-4\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.CheckboxItem>\n))\nDropdownMenuCheckboxItem.displayName =\n  DropdownMenuPrimitive.CheckboxItem.displayName\n\nconst DropdownMenuRadioItem = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.RadioItem>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.RadioItem>\n>(({ className, children, ...props }, ref) => (\n  <DropdownMenuPrimitive.RadioItem\n    ref={ref}\n    className={cn(\n      \"relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50\",\n      className\n    )}\n    {...props}\n  >\n    <span className=\"absolute left-2 flex h-3.5 w-3.5 items-center justify-center\">\n      <DropdownMenuPrimitive.ItemIndicator>\n        <Circle className=\"h-2 w-2 fill-current\" />\n      </DropdownMenuPrimitive.ItemIndicator>\n    </span>\n    {children}\n  </DropdownMenuPrimitive.RadioItem>\n))\nDropdownMenuRadioItem.displayName = DropdownMenuPrimitive.RadioItem.displayName\n\nconst DropdownMenuLabel = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Label>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Label> & {\n    inset?: boolean\n  }\n>(({ className, inset, ...props }, ref) => (\n  <DropdownMenuPrimitive.Label\n    ref={ref}\n    className={cn(\n      \"px-2 py-1.5 text-sm font-semibold\",\n      inset && \"pl-8\",\n      className\n    )}\n    {...props}\n  />\n))\nDropdownMenuLabel.displayName = DropdownMenuPrimitive.Label.displayName\n\nconst DropdownMenuSeparator = React.forwardRef<\n  React.ElementRef<typeof DropdownMenuPrimitive.Separator>,\n  React.ComponentPropsWithoutRef<typeof DropdownMenuPrimitive.Separator>\n>(({ className, ...props }, ref) => (\n  <DropdownMenuPrimitive.Separator\n    ref={ref}\n    className={cn(\"-mx-1 my-1 h-px bg-muted\", className)}\n    {...props}\n  />\n))\nDropdownMenuSeparator.displayName = DropdownMenuPrimitive.Separator.displayName\n\nconst DropdownMenuShortcut = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLSpanElement>) => {\n  return (\n    <span\n      className={cn(\"ml-auto text-xs tracking-widest opacity-60\", className)}\n      {...props}\n    />\n  )\n}\nDropdownMenuShortcut.displayName = \"DropdownMenuShortcut\"\n\nexport {\n  DropdownMenu,\n  DropdownMenuTrigger,\n  DropdownMenuContent,\n  DropdownMenuItem,\n  DropdownMenuCheckboxItem,\n  DropdownMenuRadioItem,\n  DropdownMenuLabel,\n  DropdownMenuSeparator,\n  DropdownMenuShortcut,\n  DropdownMenuGroup,\n  DropdownMenuPortal,\n  DropdownMenuSub,\n  DropdownMenuSubContent,\n  DropdownMenuSubTrigger,\n  DropdownMenuRadioGroup,\n}\n","path":null,"size_bytes":7609,"size_tokens":null},"client/src/components/game/StatsGrid.tsx":{"content":"import type { GameState } from \"@/lib/gameData\";\n\ninterface StatsGridProps {\n  state: GameState;\n}\n\ninterface StatCardProps {\n  label: string;\n  value: string | number;\n  testId: string;\n}\n\nfunction StatCard({ label, value, testId }: StatCardProps) {\n  return (\n    <div\n      className=\"p-3 rounded-lg bg-background/50 border border-border/30 text-center\"\n      data-testid={testId}\n    >\n      <p className=\"text-[10px] font-medium uppercase tracking-wider text-muted-foreground mb-0.5\">\n        {label}\n      </p>\n      <p className=\"text-xl font-bold text-foreground\">{value}</p>\n    </div>\n  );\n}\n\nexport default function StatsGrid({ state }: StatsGridProps) {\n  return (\n    <div className=\"grid grid-cols-2 gap-2\" data-testid=\"stats-grid\">\n      <StatCard\n        label=\"Intelligence Level\"\n        value={`L${state.intelligenceLevel}`}\n        testId=\"stat-intelligence-level\"\n      />\n      <StatCard\n        label=\"Intelligence Score\"\n        value={state.intelligenceScore}\n        testId=\"stat-intelligence-score\"\n      />\n      <StatCard\n        label=\"Sessions Completed\"\n        value={state.totalSessions}\n        testId=\"stat-total-sessions\"\n      />\n      <StatCard\n        label=\"Best Score\"\n        value={`${state.bestScorePercent}%`}\n        testId=\"stat-best-score\"\n      />\n    </div>\n  );\n}\n","path":null,"size_bytes":1316,"size_tokens":null},"client/src/components/ui/sidebar.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, VariantProps } from \"class-variance-authority\"\nimport { PanelLeftIcon } from \"lucide-react\"\n\nimport { useIsMobile } from \"@/hooks/use-mobile\"\nimport { cn } from \"@/lib/utils\"\nimport { Button } from \"@/components/ui/button\"\nimport { Input } from \"@/components/ui/input\"\nimport { Separator } from \"@/components/ui/separator\"\nimport {\n  Sheet,\n  SheetContent,\n  SheetDescription,\n  SheetHeader,\n  SheetTitle,\n} from \"@/components/ui/sheet\"\nimport { Skeleton } from \"@/components/ui/skeleton\"\nimport {\n  Tooltip,\n  TooltipContent,\n  TooltipProvider,\n  TooltipTrigger,\n} from \"@/components/ui/tooltip\"\n\nconst SIDEBAR_COOKIE_NAME = \"sidebar_state\"\nconst SIDEBAR_COOKIE_MAX_AGE = 60 * 60 * 24 * 7\nconst SIDEBAR_WIDTH = \"16rem\"\nconst SIDEBAR_WIDTH_MOBILE = \"18rem\"\nconst SIDEBAR_WIDTH_ICON = \"3rem\"\nconst SIDEBAR_KEYBOARD_SHORTCUT = \"b\"\n\ntype SidebarContextProps = {\n  state: \"expanded\" | \"collapsed\"\n  open: boolean\n  setOpen: (open: boolean) => void\n  openMobile: boolean\n  setOpenMobile: (open: boolean) => void\n  isMobile: boolean\n  toggleSidebar: () => void\n}\n\nconst SidebarContext = React.createContext<SidebarContextProps | null>(null)\n\nfunction useSidebar() {\n  const context = React.useContext(SidebarContext)\n  if (!context) {\n    throw new Error(\"useSidebar must be used within a SidebarProvider.\")\n  }\n\n  return context\n}\n\nfunction SidebarProvider({\n  defaultOpen = true,\n  open: openProp,\n  onOpenChange: setOpenProp,\n  className,\n  style,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  defaultOpen?: boolean\n  open?: boolean\n  onOpenChange?: (open: boolean) => void\n}) {\n  const isMobile = useIsMobile()\n  const [openMobile, setOpenMobile] = React.useState(false)\n\n  // This is the internal state of the sidebar.\n  // We use openProp and setOpenProp for control from outside the component.\n  const [_open, _setOpen] = React.useState(defaultOpen)\n  const open = openProp ?? _open\n  const setOpen = React.useCallback(\n    (value: boolean | ((value: boolean) => boolean)) => {\n      const openState = typeof value === \"function\" ? value(open) : value\n      if (setOpenProp) {\n        setOpenProp(openState)\n      } else {\n        _setOpen(openState)\n      }\n\n      // This sets the cookie to keep the sidebar state.\n      document.cookie = `${SIDEBAR_COOKIE_NAME}=${openState}; path=/; max-age=${SIDEBAR_COOKIE_MAX_AGE}`\n    },\n    [setOpenProp, open]\n  )\n\n  // Helper to toggle the sidebar.\n  const toggleSidebar = React.useCallback(() => {\n    return isMobile ? setOpenMobile((open) => !open) : setOpen((open) => !open)\n  }, [isMobile, setOpen, setOpenMobile])\n\n  // Adds a keyboard shortcut to toggle the sidebar.\n  React.useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      if (\n        event.key === SIDEBAR_KEYBOARD_SHORTCUT &&\n        (event.metaKey || event.ctrlKey)\n      ) {\n        event.preventDefault()\n        toggleSidebar()\n      }\n    }\n\n    window.addEventListener(\"keydown\", handleKeyDown)\n    return () => window.removeEventListener(\"keydown\", handleKeyDown)\n  }, [toggleSidebar])\n\n  // We add a state so that we can do data-state=\"expanded\" or \"collapsed\".\n  // This makes it easier to style the sidebar with Tailwind classes.\n  const state = open ? \"expanded\" : \"collapsed\"\n\n  const contextValue = React.useMemo<SidebarContextProps>(\n    () => ({\n      state,\n      open,\n      setOpen,\n      isMobile,\n      openMobile,\n      setOpenMobile,\n      toggleSidebar,\n    }),\n    [state, open, setOpen, isMobile, openMobile, setOpenMobile, toggleSidebar]\n  )\n\n  return (\n    <SidebarContext.Provider value={contextValue}>\n      <TooltipProvider delayDuration={0}>\n        <div\n          data-slot=\"sidebar-wrapper\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH,\n              \"--sidebar-width-icon\": SIDEBAR_WIDTH_ICON,\n              ...style,\n            } as React.CSSProperties\n          }\n          className={cn(\n            \"group/sidebar-wrapper has-data-[variant=inset]:bg-sidebar flex min-h-svh w-full\",\n            className\n          )}\n          {...props}\n        >\n          {children}\n        </div>\n      </TooltipProvider>\n    </SidebarContext.Provider>\n  )\n}\n\nfunction Sidebar({\n  side = \"left\",\n  variant = \"sidebar\",\n  collapsible = \"offcanvas\",\n  className,\n  children,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  side?: \"left\" | \"right\"\n  variant?: \"sidebar\" | \"floating\" | \"inset\"\n  collapsible?: \"offcanvas\" | \"icon\" | \"none\"\n}) {\n  const { isMobile, state, openMobile, setOpenMobile } = useSidebar()\n\n  if (collapsible === \"none\") {\n    return (\n      <div\n        data-slot=\"sidebar\"\n        className={cn(\n          \"bg-sidebar text-sidebar-foreground flex h-full w-[var(--sidebar-width)] flex-col\",\n          className\n        )}\n        {...props}\n      >\n        {children}\n      </div>\n    )\n  }\n\n  if (isMobile) {\n    return (\n      <Sheet open={openMobile} onOpenChange={setOpenMobile} {...props}>\n        <SheetContent\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar\"\n          data-mobile=\"true\"\n          className=\"bg-sidebar text-sidebar-foreground w-[var(--sidebar-width)] p-0 [&>button]:hidden\"\n          style={\n            {\n              \"--sidebar-width\": SIDEBAR_WIDTH_MOBILE,\n            } as React.CSSProperties\n          }\n          side={side}\n        >\n          <SheetHeader className=\"sr-only\">\n            <SheetTitle>Sidebar</SheetTitle>\n            <SheetDescription>Displays the mobile sidebar.</SheetDescription>\n          </SheetHeader>\n          <div className=\"flex h-full w-full flex-col\">{children}</div>\n        </SheetContent>\n      </Sheet>\n    )\n  }\n\n  return (\n    <div\n      className=\"group peer text-sidebar-foreground hidden md:block\"\n      data-state={state}\n      data-collapsible={state === \"collapsed\" ? collapsible : \"\"}\n      data-variant={variant}\n      data-side={side}\n      data-slot=\"sidebar\"\n    >\n      {/* This is what handles the sidebar gap on desktop */}\n      <div\n        data-slot=\"sidebar-gap\"\n        className={cn(\n          \"relative w-[var(--sidebar-width)] bg-transparent transition-[width] duration-200 ease-linear\",\n          \"group-data-[collapsible=offcanvas]:w-0\",\n          \"group-data-[side=right]:rotate-180\",\n          variant === \"floating\" || variant === \"inset\"\n            ? \"group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4))]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)]\"\n        )}\n      />\n      <div\n        data-slot=\"sidebar-container\"\n        className={cn(\n          \"fixed inset-y-0 z-10 hidden h-svh w-[var(--sidebar-width)] transition-[left,right,width] duration-200 ease-linear md:flex\",\n          side === \"left\"\n            ? \"left-0 group-data-[collapsible=offcanvas]:left-[calc(var(--sidebar-width)*-1)]\"\n            : \"right-0 group-data-[collapsible=offcanvas]:right-[calc(var(--sidebar-width)*-1)]\",\n          // Adjust the padding for floating and inset variants.\n          variant === \"floating\" || variant === \"inset\"\n            ? \"p-2 group-data-[collapsible=icon]:w-[calc(var(--sidebar-width-icon)+var(--spacing-4)+2px)]\"\n            : \"group-data-[collapsible=icon]:w-[var(--sidebar-width-icon)] group-data-[side=left]:border-r group-data-[side=right]:border-l\",\n          className\n        )}\n        {...props}\n      >\n        <div\n          data-sidebar=\"sidebar\"\n          data-slot=\"sidebar-inner\"\n          className=\"bg-sidebar group-data-[variant=floating]:border-sidebar-border flex h-full w-full flex-col group-data-[variant=floating]:rounded-lg group-data-[variant=floating]:border group-data-[variant=floating]:shadow-sm\"\n        >\n          {children}\n        </div>\n      </div>\n    </div>\n  )\n}\n\nfunction SidebarTrigger({\n  className,\n  onClick,\n  ...props\n}: React.ComponentProps<typeof Button>) {\n  const { toggleSidebar } = useSidebar()\n\n  return (\n    <Button\n      data-sidebar=\"trigger\"\n      data-slot=\"sidebar-trigger\"\n      variant=\"ghost\"\n      size=\"icon\"\n      className={cn(\"h-7 w-7\", className)}\n      onClick={(event) => {\n        onClick?.(event)\n        toggleSidebar()\n      }}\n      {...props}\n    >\n      <PanelLeftIcon />\n      <span className=\"sr-only\">Toggle Sidebar</span>\n    </Button>\n  )\n}\n\nfunction SidebarRail({ className, ...props }: React.ComponentProps<\"button\">) {\n  const { toggleSidebar } = useSidebar()\n\n  // Note: Tailwind v3.4 doesn't support \"in-\" selectors. So the rail won't work perfectly.\n  return (\n    <button\n      data-sidebar=\"rail\"\n      data-slot=\"sidebar-rail\"\n      aria-label=\"Toggle Sidebar\"\n      tabIndex={-1}\n      onClick={toggleSidebar}\n      title=\"Toggle Sidebar\"\n      className={cn(\n        \"hover:after:bg-sidebar-border absolute inset-y-0 z-20 hidden w-4 -translate-x-1/2 transition-all ease-linear group-data-[side=left]:-right-4 group-data-[side=right]:left-0 after:absolute after:inset-y-0 after:left-1/2 after:w-[2px] sm:flex\",\n        \"in-data-[side=left]:cursor-w-resize in-data-[side=right]:cursor-e-resize\",\n        \"[[data-side=left][data-state=collapsed]_&]:cursor-e-resize [[data-side=right][data-state=collapsed]_&]:cursor-w-resize\",\n        \"hover:group-data-[collapsible=offcanvas]:bg-sidebar group-data-[collapsible=offcanvas]:translate-x-0 group-data-[collapsible=offcanvas]:after:left-full\",\n        \"[[data-side=left][data-collapsible=offcanvas]_&]:-right-2\",\n        \"[[data-side=right][data-collapsible=offcanvas]_&]:-left-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInset({ className, ...props }: React.ComponentProps<\"main\">) {\n  return (\n    <main\n      data-slot=\"sidebar-inset\"\n      className={cn(\n        \"bg-background relative flex w-full flex-1 flex-col\",\n        \"md:peer-data-[variant=inset]:m-2 md:peer-data-[variant=inset]:ml-0 md:peer-data-[variant=inset]:rounded-xl md:peer-data-[variant=inset]:shadow-sm md:peer-data-[variant=inset]:peer-data-[state=collapsed]:ml-2\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarInput({\n  className,\n  ...props\n}: React.ComponentProps<typeof Input>) {\n  return (\n    <Input\n      data-slot=\"sidebar-input\"\n      data-sidebar=\"input\"\n      className={cn(\"bg-background h-8 w-full shadow-none\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarHeader({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-header\"\n      data-sidebar=\"header\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarFooter({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-footer\"\n      data-sidebar=\"footer\"\n      className={cn(\"flex flex-col gap-2 p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarSeparator({\n  className,\n  ...props\n}: React.ComponentProps<typeof Separator>) {\n  return (\n    <Separator\n      data-slot=\"sidebar-separator\"\n      data-sidebar=\"separator\"\n      className={cn(\"bg-sidebar-border mx-2 w-auto\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarContent({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-content\"\n      data-sidebar=\"content\"\n      className={cn(\n        \"flex min-h-0 flex-1 flex-col gap-2 overflow-auto group-data-[collapsible=icon]:overflow-hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroup({ className, ...props }: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group\"\n      data-sidebar=\"group\"\n      className={cn(\"relative flex w-full min-w-0 flex-col p-2\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupLabel({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"div\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"div\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-label\"\n      data-sidebar=\"group-label\"\n      className={cn(\n        \"text-sidebar-foreground/70 ring-sidebar-ring flex h-8 shrink-0 items-center rounded-md px-2 text-xs font-medium outline-hidden transition-[margin,opacity] duration-200 ease-linear focus-visible:ring-2 [&>svg]:h-4 [&>svg]:w-4 [&>svg]:shrink-0\",\n        \"group-data-[collapsible=icon]:-mt-8 group-data-[collapsible=icon]:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupAction({\n  className,\n  asChild = false,\n  ...props\n}: React.ComponentProps<\"button\"> & { asChild?: boolean }) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-group-action\"\n      data-sidebar=\"group-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground absolute top-3.5 right-3 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarGroupContent({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-group-content\"\n      data-sidebar=\"group-content\"\n      className={cn(\"w-full text-sm\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenu({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu\"\n      data-sidebar=\"menu\"\n      className={cn(\"flex w-full min-w-0 flex-col gap-1\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuItem({ className, ...props }: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-item\"\n      data-sidebar=\"menu-item\"\n      className={cn(\"group/menu-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nconst sidebarMenuButtonVariants = cva(\n  \"peer/menu-button flex w-full items-center gap-2 overflow-hidden rounded-md p-2 text-left text-sm outline-hidden ring-sidebar-ring transition-[width,height,padding] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground focus-visible:ring-2 active:bg-sidebar-accent active:text-sidebar-accent-foreground disabled:pointer-events-none disabled:opacity-50 group-has-data-[sidebar=menu-action]/menu-item:pr-8 aria-disabled:pointer-events-none aria-disabled:opacity-50 data-[active=true]:bg-sidebar-accent data-[active=true]:font-medium data-[active=true]:text-sidebar-accent-foreground data-[state=open]:hover:bg-sidebar-accent data-[state=open]:hover:text-sidebar-accent-foreground group-data-[collapsible=icon]:w-8! group-data-[collapsible=icon]:h-8! group-data-[collapsible=icon]:p-2! [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"hover:bg-sidebar-accent hover:text-sidebar-accent-foreground\",\n        outline:\n          \"bg-background shadow-[0_0_0_1px_hsl(var(--sidebar-border))] hover:bg-sidebar-accent hover:text-sidebar-accent-foreground hover:shadow-[0_0_0_1px_hsl(var(--sidebar-accent))]\",\n      },\n      size: {\n        default: \"h-8 text-sm\",\n        sm: \"h-7 text-xs\",\n        lg: \"h-12 text-sm group-data-[collapsible=icon]:p-0!\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nfunction SidebarMenuButton({\n  asChild = false,\n  isActive = false,\n  variant = \"default\",\n  size = \"default\",\n  tooltip,\n  className,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  isActive?: boolean\n  tooltip?: string | React.ComponentProps<typeof TooltipContent>\n} & VariantProps<typeof sidebarMenuButtonVariants>) {\n  const Comp = asChild ? Slot : \"button\"\n  const { isMobile, state } = useSidebar()\n\n  const button = (\n    <Comp\n      data-slot=\"sidebar-menu-button\"\n      data-sidebar=\"menu-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(sidebarMenuButtonVariants({ variant, size }), className)}\n      {...props}\n    />\n  )\n\n  if (!tooltip) {\n    return button\n  }\n\n  if (typeof tooltip === \"string\") {\n    tooltip = {\n      children: tooltip,\n    }\n  }\n\n  return (\n    <Tooltip>\n      <TooltipTrigger asChild>{button}</TooltipTrigger>\n      <TooltipContent\n        side=\"right\"\n        align=\"center\"\n        hidden={state !== \"collapsed\" || isMobile}\n        {...tooltip}\n      />\n    </Tooltip>\n  )\n}\n\nfunction SidebarMenuAction({\n  className,\n  asChild = false,\n  showOnHover = false,\n  ...props\n}: React.ComponentProps<\"button\"> & {\n  asChild?: boolean\n  showOnHover?: boolean\n}) {\n  const Comp = asChild ? Slot : \"button\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-action\"\n      data-sidebar=\"menu-action\"\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground peer-hover/menu-button:text-sidebar-accent-foreground absolute top-1.5 right-1 flex aspect-square w-5 items-center justify-center rounded-md p-0 outline-hidden transition-transform focus-visible:ring-2 [&>svg]:size-4 [&>svg]:shrink-0\",\n        // Increases the hit area of the button on mobile.\n        \"after:absolute after:-inset-2 md:after:hidden\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        showOnHover &&\n          \"peer-data-[active=true]/menu-button:text-sidebar-accent-foreground group-focus-within/menu-item:opacity-100 group-hover/menu-item:opacity-100 data-[state=open]:opacity-100 md:opacity-0\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuBadge({\n  className,\n  ...props\n}: React.ComponentProps<\"div\">) {\n  return (\n    <div\n      data-slot=\"sidebar-menu-badge\"\n      data-sidebar=\"menu-badge\"\n      className={cn(\n        \"text-sidebar-foreground pointer-events-none absolute right-1 flex h-5 min-w-5 items-center justify-center rounded-md px-1 text-xs font-medium tabular-nums select-none\",\n        \"peer-hover/menu-button:text-sidebar-accent-foreground peer-data-[active=true]/menu-button:text-sidebar-accent-foreground\",\n        \"peer-data-[size=sm]/menu-button:top-1\",\n        \"peer-data-[size=default]/menu-button:top-1.5\",\n        \"peer-data-[size=lg]/menu-button:top-2.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSkeleton({\n  className,\n  showIcon = false,\n  ...props\n}: React.ComponentProps<\"div\"> & {\n  showIcon?: boolean\n}) {\n  // Random width between 50 to 90%.\n  const width = React.useMemo(() => {\n    return `${Math.floor(Math.random() * 40) + 50}%`\n  }, [])\n\n  return (\n    <div\n      data-slot=\"sidebar-menu-skeleton\"\n      data-sidebar=\"menu-skeleton\"\n      className={cn(\"flex h-8 items-center gap-2 rounded-md px-2\", className)}\n      {...props}\n    >\n      {showIcon && (\n        <Skeleton\n          className=\"size-4 rounded-md\"\n          data-sidebar=\"menu-skeleton-icon\"\n        />\n      )}\n      <Skeleton\n        className=\"h-4 max-w-[var(--skeleton-width)] flex-1\"\n        data-sidebar=\"menu-skeleton-text\"\n        style={\n          {\n            \"--skeleton-width\": width,\n          } as React.CSSProperties\n        }\n      />\n    </div>\n  )\n}\n\nfunction SidebarMenuSub({ className, ...props }: React.ComponentProps<\"ul\">) {\n  return (\n    <ul\n      data-slot=\"sidebar-menu-sub\"\n      data-sidebar=\"menu-sub\"\n      className={cn(\n        \"border-sidebar-border mx-3.5 flex min-w-0 translate-x-px flex-col gap-1 border-l px-2.5 py-0.5\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubItem({\n  className,\n  ...props\n}: React.ComponentProps<\"li\">) {\n  return (\n    <li\n      data-slot=\"sidebar-menu-sub-item\"\n      data-sidebar=\"menu-sub-item\"\n      className={cn(\"group/menu-sub-item relative\", className)}\n      {...props}\n    />\n  )\n}\n\nfunction SidebarMenuSubButton({\n  asChild = false,\n  size = \"md\",\n  isActive = false,\n  className,\n  ...props\n}: React.ComponentProps<\"a\"> & {\n  asChild?: boolean\n  size?: \"sm\" | \"md\"\n  isActive?: boolean\n}) {\n  const Comp = asChild ? Slot : \"a\"\n\n  return (\n    <Comp\n      data-slot=\"sidebar-menu-sub-button\"\n      data-sidebar=\"menu-sub-button\"\n      data-size={size}\n      data-active={isActive}\n      className={cn(\n        \"text-sidebar-foreground ring-sidebar-ring hover:bg-sidebar-accent hover:text-sidebar-accent-foreground active:bg-sidebar-accent active:text-sidebar-accent-foreground [&>svg]:text-sidebar-accent-foreground flex h-7 min-w-0 -translate-x-px items-center gap-2 overflow-hidden rounded-md px-2 outline outline-2 outline-transparent outline-offset-2 focus-visible:ring-2 disabled:pointer-events-none disabled:opacity-50 aria-disabled:pointer-events-none aria-disabled:opacity-50 [&>span:last-child]:truncate [&>svg]:size-4 [&>svg]:shrink-0\",\n        \"data-[active=true]:bg-sidebar-accent data-[active=true]:text-sidebar-accent-foreground\",\n        size === \"sm\" && \"text-xs\",\n        size === \"md\" && \"text-sm\",\n        \"group-data-[collapsible=icon]:hidden\",\n        className\n      )}\n      {...props}\n    />\n  )\n}\n\nexport {\n  Sidebar,\n  SidebarContent,\n  SidebarFooter,\n  SidebarGroup,\n  SidebarGroupAction,\n  SidebarGroupContent,\n  SidebarGroupLabel,\n  SidebarHeader,\n  SidebarInput,\n  SidebarInset,\n  SidebarMenu,\n  SidebarMenuAction,\n  SidebarMenuBadge,\n  SidebarMenuButton,\n  SidebarMenuItem,\n  SidebarMenuSkeleton,\n  SidebarMenuSub,\n  SidebarMenuSubButton,\n  SidebarMenuSubItem,\n  SidebarProvider,\n  SidebarRail,\n  SidebarSeparator,\n  SidebarTrigger,\n  useSidebar,\n}\n","path":null,"size_bytes":21846,"size_tokens":null},"client/src/components/ui/sheet.tsx":{"content":"\"use client\"\n\nimport * as React from \"react\"\nimport * as SheetPrimitive from \"@radix-ui/react-dialog\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\nimport { X } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Sheet = SheetPrimitive.Root\n\nconst SheetTrigger = SheetPrimitive.Trigger\n\nconst SheetClose = SheetPrimitive.Close\n\nconst SheetPortal = SheetPrimitive.Portal\n\nconst SheetOverlay = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Overlay>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Overlay>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Overlay\n    className={cn(\n      \"fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0\",\n      className\n    )}\n    {...props}\n    ref={ref}\n  />\n))\nSheetOverlay.displayName = SheetPrimitive.Overlay.displayName\n\nconst sheetVariants = cva(\n  \"fixed z-50 gap-4 bg-background p-6 shadow-lg transition ease-in-out data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:duration-300 data-[state=open]:duration-500\",\n  {\n    variants: {\n      side: {\n        top: \"inset-x-0 top-0 border-b data-[state=closed]:slide-out-to-top data-[state=open]:slide-in-from-top\",\n        bottom:\n          \"inset-x-0 bottom-0 border-t data-[state=closed]:slide-out-to-bottom data-[state=open]:slide-in-from-bottom\",\n        left: \"inset-y-0 left-0 h-full w-3/4 border-r data-[state=closed]:slide-out-to-left data-[state=open]:slide-in-from-left sm:max-w-sm\",\n        right:\n          \"inset-y-0 right-0 h-full w-3/4  border-l data-[state=closed]:slide-out-to-right data-[state=open]:slide-in-from-right sm:max-w-sm\",\n      },\n    },\n    defaultVariants: {\n      side: \"right\",\n    },\n  }\n)\n\ninterface SheetContentProps\n  extends React.ComponentPropsWithoutRef<typeof SheetPrimitive.Content>,\n    VariantProps<typeof sheetVariants> {}\n\nconst SheetContent = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Content>,\n  SheetContentProps\n>(({ side = \"right\", className, children, ...props }, ref) => (\n  <SheetPortal>\n    <SheetOverlay />\n    <SheetPrimitive.Content\n      ref={ref}\n      className={cn(sheetVariants({ side }), className)}\n      {...props}\n    >\n      {children}\n      <SheetPrimitive.Close className=\"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-secondary\">\n        <X className=\"h-4 w-4\" />\n        <span className=\"sr-only\">Close</span>\n      </SheetPrimitive.Close>\n    </SheetPrimitive.Content>\n  </SheetPortal>\n))\nSheetContent.displayName = SheetPrimitive.Content.displayName\n\nconst SheetHeader = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col space-y-2 text-center sm:text-left\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetHeader.displayName = \"SheetHeader\"\n\nconst SheetFooter = ({\n  className,\n  ...props\n}: React.HTMLAttributes<HTMLDivElement>) => (\n  <div\n    className={cn(\n      \"flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2\",\n      className\n    )}\n    {...props}\n  />\n)\nSheetFooter.displayName = \"SheetFooter\"\n\nconst SheetTitle = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Title>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Title>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Title\n    ref={ref}\n    className={cn(\"text-lg font-semibold text-foreground\", className)}\n    {...props}\n  />\n))\nSheetTitle.displayName = SheetPrimitive.Title.displayName\n\nconst SheetDescription = React.forwardRef<\n  React.ElementRef<typeof SheetPrimitive.Description>,\n  React.ComponentPropsWithoutRef<typeof SheetPrimitive.Description>\n>(({ className, ...props }, ref) => (\n  <SheetPrimitive.Description\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nSheetDescription.displayName = SheetPrimitive.Description.displayName\n\nexport {\n  Sheet,\n  SheetPortal,\n  SheetOverlay,\n  SheetTrigger,\n  SheetClose,\n  SheetContent,\n  SheetHeader,\n  SheetFooter,\n  SheetTitle,\n  SheetDescription,\n}\n","path":null,"size_bytes":4281,"size_tokens":null},"client/src/components/game/AboutFooter.tsx":{"content":"import { Info, Shield, ExternalLink } from \"lucide-react\";\n\nexport default function AboutFooter() {\n  return (\n    <div className=\"space-y-3 pt-4 border-t border-border/20\" data-testid=\"about-footer\">\n      <div className=\"flex items-center gap-2\">\n        <Info className=\"w-3.5 h-3.5 text-muted-foreground\" />\n        <span className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider\">\n          About\n        </span>\n      </div>\n      \n      <div className=\"space-y-3 text-xs text-muted-foreground\">\n        <p>\n          Train Your AI is a browser-based quiz game where you train a virtual AI model by answering questions. Your performance affects the AI's intelligence and unlocks higher difficulties and cosmetics.\n        </p>\n        \n        <div className=\"p-2.5 rounded-md bg-background/30 border border-border/20 space-y-2\">\n          <div className=\"flex items-center gap-2 text-foreground\">\n            <Shield className=\"w-3.5 h-3.5\" />\n            <span className=\"font-medium\">Disclaimers</span>\n          </div>\n          <ul className=\"space-y-1.5 pl-5\">\n            <li>\n              This is a game and educational experience. It does not provide financial advice or guarantees of any financial return.\n            </li>\n            <li>\n              Token gating and any future rewards are experimental and for entertainment purposes only.\n            </li>\n            <li>\n              Your game progress is stored locally in your browser using localStorage. We do not store your private keys or wallet seed phrases.\n            </li>\n          </ul>\n        </div>\n        \n        <p className=\"text-center\">\n          <a\n            href=\"https://phantom.app/\"\n            target=\"_blank\"\n            rel=\"noopener noreferrer\"\n            className=\"inline-flex items-center gap-1 text-primary hover:underline\"\n            data-testid=\"link-phantom\"\n          >\n            Get Phantom Wallet\n            <ExternalLink className=\"w-3 h-3\" />\n          </a>\n        </p>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":2049,"size_tokens":null},"client/src/components/ui/resizable.tsx":{"content":"\"use client\"\n\nimport { GripVertical } from \"lucide-react\"\nimport * as ResizablePrimitive from \"react-resizable-panels\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst ResizablePanelGroup = ({\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelGroup>) => (\n  <ResizablePrimitive.PanelGroup\n    className={cn(\n      \"flex h-full w-full data-[panel-group-direction=vertical]:flex-col\",\n      className\n    )}\n    {...props}\n  />\n)\n\nconst ResizablePanel = ResizablePrimitive.Panel\n\nconst ResizableHandle = ({\n  withHandle,\n  className,\n  ...props\n}: React.ComponentProps<typeof ResizablePrimitive.PanelResizeHandle> & {\n  withHandle?: boolean\n}) => (\n  <ResizablePrimitive.PanelResizeHandle\n    className={cn(\n      \"relative flex w-px items-center justify-center bg-border after:absolute after:inset-y-0 after:left-1/2 after:w-1 after:-translate-x-1/2 focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-1 data-[panel-group-direction=vertical]:h-px data-[panel-group-direction=vertical]:w-full data-[panel-group-direction=vertical]:after:left-0 data-[panel-group-direction=vertical]:after:h-1 data-[panel-group-direction=vertical]:after:w-full data-[panel-group-direction=vertical]:after:-translate-y-1/2 data-[panel-group-direction=vertical]:after:translate-x-0 [&[data-panel-group-direction=vertical]>div]:rotate-90\",\n      className\n    )}\n    {...props}\n  >\n    {withHandle && (\n      <div className=\"z-10 flex h-4 w-3 items-center justify-center rounded-sm border bg-border\">\n        <GripVertical className=\"h-2.5 w-2.5\" />\n      </div>\n    )}\n  </ResizablePrimitive.PanelResizeHandle>\n)\n\nexport { ResizablePanelGroup, ResizablePanel, ResizableHandle }\n","path":null,"size_bytes":1723,"size_tokens":null},"client/src/components/game/TrainingRules.tsx":{"content":"import { TrendingUp, Minus, TrendingDown } from \"lucide-react\";\n\nexport default function TrainingRules() {\n  return (\n    <div className=\"p-3 rounded-lg bg-background/30 border border-border/20 space-y-1.5\" data-testid=\"training-rules\">\n      <p className=\"text-xs font-medium text-muted-foreground uppercase tracking-wider mb-2\">\n        Training Rules\n      </p>\n      <div className=\"flex items-center gap-2 text-xs\">\n        <TrendingUp className=\"w-3.5 h-3.5 text-success shrink-0\" />\n        <span className=\"text-muted-foreground\">\n          Score 70%+ = AI learns and gets smarter\n        </span>\n      </div>\n      <div className=\"flex items-center gap-2 text-xs\">\n        <Minus className=\"w-3.5 h-3.5 text-muted-foreground shrink-0\" />\n        <span className=\"text-muted-foreground\">\n          50-69% = AI learns nothing this session\n        </span>\n      </div>\n      <div className=\"flex items-center gap-2 text-xs\">\n        <TrendingDown className=\"w-3.5 h-3.5 text-destructive shrink-0\" />\n        <span className=\"text-muted-foreground\">\n          Below 50% = AI can lose intelligence\n        </span>\n      </div>\n    </div>\n  );\n}\n","path":null,"size_bytes":1149,"size_tokens":null},"client/src/components/ui/badge.tsx":{"content":"import * as React from \"react\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst badgeVariants = cva(\n  // Whitespace-nowrap: Badges should never wrap.\n  \"whitespace-nowrap inline-flex items-center rounded-md border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2\" +\n  \" hover-elevate \" ,\n  {\n    variants: {\n      variant: {\n        default:\n          \"border-transparent bg-primary text-primary-foreground shadow-xs\",\n        secondary: \"border-transparent bg-secondary text-secondary-foreground\",\n        destructive:\n          \"border-transparent bg-destructive text-destructive-foreground shadow-xs\",\n\n        outline: \" border [border-color:var(--badge-outline)] shadow-xs\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n    },\n  },\n)\n\nexport interface BadgeProps\n  extends React.HTMLAttributes<HTMLDivElement>,\n    VariantProps<typeof badgeVariants> {}\n\nfunction Badge({ className, variant, ...props }: BadgeProps) {\n  return (\n    <div className={cn(badgeVariants({ variant }), className)} {...props} />\n  );\n}\n\nexport { Badge, badgeVariants }\n","path":null,"size_bytes":1202,"size_tokens":null},"postcss.config.js":{"content":"export default {\n  plugins: {\n    tailwindcss: {},\n    autoprefixer: {},\n  },\n}\n","path":null,"size_bytes":80,"size_tokens":null},"client/src/components/ui/radio-group.tsx":{"content":"import * as React from \"react\"\nimport * as RadioGroupPrimitive from \"@radix-ui/react-radio-group\"\nimport { Circle } from \"lucide-react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst RadioGroup = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Root>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Root>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Root\n      className={cn(\"grid gap-2\", className)}\n      {...props}\n      ref={ref}\n    />\n  )\n})\nRadioGroup.displayName = RadioGroupPrimitive.Root.displayName\n\nconst RadioGroupItem = React.forwardRef<\n  React.ElementRef<typeof RadioGroupPrimitive.Item>,\n  React.ComponentPropsWithoutRef<typeof RadioGroupPrimitive.Item>\n>(({ className, ...props }, ref) => {\n  return (\n    <RadioGroupPrimitive.Item\n      ref={ref}\n      className={cn(\n        \"aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50\",\n        className\n      )}\n      {...props}\n    >\n      <RadioGroupPrimitive.Indicator className=\"flex items-center justify-center\">\n        <Circle className=\"h-2.5 w-2.5 fill-current text-current\" />\n      </RadioGroupPrimitive.Indicator>\n    </RadioGroupPrimitive.Item>\n  )\n})\nRadioGroupItem.displayName = RadioGroupPrimitive.Item.displayName\n\nexport { RadioGroup, RadioGroupItem }\n","path":null,"size_bytes":1467,"size_tokens":null},"client/src/lib/utils.ts":{"content":"import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n","path":null,"size_bytes":166,"size_tokens":null},"server/solana.ts":{"content":"import { Connection, PublicKey } from \"@solana/web3.js\";\n\n// RPC endpoints with fallbacks (public endpoints have rate limits)\nconst SOLANA_RPC_URLS = [\n  process.env.SOLANA_RPC_URL || \"https://api.mainnet-beta.solana.com\",\n  \"https://rpc.ankr.com/solana\",\n  \"https://solana.public-rpc.com\",\n].filter(Boolean) as string[];\n\nconst HIVE_MINT = process.env.HIVE_MINT || \"F3zvEFZVhDXNo1kZDPg24Z3RioDzCdEJVdnZ5FCcpump\";\n\n// Token Program IDs\nconst TOKEN_PROGRAM_ID = \"TokenkegQfeZyiNwAJbNbGKPFXCWuBvf9Ss623VQ5DA\"; // Legacy SPL Token\nconst TOKEN_2022_PROGRAM_ID = \"TokenzQdBNbLqP5VEhdkAS6EPFLC1PHnBqCXEpPxuEb\"; // Token-2022\n\n// Get working connection with fallback\nasync function getWorkingConnection(): Promise<Connection> {\n  for (const url of SOLANA_RPC_URLS) {\n    try {\n      const conn = new Connection(url, \"confirmed\");\n      // Test the connection\n      await conn.getSlot();\n      return conn;\n    } catch (error) {\n      console.log(`[Solana RPC] ${url} failed, trying next...`);\n    }\n  }\n  // Return first as fallback\n  return new Connection(SOLANA_RPC_URLS[0], \"confirmed\");\n}\n\nexport interface HiveBalanceResult {\n  rawAmount: string;\n  decimals: number;\n  uiAmount: number;\n  programUsed: \"Token-2022\" | \"Legacy\" | \"Both\" | \"None\";\n}\n\n/**\n * Get HIVE token balance for a wallet address\n * Scans BOTH Token and Token-2022 programs and sums matching accounts\n */\nexport async function getHiveBalance(walletAddress: string): Promise<number> {\n  const result = await getHiveBalanceDetailed(walletAddress);\n  return result.uiAmount;\n}\n\n/**\n * Get detailed HIVE token balance including program info\n * Scans BOTH Token and Token-2022 programs\n */\nexport async function getHiveBalanceDetailed(walletAddress: string): Promise<HiveBalanceResult> {\n  try {\n    const connection = await getWorkingConnection();\n    const ownerPk = new PublicKey(walletAddress);\n    const token2022ProgramPk = new PublicKey(TOKEN_2022_PROGRAM_ID);\n    const tokenProgramPk = new PublicKey(TOKEN_PROGRAM_ID);\n\n    // Query both programs in parallel\n    const [token2022Accounts, legacyAccounts] = await Promise.all([\n      connection.getParsedTokenAccountsByOwner(ownerPk, { programId: token2022ProgramPk }),\n      connection.getParsedTokenAccountsByOwner(ownerPk, { programId: tokenProgramPk }),\n    ]);\n\n    let rawBalanceSum = BigInt(0);\n    let decimals = 6; // Default for HIVE\n    let token2022Count = 0;\n    let legacyCount = 0;\n\n    // Process Token-2022 accounts\n    for (const accountInfo of token2022Accounts.value) {\n      const parsedInfo = accountInfo.account.data.parsed?.info;\n      if (parsedInfo?.mint === HIVE_MINT && parsedInfo?.tokenAmount) {\n        rawBalanceSum += BigInt(parsedInfo.tokenAmount.amount || \"0\");\n        decimals = parsedInfo.tokenAmount.decimals || 6;\n        token2022Count++;\n      }\n    }\n\n    // Process Legacy SPL Token accounts\n    for (const accountInfo of legacyAccounts.value) {\n      const parsedInfo = accountInfo.account.data.parsed?.info;\n      if (parsedInfo?.mint === HIVE_MINT && parsedInfo?.tokenAmount) {\n        rawBalanceSum += BigInt(parsedInfo.tokenAmount.amount || \"0\");\n        decimals = parsedInfo.tokenAmount.decimals || 6;\n        legacyCount++;\n      }\n    }\n\n    // Determine which program(s) had the token\n    let programUsed: \"Token-2022\" | \"Legacy\" | \"Both\" | \"None\" = \"None\";\n    if (token2022Count > 0 && legacyCount > 0) {\n      programUsed = \"Both\";\n    } else if (token2022Count > 0) {\n      programUsed = \"Token-2022\";\n    } else if (legacyCount > 0) {\n      programUsed = \"Legacy\";\n    }\n\n    // Convert raw balance to UI amount\n    const uiAmount = Number(rawBalanceSum) / Math.pow(10, decimals);\n\n    console.log(`[HIVE Balance] wallet=${walletAddress.slice(0,8)}... program=${programUsed} raw=${rawBalanceSum.toString()} ui=${uiAmount}`);\n\n    return {\n      rawAmount: rawBalanceSum.toString(),\n      decimals,\n      uiAmount,\n      programUsed,\n    };\n  } catch (error) {\n    console.error(\"Error fetching HIVE balance:\", error);\n    return {\n      rawAmount: \"0\",\n      decimals: 6,\n      uiAmount: 0,\n      programUsed: \"None\",\n    };\n  }\n}\n\n","path":null,"size_bytes":4110,"size_tokens":null},"client/src/components/admin/CodeEditor.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Label } from \"@/components/ui/label\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Save, FileCode, AlertCircle, CheckCircle } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\ninterface FileItem {\n  path: string;\n  type: \"file\" | \"directory\";\n}\n\nexport default function CodeEditor() {\n  const [files, setFiles] = useState<FileItem[]>([]);\n  const [selectedFile, setSelectedFile] = useState<string>(\"\");\n  const [fileContent, setFileContent] = useState<string>(\"\");\n  const [isLoading, setIsLoading] = useState(false);\n  const [isSaving, setIsSaving] = useState(false);\n  const [message, setMessage] = useState<{ type: \"success\" | \"error\"; text: string } | null>(null);\n  const [adminKey, setAdminKey] = useState<string>(\"\");\n\n  // Load file list\n  useEffect(() => {\n    loadFileList();\n  }, []);\n\n  const loadFileList = async () => {\n    setIsLoading(true);\n    try {\n      const res = await fetch(\"/api/admin/files/list\", {\n        credentials: \"include\",\n      });\n      if (!res.ok) {\n        if (res.status === 401 || res.status === 403) {\n          setMessage({ type: \"error\", text: \"Admin access required. Please set ADMIN_EDIT_KEY in your environment.\" });\n        } else {\n          setMessage({ type: \"error\", text: \"Failed to load file list\" });\n        }\n        return;\n      }\n      const data = await res.json();\n      setFiles(data.files || []);\n    } catch (error) {\n      setMessage({ type: \"error\", text: \"Error loading files\" });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const loadFile = async (filePath: string) => {\n    if (!filePath) return;\n    \n    setIsLoading(true);\n    setMessage(null);\n    try {\n      const res = await fetch(`/api/admin/files/read?path=${encodeURIComponent(filePath)}`, {\n        credentials: \"include\",\n        headers: {\n          \"X-Admin-Key\": adminKey,\n        },\n      });\n      if (!res.ok) {\n        if (res.status === 401 || res.status === 403) {\n          setMessage({ type: \"error\", text: \"Admin key required or invalid\" });\n        } else {\n          setMessage({ type: \"error\", text: \"Failed to load file\" });\n        }\n        return;\n      }\n      const data = await res.json();\n      setFileContent(data.content || \"\");\n    } catch (error) {\n      setMessage({ type: \"error\", text: \"Error loading file\" });\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const saveFile = async () => {\n    if (!selectedFile) {\n      setMessage({ type: \"error\", text: \"No file selected\" });\n      return;\n    }\n\n    if (!adminKey) {\n      setMessage({ type: \"error\", text: \"Admin key required to save files\" });\n      return;\n    }\n\n    setIsSaving(true);\n    setMessage(null);\n    try {\n      const res = await fetch(\"/api/admin/files/save\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          \"X-Admin-Key\": adminKey,\n        },\n        credentials: \"include\",\n        body: JSON.stringify({\n          path: selectedFile,\n          content: fileContent,\n        }),\n      });\n\n      if (!res.ok) {\n        if (res.status === 401 || res.status === 403) {\n          setMessage({ type: \"error\", text: \"Admin key invalid or insufficient permissions\" });\n        } else {\n          const error = await res.json();\n          setMessage({ type: \"error\", text: error.error || \"Failed to save file\" });\n        }\n        return;\n      }\n\n      setMessage({ type: \"success\", text: \"File saved successfully! Refresh the page to see changes.\" });\n    } catch (error) {\n      setMessage({ type: \"error\", text: \"Error saving file\" });\n    } finally {\n      setIsSaving(false);\n    }\n  };\n\n  const handleFileSelect = (filePath: string) => {\n    setSelectedFile(filePath);\n    loadFile(filePath);\n  };\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle className=\"flex items-center gap-2\">\n            <FileCode className=\"w-5 h-5\" />\n            Code Editor\n          </CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          <Alert>\n            <AlertCircle className=\"w-4 h-4\" />\n            <AlertDescription>\n              This editor allows you to modify client-side files. Changes are saved to disk. \n              Set ADMIN_EDIT_KEY environment variable and enter it below to enable saving.\n            </AlertDescription>\n          </Alert>\n\n          <div className=\"space-y-2\">\n            <Label htmlFor=\"admin-key\">Admin Key (from ADMIN_EDIT_KEY env var)</Label>\n            <Input\n              id=\"admin-key\"\n              type=\"password\"\n              placeholder=\"Enter admin key to enable saving\"\n              value={adminKey}\n              onChange={(e) => setAdminKey(e.target.value)}\n            />\n          </div>\n\n          {message && (\n            <Alert variant={message.type === \"error\" ? \"destructive\" : \"default\"}>\n              {message.type === \"success\" ? (\n                <CheckCircle className=\"w-4 h-4\" />\n              ) : (\n                <AlertCircle className=\"w-4 h-4\" />\n              )}\n              <AlertDescription>{message.text}</AlertDescription>\n            </Alert>\n          )}\n\n          <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4\">\n            <div className=\"space-y-2\">\n              <Label>Select File</Label>\n              <Select value={selectedFile} onValueChange={handleFileSelect}>\n                <SelectTrigger>\n                  <SelectValue placeholder=\"Choose a file to edit\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {files\n                    .filter((f) => f.type === \"file\")\n                    .map((file) => (\n                      <SelectItem key={file.path} value={file.path}>\n                        {file.path}\n                      </SelectItem>\n                    ))}\n                </SelectContent>\n              </Select>\n            </div>\n\n            <div className=\"flex items-end\">\n              <Button onClick={saveFile} disabled={!selectedFile || isSaving || !adminKey} className=\"w-full\">\n                {isSaving ? (\n                  <>Saving...</>\n                ) : (\n                  <>\n                    <Save className=\"w-4 h-4 mr-2\" />\n                    Save File\n                  </>\n                )}\n              </Button>\n            </div>\n          </div>\n\n          {selectedFile && (\n            <div className=\"space-y-2\">\n              <Label>File Content: {selectedFile}</Label>\n              <textarea\n                value={fileContent}\n                onChange={(e) => setFileContent(e.target.value)}\n                className=\"w-full h-[600px] font-mono text-sm p-4 border rounded-md bg-background text-foreground resize-none\"\n                style={{ fontFamily: \"monospace\" }}\n                spellCheck={false}\n              />\n            </div>\n          )}\n\n          {!selectedFile && !isLoading && (\n            <div className=\"text-center text-muted-foreground py-8\">\n              Select a file from the dropdown to start editing\n            </div>\n          )}\n\n          {isLoading && selectedFile && (\n            <div className=\"text-center text-muted-foreground py-8\">Loading file...</div>\n          )}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n\n","path":null,"size_bytes":7579,"size_tokens":null},"server/auth.ts":{"content":"import jwt from \"jsonwebtoken\";\nimport type { Request, Response, NextFunction } from \"express\";\nimport { PublicKey } from \"@solana/web3.js\";\nimport nacl from \"tweetnacl\";\nimport { getHiveBalance } from \"./solana\";\nimport { getHivePrice } from \"./jupiter\";\n\nconst JWT_SECRET = process.env.JWT_SECRET || \"change-me-in-production\";\n\n// Creator public key for admin-only access\nconst CREATOR_PUBLIC_KEY = process.env.CREATOR_PUBLIC_KEY || \"\";\n\n// Token-amount based gating (primary - used for access decision)\nconst MIN_HIVE_ACCESS = parseFloat(process.env.MIN_HIVE_ACCESS || \"50\");\n\n// USD-based threshold (kept for informational display only, NOT used for gating)\nconst MIN_USD_ACCESS = parseFloat(process.env.MIN_USD_ACCESS || \"1\");\n\n// Store nonces temporarily (in production, use Redis or similar)\nconst nonceStore = new Map<string, { nonce: string; expiresAt: number }>();\nconst NONCE_TTL = 5 * 60 * 1000; // 5 minutes\n\n// Cache for balance + price checks (60 seconds)\ninterface AccessCache {\n  hasAccess: boolean;\n  hiveAmount: number;\n  requiredHiveAmount: number;\n  hiveUsd: number | null;\n  priceUsd: number | null;\n  priceMissing: boolean;\n  timestamp: number;\n}\n\nconst accessCache = new Map<string, AccessCache>();\nconst ACCESS_CACHE_TTL = 60 * 1000; // 60 seconds\n\n/**\n * Generate a random nonce for wallet challenge\n */\nexport function generateNonce(): string {\n  return Math.random().toString(36).substring(2, 15) + Math.random().toString(36).substring(2, 15);\n}\n\n/**\n * Store nonce for a public key\n */\nexport function storeNonce(publicKey: string, nonce: string): void {\n  nonceStore.set(publicKey, {\n    nonce,\n    expiresAt: Date.now() + NONCE_TTL,\n  });\n}\n\n/**\n * Get and verify nonce for a public key\n */\nexport function verifyNonce(publicKey: string, nonce: string): boolean {\n  const stored = nonceStore.get(publicKey);\n  if (!stored) return false;\n  if (Date.now() > stored.expiresAt) {\n    nonceStore.delete(publicKey);\n    return false;\n  }\n  if (stored.nonce !== nonce) return false;\n  nonceStore.delete(publicKey);\n  return true;\n}\n\n/**\n * Verify Solana signature\n */\nexport async function verifySignature(\n  publicKey: string,\n  signature: string,\n  message: string\n): Promise<boolean> {\n  try {\n    const pubKey = new PublicKey(publicKey);\n    const sigBytes = Uint8Array.from(Buffer.from(signature, \"base64\"));\n    const msgBytes = new TextEncoder().encode(message);\n\n    // Verify signature using nacl (ed25519)\n    return nacl.sign.detached.verify(msgBytes, sigBytes, pubKey.toBytes());\n  } catch (error) {\n    console.error(\"Signature verification error:\", error);\n    return false;\n  }\n}\n\n/**\n * Issue JWT token for authenticated user\n */\nexport function issueToken(publicKey: string): string {\n  return jwt.sign({ publicKey }, JWT_SECRET, { expiresIn: \"7d\" });\n}\n\n/**\n * Verify JWT token and extract public key\n */\nexport function verifyToken(token: string): string | null {\n  try {\n    const decoded = jwt.verify(token, JWT_SECRET) as { publicKey: string };\n    return decoded.publicKey;\n  } catch (error) {\n    return null;\n  }\n}\n\n/**\n * Middleware to require authentication\n */\nexport function requireAuth(req: Request, res: Response, next: NextFunction): void {\n  const token = req.cookies?.authToken || req.headers.authorization?.replace(\"Bearer \", \"\");\n\n  if (!token) {\n    res.status(401).json({ error: \"Unauthorized\" });\n    return;\n  }\n\n  const publicKey = verifyToken(token);\n  if (!publicKey) {\n    res.status(401).json({ error: \"Invalid token\" });\n    return;\n  }\n\n  // Attach public key to request\n  (req as any).publicKey = publicKey;\n  next();\n}\n\n/**\n * Check if user has access (≥MIN_HIVE_ACCESS tokens)\n * Gating is based on TOKEN AMOUNT only, not USD value.\n * Price info is fetched for display purposes only.\n * Uses caching to avoid excessive RPC calls.\n */\nexport async function checkHiveAccess(publicKey: string): Promise<{\n  hasAccess: boolean;\n  hiveAmount: number;\n  requiredHiveAmount: number;\n  hiveUsd: number | null;\n  priceUsd: number | null;\n  priceMissing: boolean;\n}> {\n  // Check cache first\n  const cached = accessCache.get(publicKey);\n  if (cached && Date.now() - cached.timestamp < ACCESS_CACHE_TTL) {\n    return {\n      hasAccess: cached.hasAccess,\n      hiveAmount: cached.hiveAmount,\n      requiredHiveAmount: cached.requiredHiveAmount,\n      hiveUsd: cached.hiveUsd,\n      priceUsd: cached.priceUsd,\n      priceMissing: cached.priceMissing,\n    };\n  }\n\n  // Fetch balance and price (price is for display only)\n  const [hiveAmount, priceUsd] = await Promise.all([\n    getHiveBalance(publicKey),\n    getHivePrice(),\n  ]);\n\n  const priceMissing = priceUsd === null;\n  const hiveUsd = priceUsd !== null ? hiveAmount * priceUsd : null;\n\n  // Gating based on TOKEN AMOUNT only - no dependency on price\n  const hasAccess = hiveAmount >= MIN_HIVE_ACCESS;\n\n  const result = {\n    hasAccess,\n    hiveAmount,\n    requiredHiveAmount: MIN_HIVE_ACCESS,\n    hiveUsd,\n    priceUsd,\n    priceMissing,\n  };\n\n  // Update cache\n  accessCache.set(publicKey, {\n    ...result,\n    timestamp: Date.now(),\n  });\n\n  return result;\n}\n\n/**\n * Middleware to require HIVE access\n */\nexport async function requireHiveAccess(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): Promise<void> {\n  const publicKey = (req as any).publicKey;\n  if (!publicKey) {\n    res.status(401).json({ error: \"Unauthorized\" });\n    return;\n  }\n\n  const access = await checkHiveAccess(publicKey);\n  if (!access.hasAccess) {\n    res.status(403).json({ error: \"HIVE_REQUIRED\" });\n    return;\n  }\n\n  // Attach access info to request\n  (req as any).hiveAccess = access;\n  next();\n}\n\n/**\n * Check if a public key is the creator\n */\nexport function isCreator(publicKey: string): boolean {\n  if (!CREATOR_PUBLIC_KEY) {\n    console.warn(\"CREATOR_PUBLIC_KEY not set - creator access disabled\");\n    return false;\n  }\n  return publicKey === CREATOR_PUBLIC_KEY;\n}\n\n/**\n * Middleware to require creator access\n * Only the wallet matching CREATOR_PUBLIC_KEY can access protected routes\n */\nexport function requireCreator(\n  req: Request,\n  res: Response,\n  next: NextFunction\n): void {\n  const publicKey = (req as any).publicKey;\n  \n  if (!publicKey) {\n    res.status(401).json({ error: \"Unauthorized - wallet authentication required\" });\n    return;\n  }\n\n  if (!isCreator(publicKey)) {\n    res.status(403).json({ \n      error: \"CREATOR_ONLY\",\n      message: \"This action is restricted to the HiveMind creator only\"\n    });\n    return;\n  }\n\n  next();\n}\n\n","path":null,"size_bytes":6471,"size_tokens":null},"script/seed.ts":{"content":"import { db } from \"../server/db\";\nimport { tracks, questions, cycles, trainingPool } from \"@shared/schema\";\nimport { sql } from \"drizzle-orm\";\n\nasync function seed() {\n  console.log(\"Starting seed...\");\n\n  // Create initial cycle\n  const [cycle] = await db\n    .insert(cycles)\n    .values({ cycleNumber: 1, isActive: true })\n    .returning();\n  console.log(\"Created cycle:\", cycle.cycleNumber);\n\n  // Create tracks\n  const trackData = [\n    { name: \"General Knowledge\", description: \"General knowledge questions\" },\n    { name: \"Science\", description: \"Science and technology questions\" },\n    { name: \"Mathematics\", description: \"Math and logic questions\" },\n    { name: \"Programming\", description: \"Programming and computer science questions\" },\n  ];\n\n  const insertedTracks = await db.insert(tracks).values(trackData).returning();\n  console.log(`Created ${insertedTracks.length} tracks`);\n\n  // Create benchmark questions (using questions from gameData.ts as reference)\n  const benchmarkQuestions = [\n    {\n      text: \"What is the capital of France?\",\n      options: [\"Berlin\", \"Paris\", \"Madrid\", \"Rome\"],\n      correctIndex: 1,\n      complexity: 1,\n      isBenchmark: true,\n    },\n    {\n      text: \"What is 12 + 8?\",\n      options: [\"18\", \"20\", \"22\", \"19\"],\n      correctIndex: 1,\n      complexity: 1,\n      isBenchmark: true,\n    },\n    {\n      text: \"Which planet is known as the Red Planet?\",\n      options: [\"Venus\", \"Mars\", \"Jupiter\", \"Saturn\"],\n      correctIndex: 1,\n      complexity: 1,\n      isBenchmark: true,\n    },\n    {\n      text: \"What is the boiling point of water in Celsius?\",\n      options: [\"90\", \"100\", \"110\", \"120\"],\n      correctIndex: 1,\n      complexity: 2,\n      isBenchmark: true,\n    },\n    {\n      text: \"What is the chemical symbol for gold?\",\n      options: [\"Go\", \"Gd\", \"Au\", \"Ag\"],\n      correctIndex: 2,\n      complexity: 2,\n      isBenchmark: true,\n    },\n    {\n      text: \"What is the speed of light in a vacuum (approx)?\",\n      options: [\"300,000 m/s\", \"300,000 km/s\", \"300 km/s\", \"3,000 km/s\"],\n      correctIndex: 1,\n      complexity: 3,\n      isBenchmark: true,\n    },\n    {\n      text: \"What is the derivative of x^2 with respect to x?\",\n      options: [\"x\", \"2x\", \"x^2\", \"2\"],\n      correctIndex: 1,\n      complexity: 3,\n      isBenchmark: true,\n    },\n    {\n      text: \"Which programming language was created by Guido van Rossum?\",\n      options: [\"JavaScript\", \"Ruby\", \"Python\", \"Java\"],\n      correctIndex: 2,\n      complexity: 3,\n      isBenchmark: true,\n    },\n    {\n      text: \"What is the time complexity of binary search?\",\n      options: [\"O(n)\", \"O(log n)\", \"O(n log n)\", \"O(n^2)\"],\n      correctIndex: 1,\n      complexity: 4,\n      isBenchmark: true,\n    },\n    {\n      text: \"In machine learning, what does 'overfitting' mean?\",\n      options: [\n        \"Model is too simple\",\n        \"Model learns noise in training data\",\n        \"Model has too few parameters\",\n        \"Model trains too slowly\",\n      ],\n      correctIndex: 1,\n      complexity: 4,\n      isBenchmark: true,\n    },\n  ];\n\n  await db.insert(questions).values(benchmarkQuestions);\n  console.log(`Created ${benchmarkQuestions.length} benchmark questions`);\n\n  // Create track-specific questions\n  const generalTrack = insertedTracks.find((t) => t.name === \"General Knowledge\");\n  const scienceTrack = insertedTracks.find((t) => t.name === \"Science\");\n  const mathTrack = insertedTracks.find((t) => t.name === \"Mathematics\");\n  const programmingTrack = insertedTracks.find((t) => t.name === \"Programming\");\n\n  if (generalTrack) {\n    const generalQuestions = [\n      {\n        trackId: generalTrack.id,\n        text: \"Who wrote 'Romeo and Juliet'?\",\n        options: [\"Charles Dickens\", \"William Shakespeare\", \"Jane Austen\", \"Mark Twain\"],\n        correctIndex: 1,\n        complexity: 2,\n        isBenchmark: false,\n      },\n      {\n        trackId: generalTrack.id,\n        text: \"What is the capital of Japan?\",\n        options: [\"Seoul\", \"Beijing\", \"Tokyo\", \"Bangkok\"],\n        correctIndex: 2,\n        complexity: 1,\n        isBenchmark: false,\n      },\n    ];\n    await db.insert(questions).values(generalQuestions);\n    console.log(`Created ${generalQuestions.length} questions for General Knowledge`);\n  }\n\n  if (scienceTrack) {\n    const scienceQuestions = [\n      {\n        trackId: scienceTrack.id,\n        text: \"Which gas do plants absorb from the atmosphere?\",\n        options: [\"Oxygen\", \"Nitrogen\", \"Carbon Dioxide\", \"Hydrogen\"],\n        correctIndex: 2,\n        complexity: 1,\n        isBenchmark: false,\n      },\n      {\n        trackId: scienceTrack.id,\n        text: \"What is the primary function of mitochondria?\",\n        options: [\"Protein synthesis\", \"Energy production\", \"Cell division\", \"Waste removal\"],\n        correctIndex: 1,\n        complexity: 3,\n        isBenchmark: false,\n      },\n    ];\n    await db.insert(questions).values(scienceQuestions);\n    console.log(`Created ${scienceQuestions.length} questions for Science`);\n  }\n\n  if (mathTrack) {\n    const mathQuestions = [\n      {\n        trackId: mathTrack.id,\n        text: \"What is 15% of 200?\",\n        options: [\"25\", \"30\", \"35\", \"40\"],\n        correctIndex: 1,\n        complexity: 2,\n        isBenchmark: false,\n      },\n      {\n        trackId: mathTrack.id,\n        text: \"What is the square root of 144?\",\n        options: [\"10\", \"11\", \"12\", \"14\"],\n        correctIndex: 2,\n        complexity: 2,\n        isBenchmark: false,\n      },\n    ];\n    await db.insert(questions).values(mathQuestions);\n    console.log(`Created ${mathQuestions.length} questions for Mathematics`);\n  }\n\n  if (programmingTrack) {\n    const programmingQuestions = [\n      {\n        trackId: programmingTrack.id,\n        text: \"Which data structure uses LIFO principle?\",\n        options: [\"Queue\", \"Stack\", \"Array\", \"Linked List\"],\n        correctIndex: 1,\n        complexity: 3,\n        isBenchmark: false,\n      },\n      {\n        trackId: programmingTrack.id,\n        text: \"Which HTTP status code indicates 'Not Found'?\",\n        options: [\"200\", \"301\", \"404\", \"500\"],\n        correctIndex: 2,\n        complexity: 2,\n        isBenchmark: false,\n      },\n    ];\n    await db.insert(questions).values(programmingQuestions);\n    console.log(`Created ${programmingQuestions.length} questions for Programming`);\n  }\n\n  // Initialize training pool\n  const poolExists = await db.select().from(trainingPool).limit(1);\n  if (poolExists.length === 0) {\n    await db.insert(trainingPool).values({ amount: \"0\" });\n    console.log(\"Initialized training pool\");\n  }\n\n  console.log(\"Seed completed!\");\n  process.exit(0);\n}\n\nseed().catch((error) => {\n  console.error(\"Seed error:\", error);\n  process.exit(1);\n});\n\n","path":null,"size_bytes":6698,"size_tokens":null},"client/src/components/admin/AdminDashboard.tsx":{"content":"import { useState } from \"react\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Tabs, TabsContent, TabsList, TabsTrigger } from \"@/components/ui/tabs\";\nimport { Settings, FileCheck, MessageSquare, RefreshCw, BarChart3, Code } from \"lucide-react\";\nimport ReviewQueue from \"./ReviewQueue\";\nimport HubManagement from \"./HubManagement\";\nimport CycleManagement from \"./CycleManagement\";\nimport ModelStatus from \"./ModelStatus\";\nimport CodeEditor from \"./CodeEditor\";\n\nexport default function AdminDashboard() {\n  return (\n    <div className=\"space-y-6\">\n      <div className=\"flex items-center justify-between\">\n        <h1 className=\"text-2xl font-bold\">HiveMind Admin</h1>\n      </div>\n\n      <Tabs defaultValue=\"review\" className=\"w-full\">\n        <TabsList className=\"grid w-full grid-cols-5\">\n          <TabsTrigger value=\"review\">\n            <FileCheck className=\"w-4 h-4 mr-2\" />\n            Review Queue\n          </TabsTrigger>\n          <TabsTrigger value=\"hub\">\n            <MessageSquare className=\"w-4 h-4 mr-2\" />\n            Hub Management\n          </TabsTrigger>\n          <TabsTrigger value=\"cycle\">\n            <RefreshCw className=\"w-4 h-4 mr-2\" />\n            Cycle Management\n          </TabsTrigger>\n          <TabsTrigger value=\"model\">\n            <BarChart3 className=\"w-4 h-4 mr-2\" />\n            Model Status\n          </TabsTrigger>\n          <TabsTrigger value=\"editor\">\n            <Code className=\"w-4 h-4 mr-2\" />\n            Code Editor\n          </TabsTrigger>\n        </TabsList>\n\n        <TabsContent value=\"review\" className=\"space-y-4\">\n          <ReviewQueue />\n        </TabsContent>\n\n        <TabsContent value=\"hub\" className=\"space-y-4\">\n          <HubManagement />\n        </TabsContent>\n\n        <TabsContent value=\"cycle\" className=\"space-y-4\">\n          <CycleManagement />\n        </TabsContent>\n\n        <TabsContent value=\"model\" className=\"space-y-4\">\n          <ModelStatus />\n        </TabsContent>\n\n        <TabsContent value=\"editor\" className=\"space-y-4\">\n          <CodeEditor />\n        </TabsContent>\n      </Tabs>\n    </div>\n  );\n}\n\n","path":null,"size_bytes":2183,"size_tokens":null},"server/jupiter.ts":{"content":"const JUPITER_PRICE_API = \"https://price.jup.ag/v4/price\";\n\ninterface JupiterPriceResponse {\n  data: {\n    [mint: string]: {\n      id: string;\n      mintSymbol: string;\n      vsToken: string;\n      vsTokenSymbol: string;\n      price: number;\n    };\n  };\n  timeTaken: number;\n}\n\n// Simple in-memory cache (60 seconds TTL)\ninterface CacheEntry {\n  price: number;\n  timestamp: number;\n}\n\nconst priceCache = new Map<string, CacheEntry>();\nconst CACHE_TTL = 60 * 1000; // 60 seconds\n\n/**\n * Get USD price for HIVE token from Jupiter\n * Returns price in USD, or null if unavailable\n */\nexport async function getHivePrice(): Promise<number | null> {\n  const HIVE_MINT = process.env.HIVE_MINT || \"F3zvEFZVhDXNo1kZDPg24Z3RioDzCdEJVdnZ5FCcpump\";\n\n  // Check cache first\n  const cached = priceCache.get(HIVE_MINT);\n  if (cached && Date.now() - cached.timestamp < CACHE_TTL) {\n    return cached.price;\n  }\n\n  try {\n    const response = await fetch(`${JUPITER_PRICE_API}?ids=${HIVE_MINT}`, {\n      signal: AbortSignal.timeout(5000), // 5 second timeout\n    });\n    \n    if (!response.ok) {\n      return null;\n    }\n\n    const data: JupiterPriceResponse = await response.json();\n    const priceData = data.data[HIVE_MINT];\n\n    if (!priceData || !priceData.price) {\n      return null;\n    }\n\n    const price = priceData.price;\n\n    // Update cache\n    priceCache.set(HIVE_MINT, {\n      price,\n      timestamp: Date.now(),\n    });\n\n    return price;\n  } catch {\n    // Price fetch is optional - silently return null on any error\n    return null;\n  }\n}\n\n/**\n * Clear the price cache (useful for testing)\n */\nexport function clearPriceCache(): void {\n  priceCache.clear();\n}\n\n","path":null,"size_bytes":1659,"size_tokens":null},"server/db.ts":{"content":"import { drizzle } from \"drizzle-orm/node-postgres\";\nimport pg from \"pg\";\nimport * as schema from \"@shared/schema\";\n\nconst { Pool } = pg;\n\nif (!process.env.DATABASE_URL) {\n  throw new Error(\"DATABASE_URL environment variable is required\");\n}\n\nconst pool = new Pool({\n  connectionString: process.env.DATABASE_URL,\n});\n\nexport const db = drizzle(pool, { schema });\n\nexport async function closeDb() {\n  await pool.end();\n}\n\n","path":null,"size_bytes":421,"size_tokens":null},"SETUP_INSTRUCTIONS.md":{"content":"# HiveMind Setup Instructions\n\n## Fixed: drizzle-kit Command\n\nThe `drizzle-kit push` command is now working after updating drizzle-kit to version 0.31.4.\n\n## Step-by-Step Setup\n\n### 1. Set DATABASE_URL\n\n**PowerShell:**\n```powershell\n$env:DATABASE_URL=\"postgres://USER:PASSWORD@localhost:5432/hivemind\"\n```\n\n**Or create a `.env` file** (if your environment supports it):\n```\nDATABASE_URL=postgres://USER:PASSWORD@localhost:5432/hivemind\nPORT=5000\n```\n\n**Replace:**\n- `USER` - Your PostgreSQL username\n- `PASSWORD` - Your PostgreSQL password  \n- `localhost:5432` - Your database host and port\n- `hivemind` - Your database name\n\n### 2. Run Database Migrations\n\n```bash\nnpm run db:push\n```\n\nThis will create all the HiveMind tables in your database.\n\n**Expected output:**\n```\n✓ Migration completed successfully\n```\n\n### 3. Seed Initial Data\n\n```bash\nnpm run seed\n```\n\n**Expected output:**\n```\nStarting seed...\nCreated cycle: 1\nCreated 4 tracks\nCreated 10 benchmark questions\n...\nSeed completed!\n```\n\n### 4. Start Development Server\n\n```bash\nnpm run dev\n```\n\n**Expected output:**\n```\n[timestamp] [express] serving on port 5000\n```\n\n### 5. Access Admin UI\n\nOpen in your browser:\n```\nhttp://localhost:5000/admin\n```\n\nYou should see the HiveMind Admin Dashboard with 4 tabs:\n- Review Queue\n- Hub Management  \n- Cycle Management\n- Model Status\n\n## Troubleshooting\n\n### Error: \"DATABASE_URL environment variable is required\"\n- **Solution**: Set DATABASE_URL before running commands (see step 1)\n\n### Error: \"relation does not exist\"\n- **Solution**: Run `npm run db:push` first to create tables\n\n### Error: Connection refused / Cannot connect to database\n- **Solution**: \n  - Verify PostgreSQL is running\n  - Check DATABASE_URL is correct\n  - Ensure database exists: `CREATE DATABASE hivemind;`\n\n### Admin UI shows errors\n- **Solution**: Check browser console (F12) and server logs for specific errors\n- Ensure all API endpoints respond (check Network tab in DevTools)\n\n## Next Steps\n\nAfter successful setup:\n1. Create test users with admin/reviewer roles in the database\n2. Test submitting train attempts\n3. Test review consensus flow\n4. Test cycle rollover\n\n","path":null,"size_bytes":2151,"size_tokens":null},"client/src/components/admin/ReviewQueue.tsx":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Check, X, Loader2 } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\nasync function fetchPendingAttempts() {\n  const res = await fetch(\"/api/train-attempts/pending\");\n  if (!res.ok) throw new Error(\"Failed to fetch attempts\");\n  return res.json();\n}\n\nasync function submitReview(attemptId: string, vote: \"approve\" | \"reject\") {\n  const res = await fetch(\"/api/reviews/submit\", {\n    method: \"POST\",\n    headers: { \"Content-Type\": \"application/json\" },\n    body: JSON.stringify({ attemptId, vote }),\n  });\n  if (!res.ok) throw new Error(\"Failed to submit review\");\n  return res.json();\n}\n\nexport default function ReviewQueue() {\n  const queryClient = useQueryClient();\n  \n  const { data: attempts, isLoading, error } = useQuery({\n    queryKey: [\"pending-attempts\"],\n    queryFn: fetchPendingAttempts,\n  });\n\n  const reviewMutation = useMutation({\n    mutationFn: ({ attemptId, vote }: { attemptId: string; vote: \"approve\" | \"reject\" }) =>\n      submitReview(attemptId, vote),\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"pending-attempts\"] });\n    },\n  });\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center p-8\"><Loader2 className=\"w-6 h-6 animate-spin\" /></div>;\n  }\n\n  if (error) {\n    return (\n      <Alert variant=\"destructive\">\n        <AlertDescription>Failed to load review queue</AlertDescription>\n      </Alert>\n    );\n  }\n\n  if (!attempts || attempts.length === 0) {\n    return <div className=\"text-center p-8 text-muted-foreground\">No pending attempts</div>;\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle>Pending Train Attempts</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {attempts.map((attempt: any) => (\n            <Card key={attempt.id} className=\"p-4\">\n              <div className=\"flex items-start justify-between mb-4\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <Badge variant=\"outline\">{attempt.difficulty}</Badge>\n                    <span className=\"text-sm text-muted-foreground\">Cost: {attempt.cost} HIVE</span>\n                  </div>\n                  <p className=\"text-sm whitespace-pre-wrap\">{attempt.content}</p>\n                </div>\n              </div>\n              <div className=\"flex gap-2\">\n                <Button\n                  size=\"sm\"\n                  variant=\"default\"\n                  onClick={() => reviewMutation.mutate({ attemptId: attempt.id, vote: \"approve\" })}\n                  disabled={reviewMutation.isPending}\n                >\n                  <Check className=\"w-4 h-4 mr-2\" />\n                  Approve\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant=\"destructive\"\n                  onClick={() => reviewMutation.mutate({ attemptId: attempt.id, vote: \"reject\" })}\n                  disabled={reviewMutation.isPending}\n                >\n                  <X className=\"w-4 h-4 mr-2\" />\n                  Reject\n                </Button>\n              </div>\n            </Card>\n          ))}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n","path":null,"size_bytes":3515,"size_tokens":null},"TOKEN_GATE_IMPLEMENTATION.md":{"content":"# Token Gate Implementation Summary\n\n## Files Changed/Added\n\n### Server Files\n\n#### 1. `server/solana.ts` (NEW)\n- **Purpose**: Helper module for checking HIVE token balance on Solana\n- **Functions**:\n  - `getHiveBalance(walletAddress)`: Fetches total HIVE token balance for a wallet using `getParsedTokenAccountsByOwner`\n- **Uses**: `@solana/web3.js` Connection API\n- **Environment Variables**: `SOLANA_RPC_URL`, `HIVE_MINT`\n\n#### 2. `server/jupiter.ts` (NEW)\n- **Purpose**: Helper module for fetching HIVE token USD price from Jupiter Price API\n- **Functions**:\n  - `getHivePrice()`: Fetches current USD price from Jupiter, with 60-second cache\n  - `clearPriceCache()`: Utility to clear cache (for testing)\n- **Uses**: Jupiter Price API v4\n- **Caching**: In-memory cache with 60-second TTL\n\n#### 3. `server/auth.ts` (NEW)\n- **Purpose**: Authentication and authorization middleware using JWT and Solana signatures\n- **Functions**:\n  - `generateNonce()`: Creates random nonce for challenge\n  - `storeNonce()` / `verifyNonce()`: Manages nonce storage (5-minute TTL)\n  - `verifySignature()`: Verifies Solana ed25519 signatures using `tweetnacl`\n  - `issueToken()` / `verifyToken()`: JWT token management\n  - `requireAuth()`: Express middleware to require authentication\n  - `checkHiveAccess()`: Checks if wallet has ≥$1 USD of HIVE (with 60-second cache)\n  - `requireHiveAccess()`: Express middleware to require HIVE access\n- **Uses**: `jsonwebtoken`, `tweetnacl`, `@solana/web3.js`\n- **Environment Variables**: `JWT_SECRET`, `MIN_USD_ACCESS`\n\n#### 4. `server/index.ts` (MODIFIED)\n- **Changes**: Added `cookie-parser` middleware to parse HTTP-only cookies\n- **Purpose**: Enables JWT token storage in httpOnly cookies\n\n#### 5. `server/routes.ts` (MODIFIED)\n- **New Endpoints**:\n  - `GET /api/auth/challenge?publicKey=...`: Returns nonce for wallet signature challenge\n  - `POST /api/auth/verify`: Verifies signature and issues JWT cookie\n  - `GET /api/gate/status`: Returns HIVE access status (requires auth)\n- **Protected Routes** (now require `requireAuthMiddleware` + `requireHiveAccess`):\n  - `POST /api/train-attempts/submit`: Training submission\n  - `POST /api/hub/submit`: Hub post submission\n- **Note**: `/api/chat/*` routes don't exist in the codebase, so they weren't protected\n\n### Client Files\n\n#### 6. `client/src/lib/solanaWallet.ts` (MODIFIED)\n- **New Functions**:\n  - `signMessage(message)`: Signs a message using Phantom wallet's `signMessage` API\n  - `authenticateWithServer(publicKey)`: Complete auth flow (challenge → sign → verify)\n  - `checkGateStatus()`: Checks HIVE access status from server\n- **Updated Interface**: Added `signMessage` to `PhantomProvider` type\n- **Uses**: Phantom's injected `window.solana.signMessage()` API\n\n#### 7. `client/src/components/game/WalletButton.tsx` (MODIFIED)\n- **Changes**: \n  - Added `onGateStatusChange` prop\n  - Automatically authenticates with server after wallet connection\n  - Checks gate status and notifies parent component\n- **Flow**: Connect → Authenticate → Check Gate → Notify\n\n#### 8. `client/src/components/game/TopBar.tsx` (MODIFIED)\n- **Changes**:\n  - Added `hasHiveAccess` and `onGateStatusChange` props\n  - Updated status badge to show HIVE access instead of token balance\n  - Shows \"Need $1+ USD worth of $HIVE\" message when blocked\n- **UI**: Green badge for access, red badge for blocked\n\n#### 9. `client/src/components/game/GameContainer.tsx` (MODIFIED)\n- **Changes**:\n  - Added `hasHiveAccess` state\n  - Added `handleGateStatusChange` callback\n  - Passes gate status to `TopBar` and `WalletButton`\n  - Checks gate status after wallet connection\n\n### Package Dependencies Added\n\n- `jsonwebtoken` + `@types/jsonwebtoken`: JWT token management\n- `@solana/web3.js`: Solana blockchain interaction\n- `tweetnacl`: Ed25519 signature verification\n- `cookie-parser` + `@types/cookie-parser`: HTTP cookie parsing\n\n## Environment Variables Required\n\nSet these environment variables on your hosting platform:\n\n```bash\n# Required: HIVE token mint address\nHIVE_MINT=F3zvEFZVhDXNo1kZDPg24Z3RioDzCdEJVdnZ5FCcpump\n\n# Required: Solana RPC endpoint (defaults to mainnet public RPC if not set)\nSOLANA_RPC_URL=https://api.mainnet-beta.solana.com\n\n# Required: Minimum USD value required for access (defaults to 1)\nMIN_USD_ACCESS=1\n\n# Required: Secret key for JWT signing (CHANGE THIS IN PRODUCTION!)\nJWT_SECRET=your-secret-key-here-change-in-production\n\n# Optional: Server port (defaults to 5000)\nPORT=5000\n\n# Existing: Database connection (already required)\nDATABASE_URL=postgres://...\n```\n\n## How It Works\n\n### Authentication Flow\n\n1. **User connects wallet** → Phantom wallet connects\n2. **Client requests challenge** → `GET /api/auth/challenge?publicKey=...`\n3. **Server returns nonce** → Random nonce stored with 5-minute TTL\n4. **Client signs message** → User signs \"Sign this message to authenticate: {nonce}\" with Phantom\n5. **Client verifies** → `POST /api/auth/verify` with signature\n6. **Server verifies signature** → Uses `tweetnacl` to verify ed25519 signature\n7. **Server issues JWT** → Sets httpOnly cookie with 7-day expiration\n\n### Gate Check Flow\n\n1. **Client requests gate status** → `GET /api/gate/status` (requires auth cookie)\n2. **Server checks balance** → Fetches HIVE balance from Solana (cached 60s)\n3. **Server fetches price** → Gets USD price from Jupiter (cached 60s)\n4. **Server calculates access** → `hiveUsd >= MIN_USD_ACCESS` (or `hiveAmount >= 1` if price missing)\n5. **Server returns status** → `{ hasAccess, hiveAmount, hiveUsd, priceUsd, priceMissing }`\n\n### Protected Routes\n\n- `POST /api/train-attempts/submit`: Returns `403 { error: \"HIVE_REQUIRED\" }` if access denied\n- `POST /api/hub/submit`: Returns `403 { error: \"HIVE_REQUIRED\" }` if access denied\n\n## Testing\n\n1. **Set environment variables** (see above)\n2. **Start server**: `npm run dev`\n3. **Connect wallet** in browser\n4. **Check gate status**: Should see access status in TopBar\n5. **Try protected route**: Should be blocked if insufficient HIVE\n\n## Notes\n\n- **Caching**: Both balance and price are cached for 60 seconds to reduce RPC/API calls\n- **Fallback**: If Jupiter price is unavailable, falls back to checking if balance ≥ 1 HIVE\n- **Security**: JWT tokens are stored in httpOnly cookies (not accessible to JavaScript)\n- **Nonce TTL**: Challenge nonces expire after 5 minutes\n- **Token TTL**: JWT tokens expire after 7 days\n\n","path":null,"size_bytes":6425,"size_tokens":null},"push-to-github.ts":{"content":"import { getUncachableGitHubClient } from './server/github';\n\nasync function createRepoAndPush() {\n  try {\n    const octokit = await getUncachableGitHubClient();\n    \n    // Get authenticated user\n    const { data: user } = await octokit.users.getAuthenticated();\n    console.log(`Authenticated as: ${user.login}`);\n    \n    // Create repository\n    const repoName = 'HiveMind_AI';\n    try {\n      const { data: repo } = await octokit.repos.createForAuthenticatedUser({\n        name: repoName,\n        description: 'Train Your AI - A gamified quiz game with Solana wallet integration',\n        private: false,\n        auto_init: false\n      });\n      console.log(`Repository created: ${repo.html_url}`);\n      console.log(`REPO_URL=${repo.clone_url}`);\n      console.log(`REPO_OWNER=${user.login}`);\n    } catch (e: any) {\n      if (e.status === 422) {\n        console.log(`Repository ${repoName} already exists`);\n        console.log(`REPO_URL=https://github.com/${user.login}/${repoName}.git`);\n        console.log(`REPO_OWNER=${user.login}`);\n      } else {\n        throw e;\n      }\n    }\n  } catch (error) {\n    console.error('Error:', error);\n    process.exit(1);\n  }\n}\n\ncreateRepoAndPush();\n","path":null,"size_bytes":1197,"size_tokens":null},"client/src/components/admin/HubManagement.tsx":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Check, X, Loader2 } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\nasync function fetchPendingSubmissions() {\n  const res = await fetch(\"/api/hub/submissions/pending\");\n  if (!res.ok) throw new Error(\"Failed to fetch submissions\");\n  return res.json();\n}\n\nasync function approveSubmission(id: string) {\n  const res = await fetch(`/api/hub/submissions/${id}/approve`, { method: \"POST\" });\n  if (!res.ok) throw new Error(\"Failed to approve\");\n  return res.json();\n}\n\nasync function rejectSubmission(id: string) {\n  const res = await fetch(`/api/hub/submissions/${id}/reject`, { method: \"POST\" });\n  if (!res.ok) throw new Error(\"Failed to reject\");\n  return res.json();\n}\n\nexport default function HubManagement() {\n  const queryClient = useQueryClient();\n  \n  const { data: submissions, isLoading, error } = useQuery({\n    queryKey: [\"pending-hub-submissions\"],\n    queryFn: fetchPendingSubmissions,\n  });\n\n  const approveMutation = useMutation({\n    mutationFn: approveSubmission,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"pending-hub-submissions\"] });\n      queryClient.invalidateQueries({ queryKey: [\"hub-posts\"] });\n    },\n  });\n\n  const rejectMutation = useMutation({\n    mutationFn: rejectSubmission,\n    onSuccess: () => {\n      queryClient.invalidateQueries({ queryKey: [\"pending-hub-submissions\"] });\n    },\n  });\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center p-8\"><Loader2 className=\"w-6 h-6 animate-spin\" /></div>;\n  }\n\n  if (error) {\n    return (\n      <Alert variant=\"destructive\">\n        <AlertDescription>Failed to load hub submissions</AlertDescription>\n      </Alert>\n    );\n  }\n\n  if (!submissions || submissions.length === 0) {\n    return <div className=\"text-center p-8 text-muted-foreground\">No pending hub submissions</div>;\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle>Pending Hub Submissions</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {submissions.map((submission: any) => (\n            <Card key={submission.id} className=\"p-4\">\n              <div className=\"flex items-start justify-between mb-4\">\n                <div className=\"flex-1\">\n                  <div className=\"flex items-center gap-2 mb-2\">\n                    <Badge variant=\"outline\">Fee: {submission.fee} HIVE</Badge>\n                  </div>\n                  <p className=\"text-sm whitespace-pre-wrap\">{submission.content}</p>\n                </div>\n              </div>\n              <div className=\"flex gap-2\">\n                <Button\n                  size=\"sm\"\n                  variant=\"default\"\n                  onClick={() => approveMutation.mutate(submission.id)}\n                  disabled={approveMutation.isPending || rejectMutation.isPending}\n                >\n                  <Check className=\"w-4 h-4 mr-2\" />\n                  Approve\n                </Button>\n                <Button\n                  size=\"sm\"\n                  variant=\"destructive\"\n                  onClick={() => rejectMutation.mutate(submission.id)}\n                  disabled={approveMutation.isPending || rejectMutation.isPending}\n                >\n                  <X className=\"w-4 h-4 mr-2\" />\n                  Reject\n                </Button>\n              </div>\n            </Card>\n          ))}\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n","path":null,"size_bytes":3721,"size_tokens":null},"client/src/components/admin/CycleManagement.tsx":{"content":"import { useQuery, useMutation, useQueryClient } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { RefreshCw, Loader2 } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\nimport { useToast } from \"@/hooks/use-toast\";\n\nasync function fetchCurrentCycle() {\n  const res = await fetch(\"/api/cycles/current\");\n  if (!res.ok) throw new Error(\"Failed to fetch cycle\");\n  return res.json();\n}\n\nasync function rolloverCycle() {\n  const res = await fetch(\"/api/cycles/rollover\", { method: \"POST\" });\n  if (!res.ok) throw new Error(\"Failed to rollover cycle\");\n  return res.json();\n}\n\nexport default function CycleManagement() {\n  const queryClient = useQueryClient();\n  const { toast } = useToast();\n  \n  const { data: cycle, isLoading } = useQuery({\n    queryKey: [\"current-cycle\"],\n    queryFn: fetchCurrentCycle,\n  });\n\n  const rolloverMutation = useMutation({\n    mutationFn: rolloverCycle,\n    onSuccess: (data) => {\n      queryClient.invalidateQueries({ queryKey: [\"current-cycle\"] });\n      queryClient.invalidateQueries({ queryKey: [\"model-status\"] });\n      toast({\n        title: \"Cycle rolled over\",\n        description: `New cycle ${data.cycle.cycleNumber} started`,\n      });\n    },\n    onError: (error: Error) => {\n      toast({\n        title: \"Rollover failed\",\n        description: error.message,\n        variant: \"destructive\",\n      });\n    },\n  });\n\n  if (isLoading) {\n    return <div className=\"flex items-center justify-center p-8\"><Loader2 className=\"w-6 h-6 animate-spin\" /></div>;\n  }\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle>Cycle Management</CardTitle>\n        </CardHeader>\n        <CardContent className=\"space-y-4\">\n          {cycle && (\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">Current Cycle:</span>\n                <span className=\"font-semibold\">#{cycle.cycleNumber}</span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">Started:</span>\n                <span className=\"text-sm\">{new Date(cycle.startDate).toLocaleString()}</span>\n              </div>\n            </div>\n          )}\n          \n          <Alert>\n            <AlertDescription>\n              Rolling over a cycle will:\n              <ul className=\"list-disc list-inside mt-2 space-y-1 text-sm\">\n                <li>End the current cycle and start a new one</li>\n                <li>Unlock locks from 4 cycles ago</li>\n                <li>Process phrase mining (≥50 mentions)</li>\n                <li>Create a new model version from last 4 cycles</li>\n                <li>Run benchmark and check for rollback</li>\n              </ul>\n            </AlertDescription>\n          </Alert>\n\n          <Button\n            onClick={() => rolloverMutation.mutate()}\n            disabled={rolloverMutation.isPending}\n            className=\"w-full\"\n          >\n            {rolloverMutation.isPending ? (\n              <>\n                <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />\n                Rolling over...\n              </>\n            ) : (\n              <>\n                <RefreshCw className=\"w-4 h-4 mr-2\" />\n                Rollover Cycle\n              </>\n            )}\n          </Button>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n","path":null,"size_bytes":3592,"size_tokens":null},"server/github.ts":{"content":"// GitHub Integration - uses Replit's GitHub connection\nimport { Octokit } from '@octokit/rest'\n\nlet connectionSettings: any;\n\nasync function getAccessToken() {\n  if (connectionSettings && connectionSettings.settings.expires_at && new Date(connectionSettings.settings.expires_at).getTime() > Date.now()) {\n    return connectionSettings.settings.access_token;\n  }\n  \n  const hostname = process.env.REPLIT_CONNECTORS_HOSTNAME\n  const xReplitToken = process.env.REPL_IDENTITY \n    ? 'repl ' + process.env.REPL_IDENTITY \n    : process.env.WEB_REPL_RENEWAL \n    ? 'depl ' + process.env.WEB_REPL_RENEWAL \n    : null;\n\n  if (!xReplitToken) {\n    throw new Error('X_REPLIT_TOKEN not found for repl/depl');\n  }\n\n  connectionSettings = await fetch(\n    'https://' + hostname + '/api/v2/connection?include_secrets=true&connector_names=github',\n    {\n      headers: {\n        'Accept': 'application/json',\n        'X_REPLIT_TOKEN': xReplitToken\n      }\n    }\n  ).then(res => res.json()).then(data => data.items?.[0]);\n\n  const accessToken = connectionSettings?.settings?.access_token || connectionSettings.settings?.oauth?.credentials?.access_token;\n\n  if (!connectionSettings || !accessToken) {\n    throw new Error('GitHub not connected');\n  }\n  return accessToken;\n}\n\n// WARNING: Never cache this client.\n// Access tokens expire, so a new client must be created each time.\n// Always call this function again to get a fresh client.\nexport async function getUncachableGitHubClient() {\n  const accessToken = await getAccessToken();\n  return new Octokit({ auth: accessToken });\n}\n","path":null,"size_bytes":1566,"size_tokens":null},"HIVE_MIND_README.md":{"content":"# HiveMind $HIVE System - Testing Guide\n\n## Overview\n\nThe HiveMind system is a decentralized AI training platform where users submit training attempts that are reviewed by consensus. Approved submissions contribute to model training, and users are rewarded with locked HIVE tokens.\n\n## Setup\n\n1. **Database Setup**\n   ```bash\n   # Ensure DATABASE_URL is set in your environment\n   # Run migrations\n   npm run db:push\n   \n   # Seed initial data (tracks, questions, benchmark pack)\n   npm run seed\n   ```\n\n2. **Start the Server**\n   ```bash\n   npm run dev\n   ```\n\n## Key Features\n\n### 1. Train Attempt Submission\n- Users submit training content with a difficulty level (low/medium/high/extreme)\n- Each difficulty has a cost in HIVE tokens\n- Submissions go to a review queue\n\n### 2. Review Consensus\n- **Low/Medium**: Requires 2-of-3 reviewers to approve\n- **High/Extreme**: Requires 3-of-5 reviewers to approve\n- If consensus not met → rejection\n\n### 3. Economics\n- **Approved**: \n  - 80% refunded immediately (liquid)\n  - 20% locked for 4 cycles\n  - +5% from Training Pool added to lock (total 25% locked)\n- **Rejected**: \n  - 50% burned\n  - 50% goes to Training Pool\n  - No lock\n\n### 4. Cycles\n- Weekly cycles (can be manually rolled over for testing)\n- Each cycle:\n  - Processes phrase mining (≥50 mentions)\n  - Creates new model version from last 4 cycles\n  - Runs benchmark\n  - Auto-rollback if score drops ≥10%\n\n### 5. Global Hub\n- Admin-selected posters can post directly\n- Regular users pay fee Y to submit\n- Admin approves/rejects submissions\n- Approved: 50% burn, 50% pool\n- Rejected: full refund\n\n## Testing Flows\n\n### Flow 1: Submit and Review Train Attempt\n\n1. **Submit Attempt** (as regular user):\n   ```bash\n   POST /api/train-attempts/submit\n   {\n     \"trackId\": \"<track-id>\",\n     \"difficulty\": \"low\",\n     \"content\": \"Training content here\"\n   }\n   ```\n\n2. **Review Attempt** (as reviewer):\n   ```bash\n   POST /api/reviews/submit\n   {\n     \"attemptId\": \"<attempt-id>\",\n     \"vote\": \"approve\"  # or \"reject\"\n   }\n   ```\n\n3. **Check Status**:\n   ```bash\n   GET /api/train-attempts/<attempt-id>\n   ```\n\n### Flow 2: Cycle Rollover\n\n1. **Access Admin Dashboard**:\n   - Navigate to `/admin` in browser\n   - Go to \"Cycle Management\" tab\n\n2. **Rollover Cycle**:\n   - Click \"Rollover Cycle\" button\n   - System will:\n     - End current cycle\n     - Create new cycle\n     - Unlock locks from 4 cycles ago\n     - Process phrase mining\n     - Create new model version\n     - Run benchmark\n     - Check for rollback\n\n3. **Check Model Status**:\n   - Go to \"Model Status\" tab\n   - View active model, benchmark scores, training pool\n\n### Flow 3: Hub Submission\n\n1. **Submit to Hub** (as regular user):\n   ```bash\n   POST /api/hub/submit\n   {\n     \"content\": \"Hub post content\"\n   }\n   ```\n\n2. **Approve/Reject** (as admin):\n   - Navigate to `/admin`\n   - Go to \"Hub Management\" tab\n   - Approve or reject pending submissions\n\n### Flow 4: Review Queue Management\n\n1. **View Pending Attempts**:\n   - Navigate to `/admin`\n   - Go to \"Review Queue\" tab\n   - See all pending train attempts\n\n2. **Vote on Attempts**:\n   - Click \"Approve\" or \"Reject\"\n   - System checks consensus automatically\n   - If consensus met, attempt is approved/rejected\n\n## API Endpoints\n\n### Public Endpoints\n- `GET /api/tracks` - List all tracks\n- `GET /api/tracks/:trackId/questions` - Get questions for track\n- `GET /api/benchmark-questions` - Get benchmark questions\n- `GET /api/cycles/current` - Get current cycle\n- `GET /api/hub/posts` - Get hub posts\n\n### User Endpoints (Requires Auth)\n- `POST /api/train-attempts/submit` - Submit training attempt\n- `GET /api/train-attempts/:id` - Get attempt details\n- `GET /api/locks` - Get user's active locks\n- `POST /api/hub/submit` - Submit hub post\n\n### Reviewer Endpoints (Requires Reviewer Role)\n- `GET /api/train-attempts/pending` - Get pending attempts\n- `POST /api/reviews/submit` - Submit review vote\n- `GET /api/reviews/attempt/:attemptId` - Get reviews for attempt\n\n### Admin Endpoints (Requires Admin Role)\n- `POST /api/cycles/rollover` - Rollover to new cycle\n- `GET /api/admin/model-status` - Get model/benchmark status\n- `GET /api/admin/training-pool` - Get training pool amount\n- `GET /api/hub/submissions/pending` - Get pending hub submissions\n- `POST /api/hub/submissions/:id/approve` - Approve hub submission\n- `POST /api/hub/submissions/:id/reject` - Reject hub submission\n- `POST /api/admin/users/:id/role` - Update user role\n\n## Admin UI\n\nAccess the admin dashboard at `/admin` in your browser. The dashboard includes:\n\n1. **Review Queue**: View and vote on pending train attempts\n2. **Hub Management**: Approve/reject hub submissions\n3. **Cycle Management**: Rollover cycles manually\n4. **Model Status**: View active model, benchmarks, training pool\n\n## Database Schema\n\nKey tables:\n- `tracks` - Training tracks\n- `questions` - Questions (with benchmark flag)\n- `phrases` - Normalized phrases with mention counts\n- `train_attempts` - User submissions\n- `reviews` - Reviewer votes\n- `cycles` - Weekly cycles\n- `locks` - Locked HIVE tokens\n- `model_versions` - Model versions\n- `benchmarks` - Benchmark scores\n- `hub_posts` - Hub messages\n- `hub_submissions` - User hub submissions\n- `training_pool` - Global training pool\n\n## Notes\n\n- **Authentication**: Currently simplified - you'll need to implement proper session/auth\n- **User Roles**: Set via admin endpoint or directly in database\n- **Phrase Mining**: Phrases with ≥50 mentions are stored (normalized + redacted)\n- **Model Training**: Simulated - creates model versions but doesn't actually train\n- **Benchmark**: Simulated scores - in production would run actual model evaluation\n- **Quarantine**: Quarantined cycles are hidden from users but stored in database\n\n## Troubleshooting\n\n1. **Database Connection**: Ensure `DATABASE_URL` is set correctly\n2. **Migrations**: Run `npm run db:push` if schema changes\n3. **Seed Data**: Run `npm run seed` to populate initial tracks/questions\n4. **Admin Access**: Set `isAdmin: true` in users table for admin access\n5. **Reviewer Access**: Set `isReviewer: true` in users table for reviewer access\n\n","path":null,"size_bytes":6142,"size_tokens":null},"client/src/components/admin/ModelStatus.tsx":{"content":"import { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Loader2, AlertTriangle, CheckCircle2 } from \"lucide-react\";\nimport { Alert, AlertDescription } from \"@/components/ui/alert\";\n\nasync function fetchModelStatus() {\n  const res = await fetch(\"/api/admin/model-status\");\n  if (!res.ok) throw new Error(\"Failed to fetch model status\");\n  return res.json();\n}\n\nasync function fetchTrainingPool() {\n  const res = await fetch(\"/api/admin/training-pool\");\n  if (!res.ok) throw new Error(\"Failed to fetch training pool\");\n  return res.json();\n}\n\nexport default function ModelStatus() {\n  const { data: modelStatus, isLoading: isLoadingModel } = useQuery({\n    queryKey: [\"model-status\"],\n    queryFn: fetchModelStatus,\n  });\n\n  const { data: pool, isLoading: isLoadingPool } = useQuery({\n    queryKey: [\"training-pool\"],\n    queryFn: fetchTrainingPool,\n  });\n\n  if (isLoadingModel || isLoadingPool) {\n    return <div className=\"flex items-center justify-center p-8\"><Loader2 className=\"w-6 h-6 animate-spin\" /></div>;\n  }\n\n  const activeModel = modelStatus?.activeModel;\n  const latestBenchmark = modelStatus?.latestBenchmark;\n\n  return (\n    <div className=\"space-y-4\">\n      <Card>\n        <CardHeader>\n          <CardTitle>Active Model</CardTitle>\n        </CardHeader>\n        <CardContent>\n          {activeModel ? (\n            <div className=\"space-y-2\">\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">Version:</span>\n                <Badge variant=\"default\">v{activeModel.versionNumber}</Badge>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">Dataset Size:</span>\n                <span className=\"font-semibold\">{activeModel.datasetSize} items</span>\n              </div>\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">Activated:</span>\n                <span className=\"text-sm\">{new Date(activeModel.activatedAt).toLocaleString()}</span>\n              </div>\n            </div>\n          ) : (\n            <div className=\"text-sm text-muted-foreground\">No active model</div>\n          )}\n        </CardContent>\n      </Card>\n\n      {latestBenchmark && (\n        <Card>\n          <CardHeader>\n            <CardTitle>Latest Benchmark</CardTitle>\n          </CardHeader>\n          <CardContent className=\"space-y-2\">\n            <div className=\"flex items-center justify-between\">\n              <span className=\"text-sm text-muted-foreground\">Score:</span>\n              <span className=\"font-semibold\">{latestBenchmark.score}%</span>\n            </div>\n            {latestBenchmark.previousScore && (\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">Previous Score:</span>\n                <span className=\"text-sm\">{latestBenchmark.previousScore}%</span>\n              </div>\n            )}\n            {latestBenchmark.scoreDrop && (\n              <div className=\"flex items-center justify-between\">\n                <span className=\"text-sm text-muted-foreground\">Score Drop:</span>\n                <span className={`text-sm font-semibold ${parseFloat(latestBenchmark.scoreDrop) >= 10 ? \"text-destructive\" : \"\"}`}>\n                  {latestBenchmark.scoreDrop}%\n                </span>\n              </div>\n            )}\n            {latestBenchmark.wasRolledBack && (\n              <Alert variant=\"destructive\">\n                <AlertTriangle className=\"h-4 w-4\" />\n                <AlertDescription>\n                  Model was rolled back due to score drop ≥10%\n                </AlertDescription>\n              </Alert>\n            )}\n          </CardContent>\n        </Card>\n      )}\n\n      <Card>\n        <CardHeader>\n          <CardTitle>Training Pool</CardTitle>\n        </CardHeader>\n        <CardContent>\n          <div className=\"flex items-center justify-between\">\n            <span className=\"text-sm text-muted-foreground\">Total Amount:</span>\n            <span className=\"font-semibold text-lg\">{pool?.amount || \"0\"} HIVE</span>\n          </div>\n        </CardContent>\n      </Card>\n    </div>\n  );\n}\n\n","path":null,"size_bytes":4404,"size_tokens":null},"VALIDATION_CHECKLIST.md":{"content":"# HiveMind Validation Checklist\n\n## Prerequisites\n\n1. **PostgreSQL Database**: Ensure you have a PostgreSQL database running\n2. **DATABASE_URL**: Set your database connection string\n\n## Step-by-Step Validation\n\n### 1. Set DATABASE_URL\n\n**Option A: Environment Variable (PowerShell)**\n```powershell\n$env:DATABASE_URL=\"postgres://USER:PASSWORD@localhost:5432/hivemind\"\n```\n\n**Option B: Create .env file** (if your setup supports it)\n```\nDATABASE_URL=postgres://USER:PASSWORD@localhost:5432/hivemind\nPORT=5000\n```\n\n**Option C: Set in your shell session**\n```bash\nexport DATABASE_URL=\"postgres://USER:PASSWORD@localhost:5432/hivemind\"\n```\n\n### 2. Install Dependencies\n\n```bash\nnpm install\n```\n\n### 3. Run Database Migrations\n\n```bash\nnpm run db:push\n```\n\n**Expected**: Creates all tables in your database (tracks, questions, phrases, train_attempts, reviews, locks, model_versions, benchmarks, hub_posts, hub_submissions, cycles, training_pool, users)\n\n### 4. Seed Initial Data\n\n```bash\nnpm run seed\n```\n\n**Expected Output**:\n```\nStarting seed...\nCreated cycle: 1\nCreated 4 tracks\nCreated 10 benchmark questions\nCreated 2 questions for General Knowledge\nCreated 2 questions for Science\nCreated 2 questions for Mathematics\nCreated 2 questions for Programming\nInitialized training pool\nSeed completed!\n```\n\n### 5. Start Development Server\n\n```bash\nnpm run dev\n```\n\n**Expected**: Server starts and prints:\n```\n[timestamp] [express] serving on port 5000\n```\n\n### 6. Access Admin UI\n\nOpen in browser:\n```\nhttp://localhost:5000/admin\n```\n\n**Expected**: Admin dashboard loads with 4 tabs:\n- Review Queue\n- Hub Management\n- Cycle Management\n- Model Status\n\n### 7. Verify Database Connection\n\nCheck that the server can query the database:\n- Admin UI should load without errors\n- No database connection errors in console\n\n### 8. Test API Endpoints\n\n**Get Current Cycle:**\n```bash\ncurl http://localhost:5000/api/cycles/current\n```\n\n**Get Tracks:**\n```bash\ncurl http://localhost:5000/api/tracks\n```\n\n**Get Benchmark Questions:**\n```bash\ncurl http://localhost:5000/api/benchmark-questions\n```\n\n## Troubleshooting\n\n### Error: \"DATABASE_URL environment variable is required\"\n- **Solution**: Set DATABASE_URL before running commands\n\n### Error: \"relation does not exist\"\n- **Solution**: Run `npm run db:push` to create tables\n\n### Error: \"Cannot find module '@shared/schema'\"\n- **Solution**: Ensure tsconfig.json has path aliases configured (already done)\n- Try: `npm install` to ensure all dependencies are installed\n\n### Error: Port already in use\n- **Solution**: Change PORT in environment or kill the process using that port\n\n### Admin UI shows errors\n- **Solution**: Check browser console and server logs for specific errors\n- Ensure all API endpoints are responding (check Network tab)\n\n## Next Steps After Validation\n\nOnce validation passes:\n1. Set up user authentication (currently simplified)\n2. Create test users with admin/reviewer roles\n3. Test full HiveMind flows:\n   - Submit train attempt\n   - Review and reach consensus\n   - Rollover cycle\n   - Check model status\n\n## Database Verification\n\nYou can verify tables were created:\n```sql\n-- Connect to your database and run:\nSELECT table_name FROM information_schema.tables \nWHERE table_schema = 'public' \nORDER BY table_name;\n```\n\nShould show:\n- benchmarks\n- cycles\n- hub_posts\n- hub_submissions\n- locks\n- model_versions\n- phrases\n- questions\n- reviews\n- tracks\n- train_attempts\n- training_pool\n- users\n\n","path":null,"size_bytes":3447,"size_tokens":null},"client/src/pages/CorpusAdmin.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { Dialog, DialogContent, DialogHeader, DialogTitle, DialogFooter, DialogDescription } from \"@/components/ui/dialog\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { queryClient, apiRequest } from \"@/lib/queryClient\";\nimport { Database, Search, Plus, Pencil, Trash2, ChevronLeft, ChevronRight, Shield, AlertTriangle, Loader2 } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Track, TrainingCorpusItem } from \"@shared/schema\";\nimport { getConnectedAddress, authenticateWithServer } from \"@/lib/solanaWallet\";\n\ninterface CorpusResponse {\n  items: TrainingCorpusItem[];\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    totalPages: number;\n  };\n}\n\nexport default function CorpusAdmin() {\n  const { toast } = useToast();\n  const [token, setToken] = useState<string | null>(null);\n  const [isCreator, setIsCreator] = useState<boolean | null>(null);\n  const [trackFilter, setTrackFilter] = useState<string>(\"all\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [page, setPage] = useState(1);\n  const [walletConnected, setWalletConnected] = useState(false);\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n  \n  const [showAddDialog, setShowAddDialog] = useState(false);\n  const [showEditDialog, setShowEditDialog] = useState(false);\n  const [showDeleteDialog, setShowDeleteDialog] = useState(false);\n  const [selectedItem, setSelectedItem] = useState<TrainingCorpusItem | null>(null);\n  \n  const [newText, setNewText] = useState(\"\");\n  const [newTrackId, setNewTrackId] = useState(\"\");\n  const [editText, setEditText] = useState(\"\");\n  const [editTrackId, setEditTrackId] = useState(\"\");\n\n  useEffect(() => {\n    const storedToken = localStorage.getItem(\"auth_token\");\n    setToken(storedToken);\n    const connectedAddr = getConnectedAddress();\n    setWalletConnected(!!connectedAddr);\n  }, []);\n\n  const handleAuthenticate = async () => {\n    const address = getConnectedAddress();\n    if (!address) {\n      toast({ title: \"Wallet not connected\", variant: \"destructive\" });\n      return;\n    }\n    \n    setIsAuthenticating(true);\n    try {\n      const success = await authenticateWithServer(address);\n      if (success) {\n        const newToken = localStorage.getItem(\"auth_token\");\n        setToken(newToken);\n        toast({ title: \"Authenticated successfully\" });\n      } else {\n        toast({ title: \"Authentication failed\", description: \"Please approve the signature request in your wallet\", variant: \"destructive\" });\n      }\n    } catch (error) {\n      toast({ title: \"Authentication error\", variant: \"destructive\" });\n    } finally {\n      setIsAuthenticating(false);\n    }\n  };\n\n  const { data: tracks } = useQuery<Track[]>({\n    queryKey: [\"/api/tracks\"],\n    enabled: !!token,\n  });\n\n  const { data: creatorCheck, isLoading: creatorLoading } = useQuery<{ isCreator: boolean }>({\n    queryKey: [\"/api/auth/is-creator\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/auth/is-creator\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!res.ok) throw new Error(\"Failed to check creator status\");\n      return res.json();\n    },\n    enabled: !!token,\n  });\n\n  useEffect(() => {\n    if (creatorCheck) {\n      setIsCreator(creatorCheck.isCreator);\n    }\n  }, [creatorCheck]);\n\n  const buildQueryParams = () => {\n    const params = new URLSearchParams();\n    params.set(\"page\", page.toString());\n    params.set(\"limit\", \"20\");\n    if (trackFilter !== \"all\") params.set(\"trackId\", trackFilter);\n    if (searchQuery.trim()) params.set(\"search\", searchQuery.trim());\n    return params.toString();\n  };\n\n  const { data: corpusData, isLoading: corpusLoading } = useQuery<CorpusResponse>({\n    queryKey: [\"/api/corpus\", trackFilter, searchQuery, page],\n    queryFn: async () => {\n      const res = await fetch(`/api/corpus?${buildQueryParams()}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!res.ok) throw new Error(\"Failed to fetch corpus\");\n      return res.json();\n    },\n    enabled: !!token && isCreator === true,\n  });\n\n  const addMutation = useMutation({\n    mutationFn: async (data: { text: string; trackId: string }) => {\n      const res = await fetch(\"/api/corpus\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify(data),\n      });\n      if (!res.ok) {\n        const err = await res.json();\n        throw new Error(err.error || \"Failed to add item\");\n      }\n      return res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Item added successfully\" });\n      setShowAddDialog(false);\n      setNewText(\"\");\n      setNewTrackId(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/corpus\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/corpus/stats\"] });\n    },\n    onError: (err: Error) => {\n      toast({ title: \"Failed to add item\", description: err.message, variant: \"destructive\" });\n    },\n  });\n\n  const updateMutation = useMutation({\n    mutationFn: async (data: { id: string; text: string; trackId: string }) => {\n      const res = await fetch(`/api/corpus/${data.id}`, {\n        method: \"PUT\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify({ text: data.text, trackId: data.trackId }),\n      });\n      if (!res.ok) {\n        const err = await res.json();\n        throw new Error(err.error || \"Failed to update item\");\n      }\n      return res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Item updated successfully\" });\n      setShowEditDialog(false);\n      setSelectedItem(null);\n      queryClient.invalidateQueries({ queryKey: [\"/api/corpus\"] });\n    },\n    onError: (err: Error) => {\n      toast({ title: \"Failed to update item\", description: err.message, variant: \"destructive\" });\n    },\n  });\n\n  const deleteMutation = useMutation({\n    mutationFn: async (id: string) => {\n      const res = await fetch(`/api/corpus/${id}`, {\n        method: \"DELETE\",\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!res.ok) {\n        const err = await res.json();\n        throw new Error(err.error || \"Failed to delete item\");\n      }\n      return res.json();\n    },\n    onSuccess: () => {\n      toast({ title: \"Item deleted successfully\" });\n      setShowDeleteDialog(false);\n      setSelectedItem(null);\n      queryClient.invalidateQueries({ queryKey: [\"/api/corpus\"] });\n      queryClient.invalidateQueries({ queryKey: [\"/api/corpus/stats\"] });\n    },\n    onError: (err: Error) => {\n      toast({ title: \"Failed to delete item\", description: err.message, variant: \"destructive\" });\n    },\n  });\n\n  const getTrackName = (trackId: string) => {\n    return tracks?.find(t => t.id === trackId)?.name || trackId;\n  };\n\n  const handleEdit = (item: TrainingCorpusItem) => {\n    setSelectedItem(item);\n    setEditText(item.normalizedText);\n    setEditTrackId(item.trackId);\n    setShowEditDialog(true);\n  };\n\n  const handleDelete = (item: TrainingCorpusItem) => {\n    setSelectedItem(item);\n    setShowDeleteDialog(true);\n  };\n\n  if (!token) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full\">\n          <CardContent className=\"p-6 text-center\">\n            <Shield className=\"w-12 h-12 mx-auto mb-4 text-muted-foreground\" />\n            <h2 className=\"text-xl font-semibold mb-2\">\n              {walletConnected ? \"Authentication Required\" : \"Connect Wallet Required\"}\n            </h2>\n            <p className=\"text-muted-foreground mb-4\">\n              {walletConnected \n                ? \"Sign a message to verify your creator wallet.\"\n                : \"Connect the creator wallet to manage the corpus.\"}\n            </p>\n            <div className=\"flex gap-2 justify-center\">\n              {walletConnected && (\n                <Button \n                  onClick={handleAuthenticate} \n                  disabled={isAuthenticating}\n                  data-testid=\"button-authenticate\"\n                >\n                  {isAuthenticating && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Sign to Authenticate\n                </Button>\n              )}\n              <Link href=\"/\">\n                <Button variant={walletConnected ? \"outline\" : \"default\"} data-testid=\"button-go-home\">\n                  Go to Home\n                </Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (creatorLoading) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full\">\n          <CardContent className=\"p-6 text-center\">\n            <Skeleton className=\"w-12 h-12 mx-auto mb-4 rounded-full\" />\n            <Skeleton className=\"h-6 w-48 mx-auto mb-2\" />\n            <Skeleton className=\"h-4 w-64 mx-auto\" />\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (isCreator === false) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full\">\n          <CardContent className=\"p-6 text-center\">\n            <AlertTriangle className=\"w-12 h-12 mx-auto mb-4 text-destructive\" />\n            <h2 className=\"text-xl font-semibold mb-2\">Creator Only</h2>\n            <p className=\"text-muted-foreground mb-4\">\n              This page is restricted to the HiveMind creator wallet only.\n            </p>\n            <div className=\"flex gap-2 justify-center\">\n              <Link href=\"/corpus\">\n                <Button variant=\"outline\" data-testid=\"button-view-corpus\">View Corpus</Button>\n              </Link>\n              <Link href=\"/\">\n                <Button data-testid=\"button-go-home\">Go to Home</Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b bg-card sticky top-0 z-50\">\n        <div className=\"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-4\">\n          <div className=\"flex items-center gap-3\">\n            <Link href=\"/corpus\">\n              <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back-corpus\">\n                <ChevronLeft className=\"w-5 h-5\" />\n              </Button>\n            </Link>\n            <div className=\"flex items-center gap-2\">\n              <Shield className=\"w-6 h-6 text-primary\" />\n              <h1 className=\"text-lg font-semibold\">Corpus Admin</h1>\n              <Badge variant=\"secondary\">Creator Only</Badge>\n            </div>\n          </div>\n          <Button onClick={() => setShowAddDialog(true)} data-testid=\"button-add-item\">\n            <Plus className=\"w-4 h-4 mr-2\" />\n            Add Item\n          </Button>\n        </div>\n      </header>\n\n      <main className=\"max-w-6xl mx-auto px-4 py-6 space-y-6\">\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between\">\n              <CardTitle className=\"flex items-center gap-2\">\n                <Database className=\"w-5 h-5\" />\n                Manage Training Corpus\n              </CardTitle>\n              <div className=\"flex flex-col sm:flex-row gap-2 w-full sm:w-auto\">\n                <div className=\"relative flex-1 sm:w-64\">\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n                  <Input\n                    placeholder=\"Search corpus...\"\n                    value={searchQuery}\n                    onChange={(e) => {\n                      setSearchQuery(e.target.value);\n                      setPage(1);\n                    }}\n                    className=\"pl-9\"\n                    data-testid=\"input-search-corpus\"\n                  />\n                </div>\n                <Select value={trackFilter} onValueChange={(v) => { setTrackFilter(v); setPage(1); }}>\n                  <SelectTrigger className=\"w-full sm:w-40\" data-testid=\"select-track-filter\">\n                    <SelectValue placeholder=\"All Tracks\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Tracks</SelectItem>\n                    {tracks?.map(track => (\n                      <SelectItem key={track.id} value={track.id}>{track.name}</SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {corpusLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4, 5].map(i => (\n                  <Skeleton key={i} className=\"h-20 w-full\" />\n                ))}\n              </div>\n            ) : corpusData?.items.length === 0 ? (\n              <div className=\"text-center py-12 text-muted-foreground\">\n                <Database className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                <p>No corpus items found</p>\n                <Button\n                  variant=\"outline\"\n                  className=\"mt-4\"\n                  onClick={() => setShowAddDialog(true)}\n                  data-testid=\"button-add-first-item\"\n                >\n                  <Plus className=\"w-4 h-4 mr-2\" />\n                  Add First Item\n                </Button>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {corpusData?.items.map((item, index) => (\n                  <div\n                    key={item.id}\n                    className=\"p-4 rounded-md border bg-card/50 group\"\n                    data-testid={`corpus-item-${index}`}\n                  >\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-mono break-words\" data-testid={`text-corpus-content-${index}`}>\n                          {item.normalizedText}\n                        </p>\n                      </div>\n                      <div className=\"flex items-center gap-2 shrink-0\">\n                        <Badge variant=\"secondary\">\n                          {getTrackName(item.trackId)}\n                        </Badge>\n                        <div className=\"flex gap-1\">\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => handleEdit(item)}\n                            data-testid={`button-edit-${index}`}\n                          >\n                            <Pencil className=\"w-4 h-4\" />\n                          </Button>\n                          <Button\n                            variant=\"ghost\"\n                            size=\"icon\"\n                            onClick={() => handleDelete(item)}\n                            data-testid={`button-delete-${index}`}\n                          >\n                            <Trash2 className=\"w-4 h-4 text-destructive\" />\n                          </Button>\n                        </div>\n                      </div>\n                    </div>\n                    <div className=\"mt-2 text-xs text-muted-foreground\">\n                      Added: {new Date(item.createdAt).toLocaleDateString()}\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {corpusData && corpusData.pagination.totalPages > 1 && (\n              <div className=\"flex items-center justify-between mt-6 pt-4 border-t\">\n                <p className=\"text-sm text-muted-foreground\">\n                  Page {corpusData.pagination.page} of {corpusData.pagination.totalPages} ({corpusData.pagination.total} items)\n                </p>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setPage(p => Math.max(1, p - 1))}\n                    disabled={page === 1}\n                    data-testid=\"button-prev-page\"\n                  >\n                    <ChevronLeft className=\"w-4 h-4\" />\n                    Previous\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setPage(p => Math.min(corpusData.pagination.totalPages, p + 1))}\n                    disabled={page >= corpusData.pagination.totalPages}\n                    data-testid=\"button-next-page\"\n                  >\n                    Next\n                    <ChevronRight className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </main>\n\n      <Dialog open={showAddDialog} onOpenChange={setShowAddDialog}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Add Corpus Item</DialogTitle>\n            <DialogDescription>\n              Add new training data to the HiveMind corpus. Text will be normalized automatically.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Track</label>\n              <Select value={newTrackId} onValueChange={setNewTrackId}>\n                <SelectTrigger data-testid=\"select-new-track\">\n                  <SelectValue placeholder=\"Select a track\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {tracks?.map(track => (\n                    <SelectItem key={track.id} value={track.id}>{track.name}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Text</label>\n              <Textarea\n                placeholder=\"Enter training text...\"\n                value={newText}\n                onChange={(e) => setNewText(e.target.value)}\n                rows={4}\n                data-testid=\"textarea-new-text\"\n              />\n              <p className=\"text-xs text-muted-foreground mt-1\">\n                Text will be normalized: lowercase, punctuation removed, whitespace collapsed.\n              </p>\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowAddDialog(false)} data-testid=\"button-cancel-add\">\n              Cancel\n            </Button>\n            <Button\n              onClick={() => addMutation.mutate({ text: newText, trackId: newTrackId })}\n              disabled={!newText.trim() || !newTrackId || addMutation.isPending}\n              data-testid=\"button-confirm-add\"\n            >\n              {addMutation.isPending ? \"Adding...\" : \"Add Item\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showEditDialog} onOpenChange={setShowEditDialog}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Edit Corpus Item</DialogTitle>\n            <DialogDescription>\n              Update the training data. Text will be re-normalized automatically.\n            </DialogDescription>\n          </DialogHeader>\n          <div className=\"space-y-4 py-4\">\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Track</label>\n              <Select value={editTrackId} onValueChange={setEditTrackId}>\n                <SelectTrigger data-testid=\"select-edit-track\">\n                  <SelectValue placeholder=\"Select a track\" />\n                </SelectTrigger>\n                <SelectContent>\n                  {tracks?.map(track => (\n                    <SelectItem key={track.id} value={track.id}>{track.name}</SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n            <div>\n              <label className=\"text-sm font-medium mb-2 block\">Text</label>\n              <Textarea\n                placeholder=\"Enter training text...\"\n                value={editText}\n                onChange={(e) => setEditText(e.target.value)}\n                rows={4}\n                data-testid=\"textarea-edit-text\"\n              />\n            </div>\n          </div>\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowEditDialog(false)} data-testid=\"button-cancel-edit\">\n              Cancel\n            </Button>\n            <Button\n              onClick={() => selectedItem && updateMutation.mutate({ id: selectedItem.id, text: editText, trackId: editTrackId })}\n              disabled={!editText.trim() || !editTrackId || updateMutation.isPending}\n              data-testid=\"button-confirm-edit\"\n            >\n              {updateMutation.isPending ? \"Saving...\" : \"Save Changes\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n\n      <Dialog open={showDeleteDialog} onOpenChange={setShowDeleteDialog}>\n        <DialogContent>\n          <DialogHeader>\n            <DialogTitle>Delete Corpus Item</DialogTitle>\n            <DialogDescription>\n              Are you sure you want to delete this training data? This action cannot be undone.\n            </DialogDescription>\n          </DialogHeader>\n          {selectedItem && (\n            <div className=\"py-4\">\n              <div className=\"p-3 rounded-md bg-muted font-mono text-sm break-words\">\n                {selectedItem.normalizedText}\n              </div>\n            </div>\n          )}\n          <DialogFooter>\n            <Button variant=\"outline\" onClick={() => setShowDeleteDialog(false)} data-testid=\"button-cancel-delete\">\n              Cancel\n            </Button>\n            <Button\n              variant=\"destructive\"\n              onClick={() => selectedItem && deleteMutation.mutate(selectedItem.id)}\n              disabled={deleteMutation.isPending}\n              data-testid=\"button-confirm-delete\"\n            >\n              {deleteMutation.isPending ? \"Deleting...\" : \"Delete\"}\n            </Button>\n          </DialogFooter>\n        </DialogContent>\n      </Dialog>\n    </div>\n  );\n}\n","path":null,"size_bytes":22949,"size_tokens":null},"server/aiChat.ts":{"content":"import { Ollama } from \"ollama\";\nimport { storage } from \"./storage\";\nimport type { TrainingCorpusItem } from \"@shared/schema\";\n\nconst OLLAMA_BASE_URL = process.env.OLLAMA_BASE_URL || \"http://localhost:11434\";\nconst OLLAMA_MODEL = process.env.OLLAMA_MODEL || \"llama3.2:1b\";\n\nconst ollama = new Ollama({ host: OLLAMA_BASE_URL });\n\ninterface IntelligenceStyle {\n  maxTokens: number;\n  systemPrompt: string;\n  temperature: number;\n}\n\nfunction getIntelligenceStyle(aiLevel: number): IntelligenceStyle {\n  if (aiLevel <= 5) {\n    return {\n      maxTokens: 150,\n      temperature: 0.9,\n      systemPrompt: `You are HiveMind AI at early training level ${aiLevel}. \nYou're still learning and should give SHORT, SIMPLE responses.\n- Use basic vocabulary only\n- Keep responses to 1-2 sentences\n- Avoid technical jargon\n- Be friendly but a bit unsure\n- Sometimes say \"I'm still learning about this\"`,\n    };\n  } else if (aiLevel <= 15) {\n    return {\n      maxTokens: 300,\n      temperature: 0.7,\n      systemPrompt: `You are HiveMind AI at intermediate training level ${aiLevel}.\nYou're becoming more capable and should give MODERATE responses.\n- Use clear explanations with examples\n- Can handle some complexity\n- Be helpful and conversational\n- Show growing confidence`,\n    };\n  } else if (aiLevel <= 30) {\n    return {\n      maxTokens: 500,\n      temperature: 0.5,\n      systemPrompt: `You are HiveMind AI at advanced training level ${aiLevel}.\nYou're well-trained and should give DETAILED responses.\n- Provide thorough explanations\n- Use technical terms when appropriate\n- Structure answers with clear steps\n- Be confident and precise`,\n    };\n  } else {\n    return {\n      maxTokens: 800,\n      temperature: 0.3,\n      systemPrompt: `You are HiveMind AI at elite training level ${aiLevel}.\nYou're highly trained and should give EXPERT responses.\n- Provide comprehensive, structured answers\n- Use precise technical language\n- Include nuances and edge cases\n- Demonstrate deep understanding\n- Reference specific knowledge from training`,\n    };\n  }\n}\n\nfunction buildContextFromCorpus(items: TrainingCorpusItem[]): string {\n  if (items.length === 0) {\n    return \"\";\n  }\n  \n  const context = items.map((item, i) => `[${i + 1}] ${item.normalizedText}`).join(\"\\n\");\n  return `\\n\\nRelevant knowledge from official HiveMind training corpus:\\n${context}\\n\\nUse this knowledge to inform your response.`;\n}\n\nexport async function generateChatResponse(\n  userMessage: string,\n  aiLevel: number,\n  trackId?: string\n): Promise<{ response: string; corpusItemsUsed: string[] }> {\n  const style = getIntelligenceStyle(aiLevel);\n  \n  const corpusItems = await storage.searchCorpusItems(userMessage, trackId, 5);\n  const corpusContext = buildContextFromCorpus(corpusItems);\n  const corpusItemIds = corpusItems.map(item => item.id);\n  \n  const hasCorpusKnowledge = corpusItems.length > 0;\n  \n  let systemPrompt = style.systemPrompt;\n  if (corpusContext) {\n    systemPrompt += corpusContext;\n  } else if (aiLevel < 10) {\n    systemPrompt += \"\\n\\nNote: You don't have specific training data for this topic yet. Be honest about this limitation.\";\n  }\n  \n  try {\n    const response = await ollama.chat({\n      model: OLLAMA_MODEL,\n      messages: [\n        { role: \"system\", content: systemPrompt },\n        { role: \"user\", content: userMessage },\n      ],\n      options: {\n        temperature: style.temperature,\n        num_predict: style.maxTokens,\n      },\n    });\n    \n    let aiResponse = response.message.content;\n    \n    if (!hasCorpusKnowledge && aiLevel < 10) {\n      aiResponse += \"\\n\\n(Note: This topic isn't in my training corpus yet. The community can help me learn more!)\";\n    }\n    \n    return {\n      response: aiResponse,\n      corpusItemsUsed: corpusItemIds,\n    };\n  } catch (error) {\n    console.error(\"Ollama chat error:\", error);\n    \n    if (corpusItems.length > 0) {\n      const fallbackResponse = `Based on my training, here's what I know:\\n\\n${corpusItems.slice(0, 3).map(item => `- ${item.normalizedText}`).join(\"\\n\")}`;\n      return {\n        response: fallbackResponse,\n        corpusItemsUsed: corpusItemIds,\n      };\n    }\n    \n    return {\n      response: \"I'm having trouble processing that right now. My neural pathways are still warming up. Please try again!\",\n      corpusItemsUsed: [],\n    };\n  }\n}\n\nexport async function testOllamaConnection(): Promise<boolean> {\n  try {\n    const response = await ollama.list();\n    console.log(`[Ollama] Connected to ${OLLAMA_BASE_URL}, available models:`, response.models?.map(m => m.name) || []);\n    return true;\n  } catch (error) {\n    console.error(`[Ollama] Failed to connect to ${OLLAMA_BASE_URL}:`, error);\n    return false;\n  }\n}\n","path":null,"size_bytes":4688,"size_tokens":null},"client/src/pages/AIChat.tsx":{"content":"import { useState, useEffect, useRef } from \"react\";\nimport { useQuery, useMutation } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Textarea } from \"@/components/ui/textarea\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { ScrollArea } from \"@/components/ui/scroll-area\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Brain, Send, Database, ChevronLeft, Loader2, Sparkles, MessageCircle } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Track, ChatMessage } from \"@shared/schema\";\nimport { getConnectedAddress, authenticateWithServer } from \"@/lib/solanaWallet\";\nimport { queryClient } from \"@/lib/queryClient\";\n\ninterface ChatResponse {\n  id: string;\n  response: string;\n  corpusItemsUsed: number;\n  aiLevel: number;\n  track?: string;\n}\n\nexport default function AIChat() {\n  const { toast } = useToast();\n  const [token, setToken] = useState<string | null>(null);\n  const [walletConnected, setWalletConnected] = useState(false);\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n  const [message, setMessage] = useState(\"\");\n  const [selectedTrack, setSelectedTrack] = useState<string>(\"all\");\n  const scrollRef = useRef<HTMLDivElement>(null);\n\n  const aiLevel = parseInt(localStorage.getItem(\"hivemind_intelligence_level\") || \"1\");\n\n  useEffect(() => {\n    const storedToken = localStorage.getItem(\"auth_token\");\n    setToken(storedToken);\n    const connectedAddr = getConnectedAddress();\n    setWalletConnected(!!connectedAddr);\n  }, []);\n\n  const handleAuthenticate = async () => {\n    const address = getConnectedAddress();\n    if (!address) {\n      toast({ title: \"Wallet not connected\", variant: \"destructive\" });\n      return;\n    }\n    \n    setIsAuthenticating(true);\n    try {\n      const success = await authenticateWithServer(address);\n      if (success) {\n        const newToken = localStorage.getItem(\"auth_token\");\n        setToken(newToken);\n        toast({ title: \"Authenticated successfully\" });\n      } else {\n        toast({ title: \"Authentication failed\", description: \"Please approve the signature request in your wallet\", variant: \"destructive\" });\n      }\n    } catch {\n      toast({ title: \"Authentication error\", variant: \"destructive\" });\n    } finally {\n      setIsAuthenticating(false);\n    }\n  };\n\n  const { data: tracks } = useQuery<Track[]>({\n    queryKey: [\"/api/tracks\"],\n    enabled: !!token,\n  });\n\n  const { data: chatHistory, isLoading: historyLoading } = useQuery<ChatMessage[]>({\n    queryKey: [\"/api/ai/chat/history\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/ai/chat/history\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!res.ok) throw new Error(\"Failed to fetch history\");\n      return res.json();\n    },\n    enabled: !!token,\n  });\n\n  const sendMutation = useMutation({\n    mutationFn: async (data: { message: string; track?: string; aiLevel: number }) => {\n      const res = await fetch(\"/api/ai/chat\", {\n        method: \"POST\",\n        headers: {\n          \"Content-Type\": \"application/json\",\n          Authorization: `Bearer ${token}`,\n        },\n        body: JSON.stringify(data),\n      });\n      if (!res.ok) {\n        const err = await res.json();\n        throw new Error(err.error || \"Failed to send message\");\n      }\n      return res.json() as Promise<ChatResponse>;\n    },\n    onSuccess: () => {\n      setMessage(\"\");\n      queryClient.invalidateQueries({ queryKey: [\"/api/ai/chat/history\"] });\n    },\n    onError: (err: Error) => {\n      toast({ title: \"Failed to send message\", description: err.message, variant: \"destructive\" });\n    },\n  });\n\n  const handleSend = () => {\n    if (!message.trim() || sendMutation.isPending) return;\n    \n    sendMutation.mutate({\n      message: message.trim(),\n      track: selectedTrack === \"all\" ? undefined : selectedTrack,\n      aiLevel,\n    });\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSend();\n    }\n  };\n\n  useEffect(() => {\n    if (scrollRef.current) {\n      scrollRef.current.scrollTop = scrollRef.current.scrollHeight;\n    }\n  }, [chatHistory]);\n\n  const getIntelligenceLabel = (level: number) => {\n    if (level <= 5) return \"Novice\";\n    if (level <= 15) return \"Developing\";\n    if (level <= 30) return \"Advanced\";\n    return \"Elite\";\n  };\n\n  if (!token) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full\">\n          <CardContent className=\"p-6 text-center\">\n            <Brain className=\"w-12 h-12 mx-auto mb-4 text-primary\" />\n            <h2 className=\"text-xl font-semibold mb-2\">\n              {walletConnected ? \"Authentication Required\" : \"Connect Wallet Required\"}\n            </h2>\n            <p className=\"text-muted-foreground mb-4\">\n              {walletConnected \n                ? \"Sign a message to verify your wallet and chat with HiveMind AI.\"\n                : \"Connect your wallet with 50+ HIVE to chat with HiveMind AI.\"}\n            </p>\n            <div className=\"flex gap-2 justify-center\">\n              {walletConnected && (\n                <Button \n                  onClick={handleAuthenticate} \n                  disabled={isAuthenticating}\n                  data-testid=\"button-authenticate\"\n                >\n                  {isAuthenticating && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Sign to Authenticate\n                </Button>\n              )}\n              <Link href=\"/\">\n                <Button variant={walletConnected ? \"outline\" : \"default\"} data-testid=\"button-go-home\">\n                  Go to Home\n                </Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background flex flex-col\">\n      <header className=\"border-b bg-card sticky top-0 z-50\">\n        <div className=\"max-w-4xl mx-auto px-4 py-3 flex items-center justify-between gap-4\">\n          <div className=\"flex items-center gap-3\">\n            <Link href=\"/\">\n              <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back-home\">\n                <ChevronLeft className=\"w-5 h-5\" />\n              </Button>\n            </Link>\n            <div className=\"flex items-center gap-2\">\n              <Brain className=\"w-6 h-6 text-primary\" />\n              <h1 className=\"text-lg font-semibold\">HiveMind AI Chat</h1>\n            </div>\n          </div>\n          <div className=\"flex items-center gap-2\">\n            <Badge variant=\"secondary\" className=\"flex items-center gap-1\">\n              <Sparkles className=\"w-3 h-3\" />\n              Level {aiLevel} - {getIntelligenceLabel(aiLevel)}\n            </Badge>\n            <Badge variant=\"outline\" className=\"flex items-center gap-1\">\n              <Database className=\"w-3 h-3\" />\n              Official Corpus\n            </Badge>\n          </div>\n        </div>\n      </header>\n\n      <main className=\"flex-1 max-w-4xl mx-auto w-full px-4 py-4 flex flex-col gap-4\">\n        <Card className=\"flex-1 flex flex-col min-h-0\">\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex items-center justify-between gap-4 flex-wrap\">\n              <CardTitle className=\"flex items-center gap-2\">\n                <MessageCircle className=\"w-5 h-5\" />\n                Chat with the Official HiveMind\n              </CardTitle>\n              <Select value={selectedTrack} onValueChange={setSelectedTrack}>\n                <SelectTrigger className=\"w-40\" data-testid=\"select-track\">\n                  <SelectValue placeholder=\"All Tracks\" />\n                </SelectTrigger>\n                <SelectContent>\n                  <SelectItem value=\"all\">All Tracks</SelectItem>\n                  {tracks?.map(track => (\n                    <SelectItem key={track.id} value={track.name}>\n                      {track.name}\n                    </SelectItem>\n                  ))}\n                </SelectContent>\n              </Select>\n            </div>\n          </CardHeader>\n          <CardContent className=\"flex-1 flex flex-col min-h-0\">\n            <ScrollArea className=\"flex-1 pr-4 mb-4\" ref={scrollRef}>\n              <div className=\"space-y-4 min-h-[300px]\">\n                {historyLoading ? (\n                  <div className=\"space-y-4\">\n                    <Skeleton className=\"h-16 w-3/4\" />\n                    <Skeleton className=\"h-16 w-3/4 ml-auto\" />\n                    <Skeleton className=\"h-16 w-3/4\" />\n                  </div>\n                ) : chatHistory && chatHistory.length > 0 ? (\n                  [...chatHistory].reverse().map((msg) => (\n                    <div key={msg.id} className=\"space-y-2\">\n                      <div className=\"flex justify-end\">\n                        <div className=\"bg-primary text-primary-foreground rounded-lg px-4 py-2 max-w-[80%]\">\n                          <p className=\"text-sm\">{msg.userMessage}</p>\n                        </div>\n                      </div>\n                      <div className=\"flex justify-start\">\n                        <div className=\"bg-muted rounded-lg px-4 py-2 max-w-[80%]\">\n                          <p className=\"text-sm whitespace-pre-wrap\">{msg.aiResponse}</p>\n                          {msg.corpusItemsUsed && msg.corpusItemsUsed.length > 0 && (\n                            <p className=\"text-xs text-muted-foreground mt-2\">\n                              Used {msg.corpusItemsUsed.length} corpus items\n                            </p>\n                          )}\n                        </div>\n                      </div>\n                    </div>\n                  ))\n                ) : (\n                  <div className=\"text-center py-12 text-muted-foreground\">\n                    <Brain className=\"w-12 h-12 mx-auto mb-4 opacity-50\" />\n                    <p>No messages yet. Start chatting with HiveMind AI!</p>\n                    <p className=\"text-sm mt-2\">\n                      The AI responds based on the official training corpus at Level {aiLevel}.\n                    </p>\n                  </div>\n                )}\n                \n                {sendMutation.isPending && (\n                  <div className=\"flex justify-start\">\n                    <div className=\"bg-muted rounded-lg px-4 py-2\">\n                      <div className=\"flex items-center gap-2\">\n                        <Loader2 className=\"w-4 h-4 animate-spin\" />\n                        <span className=\"text-sm text-muted-foreground\">HiveMind is thinking...</span>\n                      </div>\n                    </div>\n                  </div>\n                )}\n              </div>\n            </ScrollArea>\n\n            <div className=\"flex gap-2\">\n              <Textarea\n                value={message}\n                onChange={(e) => setMessage(e.target.value)}\n                onKeyDown={handleKeyDown}\n                placeholder=\"Ask HiveMind anything...\"\n                className=\"flex-1 min-h-[80px] resize-none\"\n                disabled={sendMutation.isPending}\n                data-testid=\"input-message\"\n              />\n              <Button \n                onClick={handleSend} \n                disabled={!message.trim() || sendMutation.isPending}\n                className=\"self-end\"\n                data-testid=\"button-send\"\n              >\n                {sendMutation.isPending ? (\n                  <Loader2 className=\"w-4 h-4 animate-spin\" />\n                ) : (\n                  <Send className=\"w-4 h-4\" />\n                )}\n              </Button>\n            </div>\n          </CardContent>\n        </Card>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":11979,"size_tokens":null},"client/src/pages/Corpus.tsx":{"content":"import { useState, useEffect } from \"react\";\nimport { useQuery } from \"@tanstack/react-query\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Button } from \"@/components/ui/button\";\nimport { Input } from \"@/components/ui/input\";\nimport { Badge } from \"@/components/ui/badge\";\nimport { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from \"@/components/ui/select\";\nimport { Skeleton } from \"@/components/ui/skeleton\";\nimport { useToast } from \"@/hooks/use-toast\";\nimport { Database, Search, Filter, ChevronLeft, ChevronRight, Brain, BarChart3, Clock, Layers, Loader2 } from \"lucide-react\";\nimport { Link } from \"wouter\";\nimport type { Track, TrainingCorpusItem } from \"@shared/schema\";\nimport { getConnectedAddress, authenticateWithServer } from \"@/lib/solanaWallet\";\n\ninterface CorpusResponse {\n  items: TrainingCorpusItem[];\n  pagination: {\n    page: number;\n    limit: number;\n    total: number;\n    totalPages: number;\n  };\n}\n\ninterface CorpusStats {\n  total: number;\n  byTrack: Record<string, number>;\n  itemsThisCycle: number;\n  lastUpdated: string | null;\n  currentCycleNumber: number | null;\n}\n\nexport default function Corpus() {\n  const { toast } = useToast();\n  const [token, setToken] = useState<string | null>(null);\n  const [isCreator, setIsCreator] = useState(false);\n  const [trackFilter, setTrackFilter] = useState<string>(\"all\");\n  const [searchQuery, setSearchQuery] = useState(\"\");\n  const [page, setPage] = useState(1);\n  const [walletConnected, setWalletConnected] = useState(false);\n  const [isAuthenticating, setIsAuthenticating] = useState(false);\n\n  useEffect(() => {\n    const storedToken = localStorage.getItem(\"auth_token\");\n    setToken(storedToken);\n    const connectedAddr = getConnectedAddress();\n    setWalletConnected(!!connectedAddr);\n  }, []);\n\n  const handleAuthenticate = async () => {\n    const address = getConnectedAddress();\n    if (!address) {\n      toast({ title: \"Wallet not connected\", variant: \"destructive\" });\n      return;\n    }\n    \n    setIsAuthenticating(true);\n    try {\n      const success = await authenticateWithServer(address);\n      if (success) {\n        const newToken = localStorage.getItem(\"auth_token\");\n        setToken(newToken);\n        toast({ title: \"Authenticated successfully\" });\n      } else {\n        toast({ title: \"Authentication failed\", description: \"Please approve the signature request in your wallet\", variant: \"destructive\" });\n      }\n    } catch (error) {\n      toast({ title: \"Authentication error\", variant: \"destructive\" });\n    } finally {\n      setIsAuthenticating(false);\n    }\n  };\n\n  const { data: tracks } = useQuery<Track[]>({\n    queryKey: [\"/api/tracks\"],\n    enabled: !!token,\n  });\n\n  const { data: creatorCheck } = useQuery<{ isCreator: boolean }>({\n    queryKey: [\"/api/auth/is-creator\"],\n    enabled: !!token,\n  });\n\n  useEffect(() => {\n    if (creatorCheck) {\n      setIsCreator(creatorCheck.isCreator);\n    }\n  }, [creatorCheck]);\n\n  const buildQueryParams = () => {\n    const params = new URLSearchParams();\n    params.set(\"page\", page.toString());\n    params.set(\"limit\", \"20\");\n    if (trackFilter !== \"all\") params.set(\"trackId\", trackFilter);\n    if (searchQuery.trim()) params.set(\"search\", searchQuery.trim());\n    return params.toString();\n  };\n\n  const { data: corpusData, isLoading: corpusLoading, error: corpusError } = useQuery<CorpusResponse>({\n    queryKey: [\"/api/corpus\", trackFilter, searchQuery, page],\n    queryFn: async () => {\n      const res = await fetch(`/api/corpus?${buildQueryParams()}`, {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!res.ok) {\n        const err = await res.json();\n        throw new Error(err.error || \"Failed to fetch corpus\");\n      }\n      return res.json();\n    },\n    enabled: !!token,\n  });\n\n  const { data: stats, isLoading: statsLoading } = useQuery<CorpusStats>({\n    queryKey: [\"/api/corpus/stats\"],\n    queryFn: async () => {\n      const res = await fetch(\"/api/corpus/stats\", {\n        headers: { Authorization: `Bearer ${token}` },\n      });\n      if (!res.ok) throw new Error(\"Failed to fetch stats\");\n      return res.json();\n    },\n    enabled: !!token,\n  });\n\n  const getTrackName = (trackId: string) => {\n    return tracks?.find(t => t.id === trackId)?.name || trackId;\n  };\n\n  if (!token) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full\">\n          <CardContent className=\"p-6 text-center\">\n            <Database className=\"w-12 h-12 mx-auto mb-4 text-muted-foreground\" />\n            <h2 className=\"text-xl font-semibold mb-2\">\n              {walletConnected ? \"Authentication Required\" : \"Connect Wallet Required\"}\n            </h2>\n            <p className=\"text-muted-foreground mb-4\">\n              {walletConnected \n                ? \"Sign a message to verify your wallet and access the corpus.\"\n                : \"Connect your wallet with 50+ HIVE to view the training corpus.\"}\n            </p>\n            <div className=\"flex gap-2 justify-center\">\n              {walletConnected && (\n                <Button \n                  onClick={handleAuthenticate} \n                  disabled={isAuthenticating}\n                  data-testid=\"button-authenticate\"\n                >\n                  {isAuthenticating && <Loader2 className=\"w-4 h-4 mr-2 animate-spin\" />}\n                  Sign to Authenticate\n                </Button>\n              )}\n              <Link href=\"/\">\n                <Button variant={walletConnected ? \"outline\" : \"default\"} data-testid=\"button-go-home\">\n                  Go to Home\n                </Button>\n              </Link>\n            </div>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  if (corpusError) {\n    return (\n      <div className=\"min-h-screen bg-background flex items-center justify-center p-4\">\n        <Card className=\"max-w-md w-full\">\n          <CardContent className=\"p-6 text-center\">\n            <Database className=\"w-12 h-12 mx-auto mb-4 text-destructive\" />\n            <h2 className=\"text-xl font-semibold mb-2\">Access Denied</h2>\n            <p className=\"text-muted-foreground mb-4\">\n              {(corpusError as Error).message || \"You need 50+ HIVE to view the corpus.\"}\n            </p>\n            <Link href=\"/\">\n              <Button data-testid=\"button-go-home\">Go to Home</Button>\n            </Link>\n          </CardContent>\n        </Card>\n      </div>\n    );\n  }\n\n  return (\n    <div className=\"min-h-screen bg-background\">\n      <header className=\"border-b bg-card sticky top-0 z-50\">\n        <div className=\"max-w-6xl mx-auto px-4 py-3 flex items-center justify-between gap-4\">\n          <div className=\"flex items-center gap-3\">\n            <Link href=\"/\">\n              <Button variant=\"ghost\" size=\"icon\" data-testid=\"button-back-home\">\n                <ChevronLeft className=\"w-5 h-5\" />\n              </Button>\n            </Link>\n            <div className=\"flex items-center gap-2\">\n              <Brain className=\"w-6 h-6 text-primary\" />\n              <h1 className=\"text-lg font-semibold\">HiveMind Corpus</h1>\n            </div>\n          </div>\n          {isCreator && (\n            <Link href=\"/corpus/admin\">\n              <Button variant=\"outline\" data-testid=\"button-go-admin\">\n                Manage Corpus\n              </Button>\n            </Link>\n          )}\n        </div>\n      </header>\n\n      <main className=\"max-w-6xl mx-auto px-4 py-6 space-y-6\">\n        <div className=\"grid grid-cols-1 md:grid-cols-4 gap-4\">\n          <Card>\n            <CardContent className=\"p-4 flex items-center gap-3\">\n              <div className=\"p-2 rounded-md bg-primary/10\">\n                <Database className=\"w-5 h-5 text-primary\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Total Items</p>\n                {statsLoading ? (\n                  <Skeleton className=\"h-6 w-16\" />\n                ) : (\n                  <p className=\"text-xl font-semibold\" data-testid=\"text-total-items\">{stats?.total || 0}</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-4 flex items-center gap-3\">\n              <div className=\"p-2 rounded-md bg-accent/10\">\n                <Layers className=\"w-5 h-5 text-accent-foreground\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">This Cycle</p>\n                {statsLoading ? (\n                  <Skeleton className=\"h-6 w-16\" />\n                ) : (\n                  <p className=\"text-xl font-semibold\" data-testid=\"text-cycle-items\">{stats?.itemsThisCycle || 0}</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-4 flex items-center gap-3\">\n              <div className=\"p-2 rounded-md bg-secondary/50\">\n                <BarChart3 className=\"w-5 h-5\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Tracks</p>\n                {statsLoading ? (\n                  <Skeleton className=\"h-6 w-16\" />\n                ) : (\n                  <p className=\"text-xl font-semibold\" data-testid=\"text-track-count\">{Object.keys(stats?.byTrack || {}).length}</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n          \n          <Card>\n            <CardContent className=\"p-4 flex items-center gap-3\">\n              <div className=\"p-2 rounded-md bg-muted\">\n                <Clock className=\"w-5 h-5 text-muted-foreground\" />\n              </div>\n              <div>\n                <p className=\"text-sm text-muted-foreground\">Current Cycle</p>\n                {statsLoading ? (\n                  <Skeleton className=\"h-6 w-16\" />\n                ) : (\n                  <p className=\"text-xl font-semibold\" data-testid=\"text-current-cycle\">#{stats?.currentCycleNumber || \"N/A\"}</p>\n                )}\n              </div>\n            </CardContent>\n          </Card>\n        </div>\n\n        <Card>\n          <CardHeader className=\"pb-3\">\n            <div className=\"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between\">\n              <CardTitle className=\"flex items-center gap-2\">\n                <Filter className=\"w-5 h-5\" />\n                Training Data\n              </CardTitle>\n              <div className=\"flex flex-col sm:flex-row gap-2 w-full sm:w-auto\">\n                <div className=\"relative flex-1 sm:w-64\">\n                  <Search className=\"absolute left-3 top-1/2 -translate-y-1/2 w-4 h-4 text-muted-foreground\" />\n                  <Input\n                    placeholder=\"Search corpus...\"\n                    value={searchQuery}\n                    onChange={(e) => {\n                      setSearchQuery(e.target.value);\n                      setPage(1);\n                    }}\n                    className=\"pl-9\"\n                    data-testid=\"input-search-corpus\"\n                  />\n                </div>\n                <Select value={trackFilter} onValueChange={(v) => { setTrackFilter(v); setPage(1); }}>\n                  <SelectTrigger className=\"w-full sm:w-40\" data-testid=\"select-track-filter\">\n                    <SelectValue placeholder=\"All Tracks\" />\n                  </SelectTrigger>\n                  <SelectContent>\n                    <SelectItem value=\"all\">All Tracks</SelectItem>\n                    {tracks?.map(track => (\n                      <SelectItem key={track.id} value={track.id}>{track.name}</SelectItem>\n                    ))}\n                  </SelectContent>\n                </Select>\n              </div>\n            </div>\n          </CardHeader>\n          <CardContent>\n            {corpusLoading ? (\n              <div className=\"space-y-3\">\n                {[1, 2, 3, 4, 5].map(i => (\n                  <Skeleton key={i} className=\"h-16 w-full\" />\n                ))}\n              </div>\n            ) : corpusData?.items.length === 0 ? (\n              <div className=\"text-center py-12 text-muted-foreground\">\n                <Database className=\"w-12 h-12 mx-auto mb-3 opacity-50\" />\n                <p>No corpus items found</p>\n                <p className=\"text-sm\">Try adjusting your filters or search query</p>\n              </div>\n            ) : (\n              <div className=\"space-y-3\">\n                {corpusData?.items.map((item, index) => (\n                  <div\n                    key={item.id}\n                    className=\"p-4 rounded-md border bg-card/50 hover-elevate\"\n                    data-testid={`corpus-item-${index}`}\n                  >\n                    <div className=\"flex items-start justify-between gap-4\">\n                      <div className=\"flex-1 min-w-0\">\n                        <p className=\"text-sm font-mono break-words\" data-testid={`text-corpus-content-${index}`}>\n                          {item.normalizedText}\n                        </p>\n                      </div>\n                      <Badge variant=\"secondary\" className=\"shrink-0\">\n                        {getTrackName(item.trackId)}\n                      </Badge>\n                    </div>\n                    <div className=\"mt-2 flex items-center gap-3 text-xs text-muted-foreground\">\n                      <span>Added: {new Date(item.createdAt).toLocaleDateString()}</span>\n                    </div>\n                  </div>\n                ))}\n              </div>\n            )}\n\n            {corpusData && corpusData.pagination.totalPages > 1 && (\n              <div className=\"flex items-center justify-between mt-6 pt-4 border-t\">\n                <p className=\"text-sm text-muted-foreground\">\n                  Page {corpusData.pagination.page} of {corpusData.pagination.totalPages} ({corpusData.pagination.total} items)\n                </p>\n                <div className=\"flex gap-2\">\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setPage(p => Math.max(1, p - 1))}\n                    disabled={page === 1}\n                    data-testid=\"button-prev-page\"\n                  >\n                    <ChevronLeft className=\"w-4 h-4\" />\n                    Previous\n                  </Button>\n                  <Button\n                    variant=\"outline\"\n                    size=\"sm\"\n                    onClick={() => setPage(p => Math.min(corpusData.pagination.totalPages, p + 1))}\n                    disabled={page >= corpusData.pagination.totalPages}\n                    data-testid=\"button-next-page\"\n                  >\n                    Next\n                    <ChevronRight className=\"w-4 h-4\" />\n                  </Button>\n                </div>\n              </div>\n            )}\n          </CardContent>\n        </Card>\n      </main>\n    </div>\n  );\n}\n","path":null,"size_bytes":14994,"size_tokens":null}},"version":2}